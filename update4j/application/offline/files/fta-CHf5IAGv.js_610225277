import{j as e,t as b,r as p,c as te}from"./client-BvsFx6Uv.js";import{u as se}from"./utils-CzBzcnQn.js";import{c as ae}from"./dialogs-Cji8mkGY.js";import{M as w}from"./Modal-BSxbHkAp.js";import{F as T}from"./Form-C93KviTp.js";import{B as $}from"./Button-CplEHJLM.js";import{E as ne}from"./LocalErrorBoundary-B_5iy1c-.js";import"./merge-BCxs0UCa.js";import"./index-CsyH6pUe.js";import"./warning-PI8mi4Hb.js";import"./querySelectorAll-CV_V5nX6.js";import"./createWithBsPrefix-Bt6Ige_C.js";import"./all-crwlzFAZ.js";import"./SafeAnchor-G5C8N4yQ.js";import"./exports-gx3CWV9A.js";try{let s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new s.Error().stack;n&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[n]="56b2d628-6c25-47f4-92a7-eec9317b1479",s._sentryDebugIdIdentifier="sentry-dbid-56b2d628-6c25-47f4-92a7-eec9317b1479")}catch{}function le({match:s,team:n,alliance:r,issues:i,hidden:u,openTeam:f,openNote:h}){n||(n={});let o=i.get(n.number)||[],l=o.reduce((c,x)=>x.resolved?c:c+1,0),m=o.reduce((c,x)=>x.resolved?c+1:c,0);return u?null:e.jsxs("div",{className:`matchTeam ${r}`,children:[e.jsx("div",{className:"teamNumber",onClick:()=>f(n.number),children:n.displayNumber}),n.number?e.jsxs("div",{className:"issueGroup",children:[e.jsxs("div",{className:"active issueCount",children:["A: ",l]}),e.jsxs("div",{className:"resolved issueCount",children:["R: ",m]}),e.jsx("button",{className:"newIssue",onClick:()=>h(s,n.number),children:e.jsx("i",{className:"fa fa-plus-circle fa-4"})})]}):null]})}function re({match:s,matchList:n,issues:r,setCurrentMatch:i,openTeam:u,saveNoteCallback:f,openNote:h}){let o=s?n.findIndex(N=>N.shortName===s):-1,l=o>=0?n[o]:null,m=(l==null?void 0:l.red.team3)||(l==null?void 0:l.blue.team3),c=[1,2,3].map(N=>["red","blue"].map(j=>{var C;return e.jsx(le,{match:s,team:(C=l==null?void 0:l[j]["team"+N])==null?void 0:C.data,alliance:j,issues:r,hidden:N===3&&!m,openTeam:u,openNote:h},`${j}_${N}`)})),x=n?n.map(N=>e.jsx("button",{className:"dropdown-item",onClick:()=>i(N.shortName),children:N.shortName},N.shortName)):[];return e.jsxs("div",{className:"matchView",children:[e.jsx("br",{}),e.jsxs("div",{className:"matchHeader",children:[e.jsx("button",{className:"matchLeft btn btn-secondary",disabled:o<=0,onClick:()=>i(n[o-1].shortName),children:e.jsx("i",{className:"fa fa-arrow-left"})}),e.jsx("span",{className:"matchName h4",children:t`Match ${s}`}),e.jsx("button",{className:"btn btn-secondary btn-sm dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}),e.jsx("div",{className:"dropdown-menu","aria-labelledby":"matchSearch",children:x}),e.jsx("button",{className:"btn btn-secondary",disabled:o<0||o>=n.length-1,onClick:()=>i(n[o+1].shortName),children:e.jsx("i",{className:"fa fa-arrow-right"})})]}),e.jsxs("div",{className:"matchInfo",children:["Field: ",l==null?void 0:l.field]}),e.jsx("div",{className:"matchTeams",children:c})]})}function A({issue:s,saveNoteCallback:n,label:r,openNote:i,teams:u}){var o;const f={DS_PHONE:t`DS Issue (Phone)`,DS_HUB:t`DS Issue (Hub)`,RC_PHONE:t`RC Issue (Phone)`,RC_HUB:t`RC Issue (Hub)`,NO_ROBOT:t`No Robot`,CONFIG:t`Configuration Issue`,POWER:t`Robot Power Issue`,CONNECTION:t`Connection Issue`,ELECTRICAL:t`Electrical Issue`,OTHER_ROBOT:t`Other Robot Issue`,INSPECTION:t`Inspection Issue`,OTHER:t`Other Issue`},h=l=>{l.stopPropagation(),s.resolved=!s.resolved,n(s)};return e.jsxs("div",{className:`teamIssue teamIssueListItem ${s.resolved?"resolved":"active"}`,onClick:()=>i(s),children:[e.jsxs("div",{className:"teamIssueItemLeft",children:[e.jsxs("div",{className:"teamIssueItemTop",children:[e.jsx("span",{className:"teamIssueMatch",children:r==="team"?(o=u.find(l=>l.data.number===s.team))==null?void 0:o.data.displayNumber:s.match}),e.jsx("div",{className:"teamIssueType",children:f[s.type]})]}),e.jsx("div",{className:"teamIssueSummary",children:s.summary})]}),e.jsx("button",{onClick:h,children:e.jsx("i",{className:`fa-2x ${s.resolved?"fa fa-check-circle":"far fa-circle"}`})})]})}function ce({team:s,displayNumber:n,teamName:r,issues:i,matchList:u,currentMatch:f,openMatch:h,saveNoteCallback:o,openNote:l}){const m=(d,S)=>{var R;for(let O of["red","blue"])for(let D of[1,2,3])if(((R=d[O]["team"+D])==null?void 0:R.data.number)===S)return!0;return!1},c=d=>e.jsx("div",{className:`teamMatch teamMatchListItem ${f===d.shortName?"current":""}`,onClick:()=>h(d.shortName),children:d.shortName},d.shortName),x=u.filter(d=>m(d,s)),N=x.map(d=>d.shortName===f).includes(!0),j=x.filter(d=>d.state==="COMMITTED").map(c),C=x.filter(d=>d.state!=="COMMITTED").map(c),v=i==null?void 0:i.sort((d,S)=>F(d.match,S.match)),E=v==null?void 0:v.filter(d=>!d.resolved).map(d=>e.jsx(A,{issue:d,saveNoteCallback:o,openNote:l},d.id)),g=v==null?void 0:v.filter(d=>d.resolved).map(d=>e.jsx(A,{issue:d,saveNoteCallback:o,openNote:l},d.id));return e.jsxs("div",{className:"teamView",children:[e.jsx("br",{}),e.jsxs("div",{className:"teamHeader",children:[e.jsx("div",{className:"teamNumber h4",children:b`Team #${n}`}),e.jsx("div",{className:"teamName",children:r})]}),e.jsxs("div",{className:"teamBody",children:[e.jsxs("div",{style:{width:"75%",borderRight:"1px solid black"},children:[e.jsxs("div",{style:{margin:".5em",minHeight:"300px"},children:[e.jsx("div",{className:"teamIssueListHeader teamIssueListItem active",children:b`ACTIVE:`}),E,e.jsx("div",{className:"teamIssueListHeader teamIssueListItem resolved",children:b`RESOLVED:`}),g]}),N?e.jsx("div",{style:{textAlign:"center",margin:".3em"},children:e.jsx("button",{style:{width:"50%"},className:"btn btn-sm btn-dark",onClick:()=>l({match:f,team:s}),children:b`Add Match Issue`})}):null,e.jsx("div",{style:{textAlign:"center",margin:".3em"},children:e.jsx("button",{style:{width:"50%"},className:"btn btn-sm btn-dark",onClick:()=>l({match:"G",team:s}),children:b`Add General Issue`})})]}),e.jsxs("div",{style:{width:"25%",textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:"bold"},children:"Matches"}),e.jsx("div",{className:"teamMatchListHeader teamMatchListItem",children:b`COMPLETE:`}),j,e.jsx("div",{className:"teamMatchListHeader teamMatchListItem",children:b`FUTURE:`}),C]})]})]})}function ie(s,n,r,i,u){var o,l;const f=[],h=Array.from(s.keys()).sort((m,c)=>m-c);for(let m of h){let c=s.get(m).filter(x=>r!=="active"||!x.resolved);if(c.length){f.push(e.jsxs("div",{className:"teamIssueListHeader teamIssueListItem",children:[(o=n.find(x=>x.data.number===m))==null?void 0:o.data.displayNumber," - ",(l=n.find(x=>x.data.number===m))==null?void 0:l.data.name]},m));for(let x of c.sort((N,j)=>F(N.match,j.match)))f.push(e.jsx(A,{issue:x,saveNoteCallback:i,openNote:u},`${x.team}_${x.id}`))}}return f}function oe(s,n,r,i,u){const f=[],h=new Map,o=Array.from(s.keys()).sort((l,m)=>l-m);for(let l of o)for(let m of s.get(l).filter(c=>r!=="active"||!c.resolved)){const c=h.has(m.match)?h.get(m.match):[];c.push(m),h.set(m.match,c)}for(let l of Array.from(h.keys()).sort(F)){f.push(e.jsx("div",{className:"teamIssueListHeader teamIssueListItem",children:l},l));for(let m of Array.from(h.get(l)).sort((c,x)=>c.team-x.team))f.push(e.jsx(A,{teams:n,issue:m,saveNoteCallback:i,label:"team",openNote:u},`${m.team}_${m.id}`))}return f}function de({teams:s,issues:n,saveNoteCallback:r,openNote:i}){const[u,f]=p.useState("team"),[h,o]=p.useState("active"),l=u==="team"?ie(n,s,h,r,i):oe(n,s,h,r,i);return e.jsxs("div",{children:[e.jsx("br",{}),e.jsxs("div",{className:"listHeader h6",children:[e.jsxs("div",{children:[b`Group: `,e.jsx("button",{className:`btn btn-sm ${u==="team"?"btn-secondary":"btn-outline-secondary"}`,onClick:()=>f("team"),children:b`Team`}),e.jsx("button",{className:`btn btn-sm ${u==="match"?"btn-secondary":"btn-outline-secondary"}`,onClick:()=>f("match"),style:{marginLeft:"1ch"},children:b`Match`})]}),e.jsxs("div",{style:{marginLeft:"auto"},children:[b`Show: `,e.jsx("button",{className:`btn btn-sm ${h==="all"?"btn-secondary":"btn-outline-secondary"}`,onClick:()=>o("all"),children:b`All`}),e.jsx("button",{className:`btn btn-sm ${h==="active"?"btn-secondary":"btn-outline-secondary"}`,onClick:()=>o("active"),style:{marginLeft:"1ch"},children:b`Active`})]})]}),e.jsx("div",{className:"issueList",children:e.jsx("div",{className:"teamIssuesContainer",children:l})})]})}function me({show:s,setShow:n,note:r,setNote:i,saveNote:u,slackEnabled:f}){const h=p.useId(),o=p.useId();if(!r)return null;function l(c){i(Object.assign({},r,c))}let m=r.sendToSlack||r.slackId;return m&&r.resolved&&!r.slackId&&(m=!1),e.jsxs(w,{show:s,onHide:()=>n(!1),size:"lg",className:"noteModal",children:[e.jsx(w.Header,{closeButton:!0,children:e.jsx(w.Title,{children:t`Team Issue`})}),e.jsxs(w.Body,{children:[r.match!=="G"?e.jsxs(e.Fragment,{children:[e.jsx(T.Label,{children:t`Match: ${r.match}`}),e.jsx("br",{})]}):null,e.jsx(T.Label,{children:t`Team: ${r.team}`}),e.jsx("br",{}),e.jsx("label",{htmlFor:"noteTypeInput",children:t`Type:`}),e.jsxs("select",{id:"noteTypeInput",style:{marginLeft:"10px"},value:r.type||"OTHER",onChange:c=>l({type:c.target.value}),children:[e.jsx("option",{value:"DS_PHONE",children:t`DS Issue (Phone)`}),e.jsx("option",{value:"DS_HUB",children:t`DS Issue (Hub)`}),e.jsx("option",{value:"RC_PHONE",children:t`RC Issue (Phone)`}),e.jsx("option",{value:"RC_HUB",children:t`RC Issue (Hub)`}),e.jsx("option",{value:"NO_ROBOT",children:t`No Robot`}),e.jsx("option",{value:"CONFIG",children:t`Configuration Issue`}),e.jsx("option",{value:"POWER",children:t`Robot Power Issue`}),e.jsx("option",{value:"CONNECTION",children:t`Connection Issue`}),e.jsx("option",{value:"ELECTRICAL",children:t`Electrical Issue`}),e.jsx("option",{value:"OTHER_ROBOT",children:t`Other Robot Issue`}),e.jsx("option",{value:"INSPECTION",children:t`Inspection Issue`}),e.jsx("option",{value:"OTHER",children:t`Other Issue`})]}),e.jsx("br",{}),e.jsx(T.Label,{className:"drop",children:t`Summary:`}),e.jsx(T.Control,{type:"text",value:r.summary||"",onChange:c=>l({summary:c.target.value})}),e.jsx(T.Label,{className:"drop",children:t`Details:`}),e.jsx(T.Control,{as:"textarea",value:r.details||"",rows:4,style:{width:"100%"},onChange:c=>l({details:c.target.value})}),e.jsx("br",{}),e.jsx(T.Check,{label:"Resolved?",id:o,checked:r.resolved,onChange:c=>l({resolved:c.target.checked})}),f?e.jsx(T.Check,{label:"Send to slack?",id:h,checked:m,onChange:c=>l({sendToSlack:c.target.checked}),disabled:r.slackId||r.resolved}):null]}),e.jsxs(w.Footer,{children:[e.jsx($,{variant:"danger",onClick:()=>{n(!1),ae({label:t`Confirm Note Delete`,text:t`This will permanently delete the note. Continue?`,onConfirm:()=>{u(Object.assign({},r,{id:-r.id})),n(!1)}})},style:{marginRight:"auto"},hidden:!r.id,children:t`Delete`}),e.jsx($,{variant:"secondary",onClick:()=>n(!1),children:t`Cancel`}),e.jsx($,{variant:"primary",onClick:()=>{u(r),n(!1)},children:t`Save`})]})]})}function J({label:s,shortName:n,setCurrentMatch:r}){return e.jsxs("div",{className:"matchBtn",children:[e.jsx("div",{children:s}),n?e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>r(n),children:n}):null]})}function F(s,n){if(!s||!s[0])return 1;if(!n||!n[0])return-1;if(s[0]===n[0]){const r=i=>{const u=i.indexOf("-");return u>0?parseInt(i.substring(1,u)+parseInt(i.substring(u))/100):parseInt(i.substring(1))};return r(s)-r(n)}else{const r={G:0,Q:1,M:2,S:3,F:4,I:5},i=u=>r[u[0]];return i(s)-i(n)}}function ue({eventCode:s,slackEnabled:n}){var G,W;const[r,i]=p.useState("match"),[u,f]=p.useState(null),[h,o]=p.useState([]),[l,m]=p.useState([]),[c,x]=p.useState(null),[N,j]=p.useState(null),[C,v]=p.useState(null),[E,g]=p.useState(null),[d,S]=p.useState(new Map),[R,O]=p.useState(!1),[D,B]=p.useState(null),{isConnected:Q,send:Z}=se(`/stream/fta/?code=${s}`,a=>{f(a)});p.useEffect(()=>{var Y,z;let a=u;if(!a)return;const H=I=>{const y=new Map;for(let k in I)y.set(parseInt(k),I[k]);S(y)};if(a.type==="INIT"){o(a.matches),m(a.teams);const I=(Y=a.activeMatches.slice().reverse().find(M=>["AUTO","TELEOP","REVIEW","SUBMITTED"].includes(M.state)))==null?void 0:Y.shortName,y=(z=a.activeMatches.slice().reverse().find(M=>["UNPLAYED","RANDOMIZED"].includes(M.state)))==null?void 0:z.shortName,k=a.matches.reduce((M,_)=>_.start>M.start?{start:_.start,match:_.shortName}:M,{start:0,match:a.matches.length>0?a.matches[0].shortName:null});v(I),g(y===I?null:y),j(I||y||k.match),H(a.issues)}else if(a.type==="MATCH_LIST")o(a.matches);else if(a.type==="LOAD")g(a.match);else if(a.type==="START")v(a.match),E===a.match&&g(null);else if(a.type==="COMMIT"){const I=Array.from(h),y=I.find(k=>k.shortName===a.match);y&&(y.state="COMMITTED",o(I)),a.match===C&&v(null),a.match===E&&g(null)}else a.type==="ABORT"?a.match===C&&(v(null),g(a.match)):a.type==="ISSUE"?H(a.issues):console.log(a)},[u,C,E,h]);const U=a=>{x(a),i("team")},q=a=>{j(a),i("match")},P=a=>{a.type||(a.type="OTHER"),Z(JSON.stringify({type:"ISSUE",issue:a}))},K=(a,H)=>{B({match:a,team:H}),O(!0)},V=a=>{B(a),O(!0)};let L=null;r==="match"?L=e.jsx(re,{match:N,matchList:h,issues:d,setCurrentMatch:j,openTeam:U,openNote:K}):r==="team"?L=e.jsx(ce,{team:c,teamName:(G=l.find(a=>a.data.number===c))==null?void 0:G.data.name,displayNumber:(W=l.find(a=>a.data.number===c))==null?void 0:W.data.displayNumber,issues:d.get(c),currentMatch:N,matchList:h,openMatch:q,saveNoteCallback:P,openNote:V}):r==="list"&&(L=e.jsx(de,{teams:l,issues:d,saveNoteCallback:P,openNote:V}));const X=r==="match"?[e.jsx(J,{label:b`Loaded Match`,shortName:E,setCurrentMatch:j},"loaded"),e.jsx(J,{label:b`Active Match`,shortName:C,setCurrentMatch:j},"active")]:e.jsx("button",{className:"btn btn-secondary toolbarBtn",onClick:()=>i("match"),children:b`Match View`}),ee=l.map(a=>e.jsx("button",{className:"dropdown-item",onClick:()=>U(a.data.number),children:a.data.displayNumber},a.data.number));return e.jsxs("div",{className:"justify-content-center",children:[Q?null:e.jsx("div",{className:"alert alert-danger text-center h6",children:b`DISCONNECTED`}),e.jsx(me,{show:R,setShow:O,note:D,setNote:B,saveNote:P,slackEnabled:n}),e.jsxs("div",{className:"ftaToolbar",children:[X,e.jsxs("div",{className:"ftaToolbarRight",style:{marginLeft:"auto"},children:[e.jsx("button",{className:"btn btn-secondary toolbarBtn dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:b`Teams`}),e.jsx("div",{className:"dropdown-menu","aria-labelledby":"teamsBtn",children:ee}),e.jsx("button",{className:"btn btn-secondary toolbarBtn",onClick:()=>i("list"),children:e.jsx("i",{className:"fa fa-list"})})]})]}),L]})}const he=te.createRoot(document.getElementById("reactContainer"));he.render(e.jsxs(ne,{children:[e.jsxs("a",{href:"../",children:["<< ",t`Back to Event Home`]}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 h2 text-center",children:t`FTA Notepad`})}),e.jsx(ue,{eventCode:window.eventCode,slackEnabled:window.slackEnabled})]}));
//# sourceMappingURL=fta-CHf5IAGv.js.map
