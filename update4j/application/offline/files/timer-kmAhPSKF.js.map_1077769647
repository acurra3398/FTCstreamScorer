{"version":3,"file":"timer-kmAhPSKF.js","sources":["../../../../../../../../FTCCommon/src/main/javascript/displays/timerContainer.tsx","../../../../../../../../FTCCommon/src/main/javascript/displays/timer.tsx"],"sourcesContent":["import {useEffect, useState} from \"react\";\n\nimport {DisplayConfig} from './Config';\n\nimport './displays.css';\nimport Match from \"./pages/Match\";\nimport Primary from \"./layouts/Primary\";\nimport {initialConfig} from \"./displayContainer\";\nimport {DisplayCommandType} from \"../javaTypes\";\nimport {DisplayParamsType} from \"./DisplayParams\";\nimport {PermissiveURLSearchParams} from \"../utils\";\nimport DisplayErrorBoundary from \"./DisplayErrorBoundary\";\n\nconst searchParams = new URLSearchParams(window.location.search);\nconst valueFromQuery = Object.assign({}, initialConfig, { fieldStyleTimer: true });\nsearchParams.forEach((value : string | boolean, key) => {\n    if(value === 'true') {\n        value = true;\n    }\n    if(value === 'false') {\n        value = false;\n    }\n    // Query params inherently can't be usefully typed; just assume they came in correctly\n    // @ts-ignore\n    valueFromQuery[key] = value;\n})\nconsole.log(valueFromQuery)\nexport default function TimerContainer({} : DisplayParamsType){\n    const [config, setConfig] = useState(valueFromQuery);\n    const [dimensions, setDimensions] = useState({\n        height: window.innerHeight,\n        width: window.innerWidth\n    })\n    const [command, setCommand] = useState({\n        type: DisplayCommandType.SHOW_MATCH,\n        ts: Date.now(),\n        index: -1,\n        field: 0,\n        init: true,\n        params: { _empty: true }\n    })\n    function updateConfig(newConfig : DisplayConfig) {\n        setConfig(newConfig);\n        window.history.replaceState({}, '', window.location.pathname + '?' + PermissiveURLSearchParams({...newConfig}).toString())\n    }\n\n    useEffect(() => {\n        function handleResize() {\n            setDimensions({\n                height: window.innerHeight,\n                width: window.innerWidth\n            })\n        }\n\n        const listener = function (e : KeyboardEvent) {\n            if(e.code === 'Space' || e.which === 32) {\n                setCommand((was) => {\n                    if(was.type === DisplayCommandType.START_MATCH && (Date.now() - was.ts) < 1000 * (120 + 30 + 8)) {\n                        return was;\n                    }\n                    return {\n                        type: DisplayCommandType.START_MATCH,\n                        ts: Date.now(),\n                        index: -1,\n                        field: 0,\n                        init: false,\n                        params: { _empty: true }\n                    }\n                })\n            } else if(e.code === 'Escape' || e.which === 27) {\n                setCommand((was) => {\n                    if(was.type !== DisplayCommandType.START_MATCH || (Date.now() - was.ts) > 1000 * (120 + 30 + 8)) {\n                        return was;\n                    }\n                    return {\n                        type: DisplayCommandType.ABORT_MATCH,\n                        ts: Date.now(),\n                        index: -1,\n                        field: 0,\n                        init: false,\n                        params: { _empty: true }\n                    }\n                })\n            }\n        }\n        document.addEventListener('keydown', listener);\n\n        window.addEventListener('resize', handleResize)\n\n        return () => {\n            document.removeEventListener(\"keydown\", listener)\n            window.removeEventListener('resize', handleResize)\n        }\n    }, [])\n\n    const nowCallback = Date.now\n\n    const xZoom = dimensions.width / 1920;\n    const yZoom = dimensions.height / 1080;\n    const displayScale = Math.min(xZoom, yZoom);\n    return <div style={{ \"--display-scale\": displayScale }}>\n        {/*<Config config={config} setConfig={updateConfig}isConfigured={!window.location.search} style={'timerOnly'} />*/}\n        <div className=\"displayContainer\">\n            <DisplayErrorBoundary>\n                <Match command={command} config={config} nowCallback={nowCallback} timerOnly />\n            </DisplayErrorBoundary>\n        </div>\n    </div>\n}","import TimerContainer from './timerContainer'\nimport AssetHelper from \"../AssetHelper\";\nimport {initSounds} from \"../sounds\";\nimport {preloadVideos} from \"./components/MatchVideo\";\nimport { createRoot } from \"react-dom/client\";\n\n// useAsset already handles ensuring this is loaded, but to allow preloading a/v clips it's much easier to\n// not be forced to work with async apis\nAssetHelper.ensureProperties().then(() => {\n    initSounds();\n    preloadVideos();\n    const target = document.getElementById('displayRoot');\n    if(!target) {\n        throw \"Target element for display not found\"\n    }\n    const root = createRoot(target)\n    root.render(<TimerContainer {...window.displayParams} />);\n})\n"],"names":["searchParams","valueFromQuery","initialConfig","value","key","TimerContainer","config","setConfig","useState","dimensions","setDimensions","command","setCommand","DisplayCommandType","useEffect","handleResize","listener","e","was","nowCallback","xZoom","yZoom","displayScale","jsx","DisplayErrorBoundary","Match","AssetHelper","initSounds","preloadVideos","target","createRoot"],"mappings":"02CAaA,MAAMA,EAAe,IAAI,gBAAgB,OAAO,SAAS,MAAM,EACzDC,EAAiB,OAAO,OAAO,CAAA,EAAIC,EAAe,CAAE,gBAAiB,GAAM,EACjFF,EAAa,QAAQ,CAACG,EAA0BC,IAAQ,CACjDD,IAAU,SACDA,EAAA,IAETA,IAAU,UACDA,EAAA,IAIZF,EAAeG,CAAG,EAAID,CAC1B,CAAC,EACD,QAAQ,IAAIF,CAAc,EACF,SAAAI,EAAe,CAAA,EAAuB,CAC1D,KAAM,CAACC,EAAQC,CAAS,EAAIC,EAAAA,SAASP,CAAc,EAC7C,CAACQ,EAAYC,CAAa,EAAIF,WAAS,CACzC,OAAQ,OAAO,YACf,MAAO,OAAO,UAAA,CACjB,EACK,CAACG,EAASC,CAAU,EAAIJ,WAAS,CACnC,KAAMK,EAAmB,WACzB,GAAI,KAAK,IAAI,EACb,MAAO,GACP,MAAO,EACP,KAAM,GACN,OAAQ,CAAE,OAAQ,EAAK,CAAA,CAC1B,EAMDC,EAAAA,UAAU,IAAM,CACZ,SAASC,GAAe,CACNL,EAAA,CACV,OAAQ,OAAO,YACf,MAAO,OAAO,UAAA,CACjB,CAAA,CAGC,MAAAM,EAAW,SAAUC,EAAmB,CACvCA,EAAE,OAAS,SAAWA,EAAE,QAAU,GACjCL,EAAYM,GACLA,EAAI,OAASL,EAAmB,aAAgB,KAAK,IAAA,EAAQK,EAAI,GAAM,IAAQ,IACvEA,EAEJ,CACH,KAAML,EAAmB,YACzB,GAAI,KAAK,IAAI,EACb,MAAO,GACP,MAAO,EACP,KAAM,GACN,OAAQ,CAAE,OAAQ,EAAK,CAC3B,CACH,GACKI,EAAE,OAAS,UAAYA,EAAE,QAAU,KACzCL,EAAYM,GACLA,EAAI,OAASL,EAAmB,aAAgB,KAAK,IAAA,EAAQK,EAAI,GAAM,IAAQ,IACvEA,EAEJ,CACH,KAAML,EAAmB,YACzB,GAAI,KAAK,IAAI,EACb,MAAO,GACP,MAAO,EACP,KAAM,GACN,OAAQ,CAAE,OAAQ,EAAK,CAC3B,CACH,CAET,EACS,gBAAA,iBAAiB,UAAWG,CAAQ,EAEtC,OAAA,iBAAiB,SAAUD,CAAY,EAEvC,IAAM,CACA,SAAA,oBAAoB,UAAWC,CAAQ,EACzC,OAAA,oBAAoB,SAAUD,CAAY,CACrD,CACJ,EAAG,EAAE,EAEL,MAAMI,EAAc,KAAK,IAEnBC,EAAQX,EAAW,MAAQ,KAC3BY,EAAQZ,EAAW,OAAS,KAC5Ba,EAAe,KAAK,IAAIF,EAAOC,CAAK,EACnC,OAAAE,EAAA,IAAC,OAAI,MAAO,CAAE,kBAAmBD,GAEpC,SAACC,EAAAA,IAAA,MAAA,CAAI,UAAU,mBACX,eAACC,EACG,CAAA,SAAAD,EAAA,IAACE,GAAM,QAAAd,EAAkB,OAAAL,EAAgB,YAAAa,EAA0B,UAAS,EAAA,CAAC,CACjF,CAAA,CAAA,CACJ,CACJ,CAAA,CACJ,CCpGAO,EAAY,iBAAA,EAAmB,KAAK,IAAM,CAC3BC,EAAA,EACGC,EAAA,EACR,MAAAC,EAAS,SAAS,eAAe,aAAa,EACpD,GAAG,CAACA,EACM,KAAA,uCAEGC,aAAWD,CAAM,EACzB,OAAQN,MAAAlB,EAAA,CAAgB,GAAG,OAAO,cAAe,CAAE,CAC5D,CAAC"}