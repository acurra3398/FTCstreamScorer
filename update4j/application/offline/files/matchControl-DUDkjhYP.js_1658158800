import{R as Ee,t,r as w,j as e,c as Qe}from"./client-BvsFx6Uv.js";import{e as Ke,R as Re,a as Ye,u as Je}from"./react-svg.esm-Sr47L1-2.js";import{m as _,f as Xe,c as re,p as Ie}from"./dialogs-Cji8mkGY.js";import{R as Ze,T as es,g as ss,e as ts,f as ns,h as is,i as He,j as rs,k as ls,u as as,C as cs,A as os,c as ge,a as ds,d as hs,s as us,b as xs,r as ms,p as js,l as fs,q as ps}from"./ActionButtons-CpPtNB5U.js";import{C as bs,g as gs}from"./util-C_NCVmSR.js";import{P as G,b as J}from"./utils-CzBzcnQn.js";import{B as Ae,A as L,a as ye,S as ys,T as Z}from"./javaTypes-BFjjeUw7.js";import{u as vs,a as Ts,Q as Ns}from"./useQuery-BagP8Nrl.js";import{B as v}from"./Button-CplEHJLM.js";import{A as Ce}from"./Alert-DR6HmQEy.js";import{F as U,C as he}from"./Form-C93KviTp.js";import{M as V}from"./Modal-BSxbHkAp.js";import{R as we}from"./assertThisInitialized-DpDF5Qa-.js";import{P as Cs}from"./ProgressBar-CdbDon19.js";import{A as ve,r as ue,d as ws}from"./util-u-8ucP1B.js";import{b as Te,M as Ss}from"./javaTypes-DNGMEgAs.js";import{_ as ks,u as Es,a as Rs,c as Is}from"./index-CsyH6pUe.js";import{C as fe}from"./Card-BkLzw4rn.js";import{a as As,s as Ms,u as Ps,f as $s,b as Ds,r as Os,c as Bs}from"./allianceSelection-BVzYebbf.js";import{X as Me}from"./classApi-CCs8VasB.js";import{S as Ls}from"./SupportChat-B85BgWz-.js";import{E as _e}from"./LocalErrorBoundary-B_5iy1c-.js";import{m as Pe}from"./ElementChildren-DccXaKZk.js";import{a as Fs,b as Us,c as Gs,T as K}from"./isEqual-DTKQseSG.js";import{N as Se}from"./index-DBycPXkv.js";import{P as Vs}from"./PresentAwards-BZ6HQI77.js";import"./tslib.es6-C3SfwpKo.js";import"./merge-BCxs0UCa.js";import"./lodash-DEhfaarB.js";import"./react-select.esm-DKMMOdrD.js";import"./warning-PI8mi4Hb.js";import"./exports-gx3CWV9A.js";import"./querySelectorAll-CV_V5nX6.js";import"./hook-ByTrhTT2.js";import"./usePopperMarginModifiers-OKrDsYDV.js";import"./CardContext-C2IdBV6N.js";import"./SafeAnchor-G5C8N4yQ.js";import"./isRequiredForA11y-D3y9EsJd.js";import"./createWithBsPrefix-Bt6Ige_C.js";import"./ButtonGroup-BIeDoSyl.js";import"./Google-DA3-YxQg.js";import"./_baseAssignValue-Zu9BHZt-.js";import"./_baseIsEqual-BE-Qrqfl.js";import"./all-crwlzFAZ.js";import"./ViewScript-BEtQd3qk.js";import"./ToggleButtonGroup-CAGfgCDu.js";try{let s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},i=new s.Error().stack;i&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[i]="186c6200-fbd8-4d47-8aa7-221f12305f27",s._sentryDebugIdIdentifier="sentry-dbid-186c6200-fbd8-4d47-8aa7-221f12305f27")}catch{}var Hs=["bsPrefix","variant","animation","size","children","as","className"],ze=Ee.forwardRef(function(s,i){var r=s.bsPrefix,n=s.variant,l=s.animation,d=s.size,x=s.children,m=s.as,u=m===void 0?"div":m,S=s.className,o=ks(s,Hs);r=Es(r,"spinner");var g=r+"-"+l;return Ee.createElement(u,Rs({ref:i},o,{className:Is(S,g,d&&g+"-"+d,n&&"text-"+n)}),x)});ze.displayName="Spinner";async function _s(s,i){await fetch(`/event/${s}/control/sponsors/`,{method:"POST",body:i?G({field:i}):null})}async function $e(s,i,r){const n={};i&&(n.style=i),r&&(n.field=r),await fetch(`/event/${s}/control/bracket/`,{method:"POST",body:G(n)})}async function qe(s,i){await fetch(`/event/${s}/control/selection/show/`,{method:"POST",body:i?G({field:i}):null})}async function zs(s,i){await fetch(`/event/${s}/control/ranks/`,{method:"POST",body:i?G({field:i}):null})}async function qs(s,i){await fetch(`/event/${s}/control/status/`,{method:"POST",body:i?G({field:i}):null})}async function Ws(s,i){await fetch(`/event/${s}/control/command/wifi/`,{method:"POST",body:i?G({field:i}):null})}async function Qs(s,i){await fetch(`/event/${s}/control/command/slideshow/`,{method:"POST",body:i?G({field:i}):null})}async function Ks(s,i){await fetch(`/event/${s}/control/command/safety_security/`,{method:"POST",body:i?G({field:i}):null})}async function Ys(s,i){await fetch(`/event/${s}/control/command/blank/`,{method:"POST",body:i?G({field:i}):null})}async function Js(s,i){await fetch(`/event/${s}/control/command/video/`,{method:"POST",body:i?G({field:i}):null})}async function Xs(s,i){await fetch(`/event/${s}/control/command/key/`,{method:"POST",body:i?G({field:i}):null})}async function Zs(s,i){const r=await fetch(`/event/${s}/control/command/online/`,{method:"POST",body:i?G({field:i}):null});(!r.ok||await r.text()!=="OK")&&_({label:t`Unable to Show Online Results`,text:t`Cannot show online information when sync is disconnected`})}async function et(s,i,r){await fetch(`/event/${s}/control/message/`,{method:"POST",body:r?G({msg:i,field:r}):G({msg:i})})}async function st(s,i,r,n){await fetch(`/event/${s}/control/play_video/`,{method:"POST",body:G({videoUrl:i,subtitleUrl:r})})}async function tt(s,i){await fetch(`/event/${s}/control/command/stop_video/`,{method:"POST",body:null})}async function nt(s,i,r){await fetch(`/event/${s}/control/display/config/${i}/`,{method:"POST",body:JSON.stringify(r)})}async function it(s,i,r,n){await fetch(`/event/${s}/control/display/bulk_config/`,{method:"POST",body:JSON.stringify({ids:i,division:r,field:n})})}async function rt(s,i,r){await fetch(`/event/${s}/config/set/`,{method:"POST",body:new URLSearchParams({key:i,value:r})})}async function lt(s,i){await fetch(`/event/${s}/control/testmode/${i}/`,{method:"POST"})}async function at(s){await fetch(`/event/${s}/control/quals/`,{method:"POST"})}async function ct(s){await fetch(`/event/${s}/control/practice/`,{method:"POST"})}async function ot(s){return await(await fetch(`/event/${s}/control/sync/test/`,{method:"POST"})).text()}async function dt(s){return await(await fetch(`/event/${s}/control/sync/now/`,{method:"POST"})).text()}async function ht(){return(await fetch("/manage/video_download/",{method:"POST"})).ok}function ut({eventCode:s,displayData:i,fieldCount:r,showMeetRankings:n,isDualDivisionParent:l,divisions:d}){const[x,m]=w.useState(),[u,S]=w.useState([]),[o,g]=w.useState([]),[j,c]=w.useState(!1),[f,T]=w.useState(0),[y,R]=w.useState(0);w.useEffect(()=>{x&&!i.some(b=>b.id===(x==null?void 0:x.id))&&m(void 0)},[x,i]),w.useEffect(()=>{S([...i].sort((b,a)=>{if(b.division!=a.division)return b.division-a.division;if(b.data.name!==a.data.name){const C=b.data.name,I=a.data.name;return C&&!I?1:!C&&I?-1:C&&I?C.localeCompare(I):0}else return b.id.localeCompare(a.id)}))},[i]);const h={audience:t`Audience`,field:t`Field`,cmpBar:t`Banner`,pit:t`Pit`,sponsor:t`Sponsors`},D=b=>{let a=b==null?void 0:b.data;if(!a)return null;const C=e.jsx("button",{className:"btn btn-info btn-sm",onClick:()=>m(b),children:t`Config`}),I=b.division?d[b.division-1]:t`Parent`,E=e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:o.includes(b.id),onChange:B=>{B.target.checked?g([...o,b.id]):g(o.filter(A=>A!==b.id))}})}),e.jsx("td",{children:b.ip}),l?e.jsx("td",{children:I}):null,e.jsx("td",{children:a.name}),e.jsx("td",{children:h[a.type]})]});return a.type==="pit"||a.type==="sponsor"?e.jsxs("tr",{children:[E,e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{children:C})]}):e.jsxs("tr",{children:[E,e.jsx("td",{children:a.bindToField==="all"?t`All`:a.bindToField}),e.jsx("td",{children:a.overlay?t`Overlay`:a.fieldStyleTimer?t`Field`:t`Audience`}),e.jsx("td",{children:a.mute?t`Off`:t`On`}),e.jsx("td",{children:a.scoringBarLocation==="bottom"?t`Bottom`:t`Top`}),e.jsx("td",{children:a.allianceOrientation==="standard"?t`Standard (Red on Left)`:t`Flipped (Red on Right)`}),e.jsx("td",{children:C})]},b.id)};function P(){it(s,o,f,y),g([]),c(!1)}return e.jsxs(e.Fragment,{children:[e.jsxs("table",{style:{width:"100%",textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid white"},children:[e.jsx("th",{}),e.jsx("th",{children:t`IP`}),l?e.jsx("th",{children:t`Division`}):null,e.jsx("th",{children:t`Name`}),e.jsx("th",{children:t`Type`}),e.jsx("th",{children:t`Field`}),e.jsx("th",{children:t`Timer Style`}),e.jsx("th",{children:t`Audio`}),e.jsx("th",{children:t`Scoring Bar`}),e.jsx("th",{children:t`Alliance Orientation`}),e.jsx("th",{children:t`Config`})]})}),e.jsx("tbody",{children:u.map(b=>D(b))})]}),e.jsx(v,{className:"mr-2",variant:"primary",size:"sm",disabled:o.length==0,onClick:()=>c(!0),children:t`Bulk Reconfigure`}),l?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mr-2",variant:"secondary",size:"sm",onClick:()=>g(u.map(b=>b.id)),children:t`Select All`}),e.jsx(v,{className:"mr-2",variant:"secondary",size:"sm",onClick:()=>g([]),children:t`Clear Selection`})]}):null,x!=null&&x.data?e.jsx(bs,{show:!!x,handleClose:()=>m(void 0),fieldCount:x.division?2:r||1,config:x==null?void 0:x.data,setConfig:b=>{m(Object.assign({},x,{data:b})),nt(s,x.id,b)},isDualDivisionParent:l&&!x.division,style:"default",showMeetRankings:n,remoteConfig:!0}):null,e.jsxs(V,{show:j,onHide:()=>c(!1),children:[e.jsx(V.Header,{closeButton:!0,children:e.jsx(V.Title,{children:"Reconfigure Multiple Displays"})}),e.jsx(V.Body,{children:e.jsxs(we,{children:[l?e.jsxs(e.Fragment,{children:[e.jsx(U.Label,{column:!0,sm:"4",children:t`Division`}),e.jsx(he,{sm:"8",children:e.jsxs(U.Control,{as:"select",custom:!0,value:f,onChange:b=>T(parseInt(b.target.value)),children:[e.jsx("option",{value:0,children:t`Parent`}),d.map((b,a)=>e.jsx("option",{value:a+1,children:b},a))]})})]}):null,e.jsx(U.Label,{column:!0,sm:"4",children:t`Bind to Field`}),e.jsx(he,{sm:"8",children:e.jsxs(U.Control,{as:"select",custom:!0,value:y,onChange:b=>R(parseInt(b.target.value)),children:[e.jsx("option",{value:0,children:t`(All)`}),[...Array(f?2:r||1).keys()].map(b=>{const a=b+1;return e.jsx("option",{value:a,children:t`Field ${a}`},a)})]})})]})}),e.jsxs(V.Footer,{children:[e.jsx(v,{variant:"secondary",onClick:()=>c(!1),children:"Close"}),e.jsx(v,{variant:"primary",onClick:()=>P(),children:"Update Display"})]})]})]})}function xt(){const[s,i]=w.useState(void 0),[r,n]=w.useState(""),l=Ts();async function d(){if(i(void 0),n(t`Starting update...`),!await ht()){n("Failed to start video download.");return}const x=new WebSocket(`${window.location.protocol==="https:"?"wss":"ws"}://${window.location.host}/stream/manage/video_download/status/`);x.onmessage=function(m){const u=JSON.parse(m.data);u.progress?(i(u.progress),n(t`Downloading videos...`)):u.complete?(i(1),n(t`Video download complete!`),l.invalidateQueries({queryKey:["ceremony-videos"]})):u.error&&(i(1),n(t`Video download failed: `+u.error)),(u.complete||u.error)&&x.close()}}return e.jsxs("div",{children:[e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>d(),children:t`Download/Update Videos`}),r?e.jsxs("div",{children:[e.jsx("div",{children:r}),s!=null?e.jsx(Cs,{now:s,max:1}):null]}):null]})}function mt({eventCode:s}){var S;const i=vs({queryKey:["ceremony-videos"],queryFn:async function(){const o=await fetch("/ceremony-videos/manifest.json");if(o.status==404)return[];if(o.ok)return await o.json();throw new Error(`Error fetching video manifest: ${o.statusText}`)}}),[r,n]=w.useState(null),[l,d]=w.useState("en"),[x,m]=w.useState({}),u=(S=i.data)==null?void 0:S.find(o=>o.key==r);return e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Videos`}),e.jsxs(Ce,{variant:"warning",children:[t`Must be online to download videos.`,e.jsx("br",{}),t`Video will play on all audience displays.`,e.jsx("br",{}),t`Audio will not necessarily be synced between displays, so ensure you are only playing audio from one display.`,e.jsx("br",{}),t`Videos are not necessarily chroma-key safe. Ensure you are displaying the scoring display without chroma keying (transparent overlay is ok) when playing videos or play videos through an external system.`]}),i.data&&i.data.length>0?e.jsxs(U.Control,{as:"select",custom:!0,style:{width:"auto"},className:"mb-2",value:r||void 0,onChange:o=>n(o.target.value),children:[e.jsx("option",{value:"",children:t`Select a video`}),i.data.map(o=>e.jsx("option",{value:o.key,children:o.name},o.key))]}):i.data?e.jsx("span",{className:"mr-2",children:t`Videos must be downloaded`}):null,e.jsxs(U.Group,{className:"mb-2",children:[e.jsx(U.Label,{children:t`Subtitles`}),e.jsxs(U.Control,{as:"select",custom:!0,style:{width:"auto"},className:"ml-2",value:l,onChange:o=>d(o.target.value),disabled:!r,children:[(u==null?void 0:u.subtitleLocales.map(o=>e.jsx("option",{value:o.locale,children:new Intl.DisplayNames(document.documentElement.lang,{type:"language"}).of(o.locale)},o.locale)))||e.jsx("option",{children:t`Pick a video first`}),e.jsx("option",{value:"zz",children:t`Custom`})]}),l=="zz"&&r?e.jsx(v,{variant:x[r]?"secondary":"warning",className:"ml-2",onClick:()=>Xe({label:t`Upload Subtitle File`,text:t`Upload a subtitle file in WebVTT format (.vtt)`,onComplete:o=>{o&&m(g=>({...g,[r]:o}))},filter:{regex:"text/vtt",error:t`File must be a .vtt subtitle file`}}),children:x[r]?"Replace":"Upload"}):null]}),e.jsx(v,{className:"mr-2 mb-2",variant:"success",onClick:()=>{var o;return st(s,u.path,l=="zz"?x[r].previewUrl:((o=u.subtitleLocales.find(g=>g.locale==l))==null?void 0:o.path)||"")},disabled:!r||l=="zz"&&!x[r],children:t`Play Video`}),e.jsx(v,{className:"mr-2 mb-2",variant:"success",onClick:()=>tt(s),disabled:!r,children:t`Abort Video`}),e.jsx(xt,{})]})}function jt({eventCode:s,displayData:i,fieldCount:r,showMeetRankings:n,pinField:l,isDualDivisionParent:d,isDivision:x,divisions:m}){const[u,S]=w.useState(""),[o,g]=w.useState(!1),[j,c]=w.useState(!1);return w.useEffect(()=>{const f=document.createElement("div");f.innerHTML=u;let T=!1;return T||(T=f.textContent?f.textContent.length>0:!1),T||(T=f.getElementsByTagName("img").length>0),T||(T=f.getElementsByTagName("video").length>0),T||(T=f.getElementsByTagName("iframe").length>0),g(T),()=>f.remove()},[u]),e.jsxs("div",{children:[e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`General Information`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>Qs(s,l),children:t`Show Slideshow`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>_s(s,l),children:t`Show Sponsors`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>Ws(s,l),children:t`Show Wifi Reminder`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>Xs(s,l),children:t`Show Audience Key`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>Ks(s,l),children:t`Show Safety & Security`})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Eliminations`}),d||x?e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>$e(s,Ae.TWO_LEVEL,l),children:x?t`Show Bracket (this division)`:t`Show Bracket (interdivisional only)`}):null,d||x?null:e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>$e(s,Ae.FULL,l),children:d||x?t`Show Bracket (full)`:t`Show Bracket`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>qe(s,l),disabled:!!l,children:t`Show Alliance Selection`})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Other Displays`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>zs(s,l),children:t`Show Ranks & Results`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>Ys(s,l),children:t`Show Blank Screen`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>Js(s,l),children:t`Show Video Only (Overlay)`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>Zs(s,l),children:t`Show Online Results Info`}),e.jsx(v,{className:"mr-2",variant:"success",onClick:()=>qs(s,l),children:t`Show Inspection Status`})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Message`}),j?e.jsx("textarea",{className:"messageEditor",onChange:f=>S(f.target.value),children:u}):e.jsx(Ze,{className:"bg-white text-dark messageEditor",theme:"snow",value:u,modules:{toolbar:[[{color:[]},"italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["image"],["clean"]]},onChange:f=>{S(f)}}),e.jsx(v,{className:"btn-xs my-1",variant:"light",onClick:()=>c(f=>!f),children:j?t`Basic Editor`:t`Raw HTML`}),e.jsx("br",{}),e.jsx(v,{className:"mr-2",variant:"success",disabled:!o,onClick:()=>et(s,u,l),children:t`Show Message`})]}),e.jsx(mt,{eventCode:s}),e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Connected Displays`}),e.jsx(ut,{eventCode:s,displayData:i,fieldCount:r,showMeetRankings:n,isDualDivisionParent:d,divisions:m})]})]})}function ft({settings:s,eventCode:i,isMeet:r,isArchived:n,showHelp:l,activeType:d,activeMatch:x,syncStatus:m,timeoutData:u,resetElims:S,nowCallback:o,selectionState:g,showDeauthDetails:j,isDualDivisionParent:c,matches:f,unsavedMatchCount:T}){const y=w.useCallback(async(N,z)=>{await rt(i,N,z)},[]),R=d==="TEST",[h,D]=w.useState(""),[P,b]=w.useState(""),a=w.useId(),C=x&&(x==null?void 0:x.state)!=="REVIEW"&&(x==null?void 0:x.state)!=="SUBMITTED";o();const I=`<strong><u>${t`silently`}</u></strong>`,E=`<strong><u>${t`always silent`}</u></strong>`,B=J(),A=w.useCallback(async(N,z)=>{if(T>0&&z){_({label:t`Incomplete Matches!`,text:t`There are ${T} incomplete matches! Please commit them before entering test mode.`});return}await lt(N,z)},[T]),$=w.useCallback(async N=>{if(T>0){_({label:t`Incomplete Matches!`,text:t`There are ${T} incomplete matches! Please commit them before returning to practice matches.`});return}await ct(N)},[T]);return e.jsxs("div",{children:[n?e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Event Archived`}),t`This event has been archived and uploaded to FIRST. If you need to make any changes, please contact FIRST event help.`,e.jsx("button",{className:"btn btn-link",onClick:l,children:t`Contact Information`})]}):null,e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Active Match Schedule`}),e.jsx(v,{className:"mr-2",variant:n||C?"light":"success",disabled:n||C,onClick:()=>A(i,!R),children:R?t`Exit Test Mode`:t`Enter Test Mode`}),e.jsx(v,{className:"mr-2",variant:n||C?"light":"success",disabled:n||C||d!=="PRACTICE",title:d==="TEST"?t`Cannot advance to quals while in test mode`:void 0,onClick:()=>at(i),children:t`Advance to Quals`}),e.jsx(v,{className:"mr-2",variant:n||C?"light":"success",disabled:n||C||d!=="QUALS",title:d==="TEST"?t`Cannot return to practice while in test mode`:void 0,onClick:()=>$(i),children:t`Return to Practice`})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Timing Controls`}),e.jsx("div",{dangerouslySetInnerHTML:{__html:t`Timing still under development. All T206 and pre-violation G301 timers are started automatically and are ${E}`}}),e.jsx("div",{dangerouslySetInnerHTML:{__html:t`Expected start timers will be ${I} ended if the next match is started. A running timer will not prevent match start - just make sure all teams are ready!`}})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Live Scoring`}),e.jsx(U.Check,{type:"checkbox",label:t`Use Live Scoring`,checked:s.liveScoring||!1,disabled:n,onChange:N=>y("liveScoring",N.target.checked),id:J()}),e.jsx(U.Check,{type:"checkbox",label:t`Require Referee Init Submit Before Match Start`,checked:s.waitForInitSubmit||!1,onChange:N=>y("waitForInitSubmit",N.target.checked),id:J()}),e.jsx(U.Check,{type:"checkbox",label:e.jsxs(e.Fragment,{children:[t`Enable HR Match Control (Beta)`," ",e.jsx("i",{className:"fa fa-question-circle",title:t`Allows basic match control from HR page.`})]}),checked:s.hrControl||!1,onChange:N=>y("hrControl",N.target.checked),id:J()}),e.jsx(U.Check,{type:"checkbox",label:t`Allow External Randomization`,checked:s.externalRandom,disabled:n,onChange:N=>y("externalRandom",N.target.checked),id:J()})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Control Page Appearance`}),e.jsx(U.Check,{type:"checkbox",label:t`Flip Alliances (Red on Left)`,checked:s.flipControl||!1,onChange:N=>y("flipControl",N.target.checked),id:J()}),t`Score tab contrast: `,e.jsxs("select",{value:s.controlContrast||"standard",onChange:N=>y("controlContrast",N.target.value),children:[e.jsx("option",{value:"standard",children:"Standard"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"max",children:"Max"}),e.jsx("option",{value:"dark",children:"Dark Mode"})]})]}),r?e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Scoring/Pit Display Options`}),e.jsx(U.Check,{type:"checkbox",label:t`Show Event Rankings in addition to League Rankings.`,checked:s.showMeetRankings,onChange:N=>y("showMeetRankings",N.target.checked),id:B})]}):null,e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Sync Settings`}),t`Sync Delay: `,e.jsx("i",{className:"fas fa-question-circle",title:t`Delay between match commit and when the match data is sent to FIRST. 10s is the default and recommended checked. This does not affect 3rd party API clients running locally.`}),e.jsxs("select",{value:s.syncDelay,onChange:N=>y("syncDelay",N.target.value),children:[e.jsx("option",{value:"10",children:t`10 seconds`}),e.jsx("option",{value:"30",children:t`30 seconds`}),e.jsx("option",{value:"60",children:t`1 minute`}),e.jsx("option",{value:"300",children:t`5 minutes`})]}),e.jsx("br",{}),"Last successful sync: ",m.lastSyncTime>0?new Date(m.lastSyncTime).toLocaleTimeString():t`N/A`,e.jsx("br",{}),e.jsx(v,{className:"mt-2",variant:"success",onClick:async()=>D(await ot(i)),children:t`Test Connection to HQ`})," ",e.jsx("span",{children:h}),e.jsx("br",{}),e.jsx(v,{className:"mt-2",variant:"success",onClick:async()=>b(await dt(i)),children:t`Sync Now`})," ",e.jsx("span",{children:P})]}),s.allowPlayoffOverrides?e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Playoff Configuration Overrides`}),e.jsxs("label",{htmlFor:`${a}-playoff-type`,children:[t`Playoff type:`," "]}),e.jsxs("select",{value:s.playoffTypeOverride,id:`${a}-playoff-type`,disabled:n||d=="ELIMS"||!!g,onChange:N=>{y("playoffTypeOverride",N.target.value),s.allianceCountOverride==6&&N.target.value==="SINGLE_ELIMINATION"&&y("allianceCountOverride",0)},children:[e.jsx("option",{value:"",children:"(default)"}),e.jsx("option",{value:"DOUBLE_ELIMINATION",children:"Double Elimination"}),e.jsx("option",{value:"DOUBLE_ELIMINATION_WITH_FINALS",children:"Double Elimination With Finals (FRC-Style)"}),e.jsx("option",{value:"SINGLE_ELIMINATION",children:"Single Elimination"})]}),e.jsx("br",{}),e.jsxs("label",{htmlFor:`${a}-alliance-count`,children:[t`Alliance count:`," "]}),e.jsxs("select",{value:s.allianceCountOverride,id:`${a}-alliance-count`,disabled:n||d=="ELIMS"||!!g,onChange:N=>y("allianceCountOverride",N.target.value),children:[e.jsx("option",{value:"0",children:"(default)"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"4",children:"4"}),e.jsx("option",{value:"6",disabled:s.playoffTypeOverride=="SINGLE_ELIMINATION",children:"6"}),e.jsx("option",{value:"8",children:"8"})]}),e.jsx("br",{}),e.jsxs("label",{htmlFor:`${a}-teams-per-alliance`,children:[t`Teams per alliance:`," "]}),e.jsxs("select",{value:`${s.teamsPerAllianceOverride}-${s.allowBackupsOverride}`,id:`${a}-teams-per-alliance`,disabled:n||d=="ELIMS"||!!g,onChange:N=>{const z=N.target.value.split("-");y("teamsPerAllianceOverride",z[0]),y("allowBackupsOverride",z[1])},children:[e.jsx("option",{value:"0-",children:"(default)"}),e.jsx("option",{value:"2-false",children:"2"}),e.jsx("option",{value:"2-true",children:"2 (with backups)"}),e.jsx("option",{value:"3-false",children:"3"})]})]}):null,e.jsxs("fieldset",{children:[e.jsx("legend",{children:t`Danger Zone`}),e.jsx(v,{className:"mt-2 mr-2",variant:"danger",onClick:()=>S(),disabled:d!=="ELIMS"&&!g||n||d==="ELIMS"&&f.some(N=>N.state==="COMMITTED"),children:c?t`Reset Playoff Matches`:t`Reset Alliance Selection`}),j&&e.jsx(v,{className:"mt-2 mr-2",variant:"warning",onClick:j,children:t`Deauth Event Details`})]})]})}const ee={className:"mr-2",variant:"light"},se=s=>e.jsx(v,{size:"xs",...s});function De(s){return"series"in s}function Oe({matches:s,liveScoring:i,archived:r,loadMatch:n,editMatch:l,commitMatch:d,postMatch:x,replayMatch:m,testMode:u,eventCode:S,fieldCount:o,qualsActive:g,practiceActive:j,activeMatchRunning:c}){const[f,T]=w.useState(!1);if(s.length>0&&s[0].type==="QUALS"&&!g)return e.jsxs("div",{className:"testFooter",children:[t`Qualification schedule is not active.`,e.jsx("br",{}),e.jsx("a",{target:"_blank",href:"../dashboard/schedule/quals/",children:t`Activate it here.`})]});if(s.length>0&&s[0].type==="PRACTICE"&&!j)return e.jsxs("div",{className:"testFooter",children:[t`Practice schedule is not active.`,e.jsx("br",{}),e.jsx("a",{target:"_blank",href:"../dashboard/schedule/practice/",children:t`Activate it here.`})]});const y=!s.some(h=>h.blue.team3Display||h.red.team3Display),R=s.some(h=>{var D;return(D=h.seriesDescription)==null?void 0:D.round});return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"schedule",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Match"}),R?e.jsx("th",{children:"Round"}):null,e.jsx("th",{children:"Field"}),e.jsx("th",{children:"State"}),e.jsx("th",{children:"Red Score"}),R?e.jsx("th",{children:"Red"}):null,e.jsx("th",{children:"Red 1"}),e.jsx("th",{children:"Red 2"}),e.jsx("th",{hidden:y,children:"Red 3"}),e.jsx("th",{children:"Blue 1"}),e.jsx("th",{children:"Blue 2"}),e.jsx("th",{hidden:y,children:"Blue 3"}),R?e.jsx("th",{children:"Blue"}):null,e.jsx("th",{children:"Blue Score"}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:s==null?void 0:s.map(h=>{var b;const D=h.type!=="ELIMS"||!s.filter(a=>a.state=="COMMITTED").some(a=>{var C,I,E;return a.seriesDescription&&(De(a.seriesDescription.red)&&a.seriesDescription.red.series==((C=h.seriesDescription)==null?void 0:C.series)||De(a.seriesDescription.blue)&&a.seriesDescription.blue.series==((I=h.seriesDescription)==null?void 0:I.series))||h.seriesDescription&&h.seriesDescription.series==((E=a.seriesDescription)==null?void 0:E.series)&&a.number>h.number&&a.number>h.seriesDescription.matchesToWin}),P=a=>!a||a.length===0?"":a.charAt(0)>="0"&&a.charAt(0)<="9"?"A"+a:a;return e.jsxs("tr",{children:[e.jsx("td",{children:h.name}),R?e.jsx("td",{children:(b=h.seriesDescription)==null?void 0:b.round}):null,e.jsx("td",{children:h.field}),e.jsx("td",{children:h.state==="TELEOP"?"DRIV-CTRL":h.state}),e.jsx("td",{children:Math.max(0,h.redTotal||0)}),R?e.jsx("td",{children:P(h.redSeed)}):null,e.jsx("td",{children:h.red.team1Display}),e.jsx("td",{children:h.red.team2Display}),e.jsx("td",{hidden:y,children:h.red.team3Display}),e.jsx("td",{children:h.blue.team1Display}),e.jsx("td",{children:h.blue.team2Display}),e.jsx("td",{hidden:y,children:h.blue.team3Display}),R?e.jsx("td",{children:P(h.blueSeed)}):null,e.jsx("td",{children:Math.max(0,h.blueTotal||0)}),D&&(h.state==="UNPLAYED"||h.state==="RANDOMIZED")&&h.number>0?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx(se,{id:"qualificationPlayButton"+h.number,...ee,onClick:()=>n(h.number),disabled:r,children:t`Play`})}),e.jsx("td",{children:e.jsx(se,{id:"qualificationEnterScoresButton"+h.number,...ee,onClick:()=>l(h.number),disabled:r,children:t`Enter Scores`})})]}):null,h.state==="COMMITTED"||h.state==="SUBMITTED"?e.jsx("td",{children:D?e.jsx(se,{...ee,onClick:()=>m(h.number),disabled:r,children:t`Replay`}):""}):null,h.state==="SUBMITTED"&&i?e.jsx("td",{children:e.jsx(se,{...ee,onClick:()=>d(h.number),children:t`Commit`})}):null,h.state==="COMMITTED"?e.jsx("td",{children:e.jsx(se,{...ee,onClick:()=>x(h.number),disabled:c,children:t`Post`})}):null,D&&(h.state==="COMMITTED"||h.state==="SUBMITTED")?e.jsx("td",{children:e.jsx(se,{...ee,onClick:()=>l(h.number),children:i||h.state==="COMMITTED"?t`Edit`:t`Enter Scores`})}):null,h.state==="REVIEW"?e.jsx("td",{children:e.jsx(se,{...ee,onClick:()=>l(h.number),children:t`View`})}):null,e.jsx("td",{colSpan:4})]},h.number)})})]}),u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"testFooter",children:[t`System in Test Mode. Click to create a new Test Match:`," ",e.jsx(v,{variant:"success",onClick:()=>T(!0),children:t`Add Test Match`}),e.jsx("br",{}),t`Use the Settings tab to exit Test Mode.`]}),e.jsx(es,{eventCode:S,close:()=>T(!1),visible:f,fieldCount:o})]}):null]})}function pt({visible:s,close:i,eventCode:r,match:n,updateMatchDetails:l}){const[d,x]=w.useState([]),[m,u]=w.useState(-1),[S,o]=w.useState();if(w.useEffect(()=>{(async()=>{if(!s||!n){u(-1);return}const c=await ss(r,n.number);x(c),u(c.length-1)})()},[s,n]),w.useEffect(()=>{(async()=>{if(!n||m<0){o(void 0);return}const c=`/event/${r}/match/${d[m].split(":")[0].toLowerCase()}/history/${m}/?embed=true`,T=await(await fetch(c)).text();o({__html:T})})()},[n,m]),!n)return e.jsx(e.Fragment,{});function g(){x([]),i()}async function j(){l(await ts(r,n.number,m)),g()}return e.jsxs(V,{show:s,onHide:g,dialogClassName:"matchHistoryModal",scrollable:!0,children:[e.jsx(V.Header,{closeButton:!0,children:e.jsx(V.Title,{children:t`Commit History for ${n.name}`})}),e.jsxs(V.Body,{children:[t`Select Record`,e.jsx("select",{className:"ml-2 w-50",value:m,onChange:c=>u(parseInt(c.target.value)),children:[...d].reverse().map((c,f)=>e.jsx("option",{value:d.length-f-1,children:c},f))}),e.jsx(v,{className:"ml-2",variant:"success",disabled:m<0,onClick:j,children:t`Copy to Editor`}),S?e.jsx("div",{className:"scoresheetContainer",dangerouslySetInnerHTML:S}):null]})]})}function bt(s,i){return{teams:s,noshows:[1,2,3].map(r=>i==null?void 0:i[`noshow${r}`])}}function Be(s,i,r){const n=[...r];if(i<0||i>=n.length)throw new Error(`Invalid position ${i} for classifier state`);return n[i]=s,n}const Le=[L.NONE,L.NONE,L.NONE,L.NONE,L.NONE,L.NONE,L.NONE,L.NONE,L.NONE];function Fe({details:s,color:i,updateScore:r,otherDetails:n,updateBothScores:l,readOnly:d,teams:x,otherTeams:m,random:u,isPlayoff:S}){const o=J(),g=gt(bt(x,s)),j=u&&u>0?ue[u]:ue[1];return e.jsxs(e.Fragment,{children:[e.jsxs("fieldset",{className:"autoScores",children:[e.jsx("legend",{children:"AUTO"}),e.jsxs("div",{className:"d-flex",style:{flexWrap:"wrap",gap:"4px",justifyContent:"start"},children:[e.jsxs("table",{className:"borderedTable",style:{textAlign:"center"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{colSpan:2,children:"ARTIFACT"})})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{className:"scoreItem",htmlFor:`${o}-autoClassifiedArtifacts`,children:"CLASSIFIED"})}),e.jsx("td",{children:e.jsx("input",{id:`${o}-autoClassifiedArtifacts`,disabled:d,type:"number",min:"0",max:"1000",value:Math.max(0,(s==null?void 0:s.autoClassifiedArtifacts)??0),onChange:c=>r("autoClassifiedArtifacts",parseInt(c.target.value))})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{className:"scoreItem",htmlFor:`${o}-autoOverflowArtifacts`,children:"OVERFLOW"})}),e.jsx("td",{children:e.jsx("input",{id:`${o}-autoOverflowArtifacts`,disabled:d,type:"number",min:"0",max:"1000",value:Math.max(0,(s==null?void 0:s.autoOverflowArtifacts)??0),onChange:c=>r("autoOverflowArtifacts",parseInt(c.target.value))})})]})]})]}),e.jsxs("table",{className:"borderedTable",style:{textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("td",{children:"Location"}),e.jsx("th",{children:"None"}),e.jsx("th",{children:"LEAVE"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:g.robot1?g.robot1:"R1"}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot1Auto)??0)===0,onChange:c=>r("robot1Auto",(c.target.checked,0))})}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot1Auto)??0)===1,onChange:c=>r("robot1Auto",c.target.checked?1:0)})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:g.robot2?g.robot2:"R2"}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot2Auto)??0)===0,onChange:c=>r("robot2Auto",(c.target.checked,0))})}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot2Auto)??0)===1,onChange:c=>r("robot2Auto",c.target.checked?1:0)})})]})]})]})]}),e.jsxs("table",{className:"borderedTable",style:{textAlign:"center",marginTop:"4px"},children:[e.jsxs("thead",{children:[e.jsx("tr",{children:e.jsx("th",{colSpan:11,children:"PATTERN"})}),e.jsxs("tr",{children:[e.jsx("th",{children:"GATE"}),e.jsx("td",{className:"px-2",children:"1"}),e.jsx("td",{className:"px-2",children:"2"}),e.jsx("td",{className:"px-2",children:"3"}),e.jsx("td",{className:"px-2",children:"4"}),e.jsx("td",{className:"px-2",children:"5"}),e.jsx("td",{className:"px-2",children:"6"}),e.jsx("td",{className:"px-2",children:"7"}),e.jsx("td",{className:"px-2",children:"8"}),e.jsx("td",{className:"px-2",children:"9"}),e.jsx("th",{children:"SQUARE"})]})]}),e.jsx("tbody",{children:[L.GREEN,L.PURPLE,L.NONE].map(c=>e.jsxs("tr",{children:[e.jsx("th",{children:c}),((s==null?void 0:s.autoClassifierState)||Le).map((f,T)=>e.jsx("td",{className:c==f&&f==j[T%3]?"classifiedMatches":"",children:e.jsx("input",{disabled:d,type:"radio",name:`${o}-autoClassifier${T}`,checked:f==c,onChange:y=>y.target.checked?r("autoClassifierState",Be(c,T,s.autoClassifierState)):null})},T)),e.jsx("th",{children:c})]},c))})]})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{children:"TELEOP"}),e.jsxs("div",{className:"d-flex",style:{flexWrap:"wrap",gap:"4px",justifyContent:"start"},children:[e.jsxs("table",{className:"borderedTable",style:{textAlign:"center"},children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{colSpan:2,children:"ARTIFACT"})})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{className:"scoreItem",htmlFor:`${o}-teleopClassifiedArtifacts`,children:"CLASSIFIED"})}),e.jsx("td",{children:e.jsx("input",{id:`${o}-teleopClassifiedArtifacts`,disabled:d,type:"number",min:"0",max:"1000",value:Math.max(0,(s==null?void 0:s.teleopClassifiedArtifacts)??0),onChange:c=>r("teleopClassifiedArtifacts",parseInt(c.target.value))})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{className:"scoreItem",htmlFor:`${o}-teleopOverflowArtifacts`,children:"OVERFLOW"})}),e.jsx("td",{children:e.jsx("input",{id:`${o}-teleopOverflowArtifacts`,disabled:d,type:"number",min:"0",max:"1000",value:Math.max(0,(s==null?void 0:s.teleopOverflowArtifacts)??0),onChange:c=>r("teleopOverflowArtifacts",parseInt(c.target.value))})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("label",{className:"scoreItem",htmlFor:`${o}-teleopDepotArtifacts`,children:"DEPOT"})}),e.jsx("td",{children:e.jsx("input",{id:`${o}-teleopDepotArtifacts`,disabled:d,type:"number",min:"0",max:"1000",value:Math.max(0,(s==null?void 0:s.teleopDepotArtifacts)??0),onChange:c=>r("teleopDepotArtifacts",parseInt(c.target.value))})})]})]})]}),e.jsxs("table",{className:"borderedTable egNavigated",style:{textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("td",{children:"BASE"}),e.jsx("th",{children:"None"}),e.jsx("th",{children:"Partial"}),e.jsx("th",{children:"Full"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:g.robot1?g.robot1:"R1"}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot1Teleop)??0)===0,onChange:c=>r("robot1Teleop",(c.target.checked,0))})}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot1Teleop)??0)===1,onChange:c=>r("robot1Teleop",c.target.checked?1:0)})}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot1Teleop)??0)===2,onChange:c=>r("robot1Teleop",c.target.checked?2:0)})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:g.robot2?g.robot2:"R2"}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot2Teleop)??0)===0,onChange:c=>r("robot2Teleop",(c.target.checked,0))})}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot2Teleop)??0)===1,onChange:c=>r("robot2Teleop",c.target.checked?1:0)})}),e.jsx("td",{children:e.jsx("input",{disabled:d,type:"checkbox",checked:Math.max(0,(s==null?void 0:s.robot2Teleop)??0)===2,onChange:c=>r("robot2Teleop",c.target.checked?2:0)})})]})]})]})]}),e.jsxs("table",{className:"borderedTable",style:{textAlign:"center",marginTop:"4px"},children:[e.jsxs("thead",{children:[e.jsx("tr",{children:e.jsx("th",{colSpan:11,children:"PATTERN"})}),e.jsxs("tr",{children:[e.jsx("th",{children:"GATE"}),e.jsx("td",{className:"px-2",children:"1"}),e.jsx("td",{className:"px-2",children:"2"}),e.jsx("td",{className:"px-2",children:"3"}),e.jsx("td",{className:"px-2",children:"4"}),e.jsx("td",{className:"px-2",children:"5"}),e.jsx("td",{className:"px-2",children:"6"}),e.jsx("td",{className:"px-2",children:"7"}),e.jsx("td",{className:"px-2",children:"8"}),e.jsx("td",{className:"px-2",children:"9"}),e.jsx("th",{children:"SQUARE"})]})]}),e.jsx("tbody",{children:[L.GREEN,L.PURPLE,L.NONE].map(c=>e.jsxs("tr",{children:[e.jsx("th",{children:c}),((s==null?void 0:s.teleopClassifierState)||Le).map((f,T)=>e.jsx("td",{className:c==f&&f==j[T%3]?"classifiedMatches":"",children:e.jsx("input",{disabled:d,type:"radio",name:`${o}-teleopClassifier${T}`,checked:f==c,onChange:y=>y.target.checked?r("teleopClassifierState",Be(c,T,s.teleopClassifierState)):null})},T)),e.jsx("th",{children:c})]},c))})]})]}),e.jsxs("fieldset",{className:"penalties",children:[e.jsx("legend",{children:t`FOULS`}),e.jsxs("label",{htmlFor:`${o}-minorPenalties`,children:[t`MINOR`," "]}),e.jsx("input",{id:`${o}-minorPenalties`,disabled:d,type:"number",min:0,value:s==null?void 0:s.minor,onChange:c=>r("minor",parseInt(c.target.value))})," ",e.jsxs("label",{htmlFor:`${o}-majorPenalties`,children:[t`MAJOR`," "]}),e.jsx("input",{id:`${o}-majorPenalties`,disabled:d,type:"number",min:0,value:s==null?void 0:s.major,onChange:c=>r("major",parseInt(c.target.value))})]}),S?null:e.jsxs("fieldset",{className:"violations",children:[e.jsx("legend",{children:t`VIOLATIONS`}),e.jsx("input",{id:`${o}-G206`,disabled:d,type:"checkbox",checked:s==null?void 0:s.violations.includes("G206"),onChange:c=>r("violations",c.target.checked?[...s.violations,"G206"]:s.violations.filter(f=>f!="G206"))}),e.jsx("label",{htmlFor:`${o}-G206`,className:"mr-3",children:" G206"}),e.jsx("input",{id:`${o}-G417`,disabled:d,type:"checkbox",checked:(s==null?void 0:s.violations.includes("G417"))||(s==null?void 0:s.violations.includes("G417.A")),onChange:c=>r("violations",c.target.checked?[...s.violations,"G417.A"]:s.violations.filter(f=>f!="G417"&&f!="G417.A"))}),e.jsx("label",{htmlFor:`${o}-G417`,className:"mr-3",children:" G417.A"}),e.jsx("input",{id:`${o}-G418A`,disabled:d,type:"checkbox",checked:s==null?void 0:s.violations.includes("G418.A"),onChange:c=>r("violations",c.target.checked?[...s.violations,"G418.A"]:s.violations.filter(f=>f!="G418.A"))}),e.jsx("label",{htmlFor:`${o}-G418A`,className:"mr-3",children:" G418.A"}),e.jsx("input",{id:`${o}-G418B`,disabled:d,type:"checkbox",checked:s==null?void 0:s.violations.includes("G418.B"),onChange:c=>r("violations",c.target.checked?[...s.violations,"G418.B"]:s.violations.filter(f=>f!="G418.B"))}),e.jsx("label",{htmlFor:`${o}-G418B`,className:"mr-3",children:" G418.B"}),e.jsx("input",{id:`${o}-G419B`,disabled:d,type:"checkbox",checked:s==null?void 0:s.violations.includes("G419.B"),onChange:c=>r("violations",c.target.checked?[...s.violations,"G419.B"]:s.violations.filter(f=>f!="G419.B"))}),e.jsx("label",{htmlFor:`${o}-G419B`,className:"mr-3",children:" G419.B"}),e.jsx("input",{id:`${o}-G431C`,disabled:d,type:"checkbox",checked:s==null?void 0:s.violations.includes("G431.C"),onChange:c=>r("violations",c.target.checked?[...s.violations,"G431.C"]:s.violations.filter(f=>f!="G431.C"))}),e.jsx("label",{htmlFor:`${o}-G431C`,className:"mr-3",children:" G431.C"})]})]})}function gt(s){if(s!=null&&s.teams[2]){let i=0,r=0;return s.noshows.some(n=>n&&n>0)?(s.noshows[0]||(i=s.teams[0]||0),s.noshows[1]||(i?r=s.teams[1]||0:i=s.teams[1]||0),s.noshows[2]||(i?r=s.teams[2]:i=s.teams[2]),{robot1:i,robot2:r,ns1:!i,ns2:!r}):{robot1:s.teams[0]||0,robot2:s.teams[1]||0,ns1:!1,ns2:!1}}else return{robot1:(s==null?void 0:s.teams[0])||0,robot2:(s==null?void 0:s.teams[1])||0,ns1:!!(s!=null&&s.noshows[0]||!(s!=null&&s.teams[0])),ns2:!!(s!=null&&s.noshows[1]||!(s!=null&&s.teams[1]))}}function yt({score:s,breakdown:i,other:r,isPlayoff:n}){return e.jsx("table",{children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"AUTO"}),e.jsx("th",{children:(s==null?void 0:s.autonomousPoints)||0})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"LEAVE Points"}),e.jsx("td",{children:(i==null?void 0:i.autoLeavePoints)||0})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"ARTIFACT Points"}),e.jsx("td",{children:(i==null?void 0:i.autoArtifactPoints)||0})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"PATTERN Points"}),e.jsx("td",{children:(i==null?void 0:i.autoPatternPoints)||0})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"TELEOP"}),e.jsx("th",{children:(s==null?void 0:s.teleopPoints)||0})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"ARTIFACT Points"}),e.jsx("td",{children:((i==null?void 0:i.teleopArtifactPoints)||0)+((i==null?void 0:i.teleopDepotPoints)||0)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"PATTERN Points"}),e.jsx("td",{children:(i==null?void 0:i.teleopPatternPoints)||0})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"BASE Points"}),e.jsx("td",{children:(i==null?void 0:i.teleopBasePoints)||0})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"FOUL"}),e.jsx("th",{children:(r==null?void 0:r.penaltyPoints)||0})]}),n?null:e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Movement RP"}),e.jsx("td",{children:e.jsx("i",{className:`fa ${i!=null&&i.movementRP?"fa-check":"fa-x"}`})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Goal RP"}),e.jsx("td",{children:e.jsx("i",{className:`fa ${i!=null&&i.goalRP?"fa-check":"fa-x"}`})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Pattern RP"}),e.jsx("td",{children:e.jsx("i",{className:`fa ${i!=null&&i.patternRP?"fa-check":"fa-x"}`})})]})]})]})})}function vt({random:s}){const i=s&&s>0?["","MOTIF 1 (ID 21)","MOTIF 2 (ID 22)","MOTIF 3 (ID 23)"][s]:"",r=Ke("img/decode/gate.svg");return e.jsxs("div",{className:"randomization",children:[e.jsx("div",{className:"text-center",children:i?t`Randomization: ${i}`:"MATCH NOT RANDOMIZED!"}),e.jsxs("div",{className:"text-center hr-artifacts",children:[e.jsx(Re,{src:r,className:"randomizer-icon"}),e.jsx(ve,{value:i&&s?ue[s][0]:L.NONE}),e.jsx(ve,{value:i&&s?ue[s][1]:L.NONE}),e.jsx(ve,{value:i&&s?ue[s][2]:L.NONE}),e.jsx(Re,{src:ns,className:"randomizer-icon"})]})]})}const ie=2,pe=1,te=s=>e.jsx(v,{size:"xs",...s});function Ue({match:s,isElims:i,alliance:r,cardCarries:n,detailAlliance:l,right:d,color:x,updateScore:m,readOnly:u}){return e.jsx("div",{dir:d?"ltr":"rtl",className:`allianceCards ${d?"right":"left"} ${i?"elims":""}`,children:e.jsx("table",{children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:x}),i?e.jsx("td",{title:t`Not Playing`,children:"NP"}):e.jsx("td",{title:t`No ROBOT. (With Team Member present)`,children:"NR"}),e.jsx("td",{title:t`DISQUALIFIED`,children:"DQ"}),e.jsx("td",{title:t`YELLOW CARD. Check Y & R if 2nd+ YELLOW CARD.`,children:"Y"}),e.jsx("td",{title:t`RED CARD.`,children:"R"})]}),[1,2,3].map(S=>{const o=i||S==3?1:S,g=n==null?void 0:n[`team${o}`],j=g&&g.length>0,c=g&&g.filter(y=>y!==(s==null?void 0:s.shortName)).length===0,f=(((l==null?void 0:l[`card${o}`])||0)&ie)!==0,T=(((l==null?void 0:l[`card${o}`])||0)&pe)!==0;return!r||r[`team${S}`]?e.jsxs("tr",{children:[e.jsx("td",{style:{backgroundColor:j?"yellow":"transparent"},title:j?t`Earned cards in ${g}`:"",children:r==null?void 0:r[`team${S}Display`]}),i?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:(l==null?void 0:l[`noshow${S}`])===1,onChange:y=>m(`noshow${S}`,y.target.checked?1:0),disabled:u})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:(l==null?void 0:l.dq1)===1,onChange:y=>m("dq1",y.target.checked?1:0),disabled:u||(((l==null?void 0:l.card1)??0)&ie)!==0})})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:((l==null?void 0:l[`noshow${S}`])??0)>0,onChange:y=>m(`noshow${S}`,y.target.checked?2:0),disabled:u})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:(l==null?void 0:l[`dq${o}`])===1,onChange:y=>{m(`dq${o}`,y.target.checked?1:0),(l==null?void 0:l[`noshow${o}`])==1&&m(`noshow${o}`,2)},disabled:u||f})})]}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:T,onChange:y=>{let R=y.target.checked?l[`card${o}`]|pe:l[`card${o}`]&-2;R&pe&&j&&!c&&(R|=ie),m(`card${o}`,R)},disabled:u})}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:(((l==null?void 0:l[`card${o}`])||0)&ie)!==0,onChange:y=>{let R=y.target.checked?l[`card${o}`]|ie:l[`card${o}`]&-3;R&pe&&j&&!c&&(R|=ie),m(`card${o}`,R)},disabled:u||T&&j&&!c,title:T&&j&&!c?t`Because of prior CARD, any YELLOW CARD in this MATCH must lead to a RED CARD. To remove the RED CARD, first remove the YELLOW CARD.`:""})})]},S):null})]})})})}function Ge({score:s,breakdown:i,showAdjust:r,other:n,updateScore:l,isPlayoff:d}){const x="T605.B",m="T605.C",u=J();return e.jsxs(e.Fragment,{children:[e.jsx("legend",{children:t`Score Breakdown`}),e.jsx(yt,{score:s,breakdown:i,other:n,isPlayoff:d}),r?e.jsx(fe,{bg:"warning",style:{width:"250px"},children:e.jsxs(fe.Body,{children:[e.jsx(fe.Title,{style:{textAlign:"center"},children:t`Adjust`}),e.jsx(fe.Text,{children:t`Use this field to give 1 point to the ALLIANCE that was DISQUALIFIED second (The winner by ${x}), unless it was simultaneous (${m})`}),e.jsx(U.Check,{type:"checkbox",label:t`Tiebreak Point`,checked:s.adjust>0,onChange:S=>l("adjust",S.target.checked?1:0),id:u})]})}):null]})}const be=[Te.AUTO,Te.TELEOP,Te.REVIEW];function Ve({isArchived:s,showHelp:i,settings:r,match:n,eventCode:l,openMatchForEditing:d,lockoutMatch:x,commitMatch:m,active:u,activeMatchRunning:S}){var ne,ae,ce,Q,oe,W;const[o,g]=w.useState(!u),[j,c]=w.useState(),[f,T]=w.useState(!1),[y,R]=w.useState(!1),h=w.useRef(),[D,P]=w.useState(!1);if(w.useEffect(()=>{(async()=>{if(!(u||!(n!=null&&n.number))){if((j==null?void 0:j.number)===n.number&&(j==null?void 0:j.type)===n.type&&!y&&be.includes(h.current)===be.includes(n.state)){h.current=n.state;return}be.includes(n.state)?(c(void 0),g(!1)):(g(!0),c(await is(l,n.number)),g(!1),R(!1),T(!1))}})()},[n==null?void 0:n.type,n==null?void 0:n.number,n==null?void 0:n.state,y]),!u&&!n)return null;if(o)return e.jsxs("div",{children:["Loading match data...",e.jsx(ze,{animation:"border"})]});async function b(k,M,H,me){const je=k==="both"?{red:Object.assign({},j.red,{[M]:H}),blue:Object.assign({},j.blue,{[M]:me})}:{[k]:Object.assign({},j[k],{[M]:H})},p=Object.assign({},{red:j.red,blue:j.blue},je);(k==="red"||k==="blue")&&(M==="card1"&&H>1&&(p[k].dq1=1),M==="card2"&&H>1&&(p[k].dq2=1),(!p.red.dq1||!p.blue.dq1)&&(p.blue.adjust||p.red.adjust)&&(p.red.adjust=0,p.blue.adjust=0)),T(!0),c(await rs(l,n.number,p))}async function a(){await ls(l,n.number,{red:j.red,blue:j.blue}),T(!1)}async function C(){await re({label:t`Override Referees?`,text:t`This will lock out referee devices from submitting any more scores. Any unsubmitted changes on their devices will be lost.`,buttonText:t`Lockout`})&&await x(n.number)}async function I(){f||n.state!=="SUBMITTED"?(await a(),m(n.number,!1)):m(n.number,!0)}let E=u||!1,B;if(s)E=!0,B=e.jsxs("div",{className:"editBanner",children:[t`This event has been archived and uploaded to FIRST. If you need to make any changes, please contact FIRST event help.`,e.jsx("button",{className:"btn btn-link",onClick:i,children:t`Contact Information`})," "]});else if(u||!n)n&&n.state!=="AUTO"&&n.state!=="TELEOP"&&d&&(B=e.jsxs("div",{className:"editBanner",style:{fontSize:"20px"},children:[t`Showing scores for previous match.  Scores will clear at start of next match.`," ",e.jsx(te,{className:"ml-2",style:{fontSize:"20px"},variant:"info",onClick:()=>d(n.number),children:"To Edit Click Here"})," "]}));else if(!be.includes(n.state))B=e.jsxs("div",{className:"editBanner p-1",children:[e.jsx(te,{className:"mx-2",variant:"primary",disabled:n.type==="TEST"||(j==null?void 0:j.historySize)===0,onClick:()=>P(!0),children:t`View History`}),e.jsx(te,{className:"mx-2",variant:"primary",disabled:!f,onClick:()=>R(!0),children:t`Cancel Edits`}),e.jsx(te,{className:"mx-2",variant:"primary",disabled:!f,onClick:()=>a(),children:t`Save Edits`}),e.jsx(te,{className:"mx-2",variant:"primary",disabled:n.state==="COMMITTED"&&!f,onClick:()=>I(),children:t`Commit`}),e.jsx(te,{className:"mx-2",variant:"primary",disabled:n.state!=="COMMITTED"||S||f,onClick:()=>He(l,n.number),children:t`Post Results`})]});else{E=!0;let k;!n.red.reviewSubmitted&&!n.blue.reviewSubmitted?k=t`Red, Blue`:n.red.reviewSubmitted?n.blue.reviewSubmitted?k=t`HR`:k=t`Blue`:k=t`Red`;const M=e.jsx(te,{className:"ml-2",style:{fontSize:"20px"},variant:"danger",onClick:()=>C(),children:"Force Edit"});B=e.jsxs("div",{className:"editBanner",style:{fontSize:"20px"},children:[t`Waiting for referees (${k}) to submit scores.`," ",n.state==="REVIEW"?M:null," "]})}const A=j?j.red:(ne=n==null?void 0:n.red)==null?void 0:ne.scores,$=j?j.blue:(ae=n==null?void 0:n.blue)==null?void 0:ae.scores,N=j?j.redBreakdown:(ce=n==null?void 0:n.red)==null?void 0:ce.breakdown,z=j?j.blueBreakdown:(Q=n==null?void 0:n.blue)==null?void 0:Q.breakdown,le=j?{team1:j.redCardCarries1,team2:j.redCardCarries2}:(oe=n==null?void 0:n.red)==null?void 0:oe.cardCarries,xe=j?{team1:j.blueCardCarries1,team2:j.blueCardCarries2}:(W=n==null?void 0:n.blue)==null?void 0:W.cardCarries;let q=A?A.scoredPoints+$.penaltyPoints-(n.state!=="AUTO"?0:A.teleopToSubtractFromAuto)-(n.state!=="AUTO"&&n.state!=="TELEOP"?0:A.teleopToSubtractFromInMatch):0,F=$?$.scoredPoints+A.penaltyPoints-(n.state!=="AUTO"?0:$.teleopToSubtractFromAuto)-(n.state!=="AUTO"&&n.state!=="TELEOP"?0:$.teleopToSubtractFromInMatch):0;const O=(n==null?void 0:n.type)==="ELIMS",X=O&&((A==null?void 0:A.dq1)||0)>0&&(($==null?void 0:$.dq1)||0)>0;return O&&(q=((A==null?void 0:A.dq1)||0)>0?(A==null?void 0:A.adjust)??0:q,F=(($==null?void 0:$.dq1)||0)>0?($==null?void 0:$.adjust)??0:F),e.jsxs("div",{className:`scoreEditContent contrast-${r.controlContrast}`,children:[B,e.jsxs("div",{className:"scoreEditBody",children:[e.jsxs("div",{className:"matchOverview",children:[e.jsx("span",{className:"name",children:n?n.name:t`No Active Match`}),e.jsx("hr",{}),e.jsx("span",{className:"totalScore",children:r.flipControl?q:F}),e.jsx("span",{className:"totalScore",children:r.flipControl?F:q}),n!=null&&n.hrReview&&u?e.jsx("span",{className:"reviewBanner",children:t`Referee Review`}):null,e.jsx(Ue,{match:n,isElims:O,color:t`Red`,cardCarries:le,alliance:n==null?void 0:n.red,detailAlliance:A,right:!r.flipControl,updateScore:(k,M)=>b("red",k,M),readOnly:E}),e.jsx(Ue,{match:n,isElims:O,color:t`Blue`,cardCarries:xe,alliance:n==null?void 0:n.blue,detailAlliance:$,right:!!r.flipControl,updateScore:(k,M)=>b("blue",k,M),readOnly:E}),e.jsx(vt,{random:n==null?void 0:n.randomization}),e.jsx("fieldset",{className:`scoreBreakdown ${r.flipControl?"left":"right"}`,children:e.jsx(Ge,{score:A,other:$,breakdown:N,showAdjust:X,updateScore:(k,M)=>b("red",k,M),isPlayoff:O})}),e.jsx("fieldset",{className:`scoreBreakdown ${r.flipControl?"right":"left"}`,children:e.jsx(Ge,{score:$,other:A,breakdown:z,showAdjust:X,updateScore:(k,M)=>b("blue",k,M),isPlayoff:O})})]}),e.jsxs("div",{dir:r.flipControl?"ltr":"rtl",children:[e.jsx("div",{className:`scoreSection red ${r.flipControl?"left":"right"}`,children:e.jsx(Fe,{color:"Red",readOnly:E,random:n==null?void 0:n.randomization,details:A,otherDetails:$,teams:[1,2,3].map(k=>n==null?void 0:n.red[`team${k}`]),otherTeams:[1,2,3].map(k=>n==null?void 0:n.blue[`team${k}`]),updateScore:(k,M)=>b("red",k,M),updateBothScores:(k,M,H)=>b("both",k,M,H),isPlayoff:O})}),e.jsx("div",{className:`scoreSection blue ${r.flipControl?"right":"left"}`,children:e.jsx(Fe,{color:"Blue",readOnly:E,random:n==null?void 0:n.randomization,details:$,otherDetails:A,teams:[1,2,3].map(k=>n==null?void 0:n.blue[`team${k}`]),otherTeams:[1,2,3].map(k=>n==null?void 0:n.red[`team${k}`]),updateScore:(k,M)=>b("blue",k,M),updateBothScores:(k,M,H)=>b("both",k,M,H),isPlayoff:O})})]})]}),e.jsx(pt,{visible:D,close:()=>P(!1),match:n,eventCode:l,updateMatchDetails:k=>{c(k),T(!0)}})]})}const de={className:"btn-xs",variant:"light"};function Tt({matches:s,eventCode:i,selectionState:r,activeType:n,settings:l}){var D,P,b;const[d,x]=w.useState(null),m=n==Ss.ELIMS,u=!m&&r&&[...Array(r.alliances.length).keys()].map(a=>a*2).includes(r==null?void 0:r.nextSlot),S=(D=r==null?void 0:r.teams)==null?void 0:D.find(a=>!a.removed&&!a.captain&&!a.picked);let o=((P=r==null?void 0:r.teams)==null?void 0:P.map(a=>a.removed?t`Unavailable`:a.picked?t`Selected`:a.captain?t`Captain`:u&&a.number===(S==null?void 0:S.number)?t`Next Captain`:a.declined?t`Unavailable - declined`:!1))||[];r&&r.teams.length;async function g(){const a=s.filter(E=>E.state!=="COMMITTED").length;if(a>0&&!await re({label:t`Start Alliance Selection?`,text:t`WARNING: There are ${a} un-committed matches. Any Qualification matches committed after starting alliance selection will NOT be considered in the rankings used during Alliance Selection.`,buttonText:t`Start`}))return;const C=await Ie({label:"Playoff Match Start Time",text:"Enter the time the first playoff match is expected to start",customInputParams:{type:"datetime-local",step:300},defaultValue:Me.Now.plainDateTimeISO().add({minutes:30}).round({roundingIncrement:5,roundingMode:"ceil",smallestUnit:"minute"}).toString().slice(0,16),buttonText:"Submit"});if(!C)return;await As(i,C)||_({label:t`Failed to Start Selection`,text:t`Starting Selection Failed.`})}async function j(a,C){await Ms(i,a,C,ys.CONTROL)||_({label:t`Failed to Submit Selection`,text:t`Selection Submission Failed.`})}async function c(){await Ps(i)||_({label:t`Failed to Submit Selection`,text:t`Selection Undo Failed.`})}async function f(){let a=null;const C=r.teams.filter(E=>!E.declined&&!E.removed&&!E.captain&&!E.removed).length;if(r.alliances.some(E=>!E[1])?C>1&&(a=t`Alliances are not full (2 Teams each).`):r.teamsPerAlliance>2&&r.nextSlot<12&&(a=t`Alliances are not full (3 Teams each).`),a&&!await re({label:t`Finish Alliance Selection?`,text:t`WARNING: ${a} Are you sure you want to generate Elimination Matches with these alliances?`,buttonText:t`Generate`}))return;const I=await Ie({label:"Playoff Match Start Time",text:"Confirm the time the first playoff match is expected to start",customInputParams:{type:"datetime-local",step:300},defaultValue:r.playoffStartTime,buttonText:"Submit"});I&&(await $s(i,I)||_({label:t`Failed to Generate Elimination Matches`,text:t`Unable to complete alliance selection.`}))}async function T(a,C){await Ds(i,a,C)?x(null):_({label:t`Failed to Submit Backup`,text:t`Backup Selection Failed.`})}async function y(a){if(await re({label:t`Remove Backup Team`,text:t`Backup teams should only be removed if they were added in error and have not played in a match yet.`,buttonText:t`Remove`}))try{await Os(i,a)||_({label:t`Failed to Remove Backup`,text:t`Backup Removal Failed.`})}catch(C){_({label:t`Failed to Remove Backup`,text:C.message||t`Backup Removal Failed.`})}}const R=r?Me.PlainDateTime.from(r.playoffStartTime).toPlainTime().toLocaleString(void 0,{timeStyle:"short"}):null;let h="";if(l.allianceCountOverride&&(h+=l.allianceCountOverride+" alliances"),l.teamsPerAllianceOverride&&(l.allianceCountOverride?h+=" of "+l.teamsPerAllianceOverride+" teams":h=l.teamsPerAllianceOverride+"-team alliances",l.allowBackupsOverride&&(h+=" + backups")),l.playoffTypeOverride){const a=h.length?" in ":"";switch(l.playoffTypeOverride){case"DOUBLE_ELIMINATION_WITH_FINALS":h+=a+"double elimination with finals";break;case"SINGLE_ELIMINATION":h+=a+"single elimination";break}}return e.jsxs("div",{className:"container-fluid",children:[e.jsx(we,{children:e.jsx(he,{children:e.jsx("div",{className:"mx-auto",style:{width:"fit-content"},children:n==="ELIMS"?e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{children:t`Backup Team Selection`}),d?e.jsxs(e.Fragment,{children:[t`Adding a backup team to Alliance ${d}`," ",e.jsx(v,{variant:"primary",size:"sm",onClick:()=>x(null),children:t`Cancel`})]}):null]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"m-2",variant:r?"light":"success",disabled:!!r,onClick:g,children:t`Start Alliance Selection`}),e.jsx(v,{className:"m-2",variant:"success",onClick:()=>qe(i),children:t`Set Audience Display`})]})})})}),e.jsxs(we,{children:[e.jsxs(he,{sm:"4",children:[h?e.jsxs("div",{className:"alert alert-warning text-center",children:["Elimination Override: ",h]}):null,e.jsxs("table",{className:"alliancesTable mx-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:t`Alliance`}),e.jsx("th",{children:t`Captain`}),((r==null?void 0:r.teamsPerAlliance)||0)>2?e.jsxs(e.Fragment,{children:[e.jsx("th",{children:t`1st Pick`}),e.jsx("th",{children:t`2nd Pick`})]}):e.jsx("th",{children:t`Partner`})]})}),e.jsx("tbody",{children:r==null?void 0:r.alliances.map((a,C)=>e.jsxs("tr",{children:[e.jsx("th",{children:C+1}),a.map((I,E)=>{var B;return e.jsxs("td",{children:[(B=r.teams.find(A=>A.number==I))==null?void 0:B.displayNumber,m&&E==2?I?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx(v,{...de,variant:"danger",onClick:()=>y(C+1),children:"Remove"})]}):e.jsx(v,{...de,variant:"outline-warning",disabled:!!I,onClick:()=>x(C+1),children:"Add Backup"}):null]},E)})]},C))})]}),m?null:e.jsxs("div",{className:"mx-auto",style:{width:"fit-content"},children:[e.jsx(v,{className:"m-2",variant:r?"success":"light",disabled:!r,onClick:c,children:t`Undo`}),e.jsx(v,{className:"m-2",variant:r?"success":"light",disabled:!r,onClick:f,children:t`Generate Matches`})]}),e.jsx("div",{className:"mx-auto text-center",children:e.jsx("span",{children:R&&!m?t`Playoff matches begin at ${R}`:null})})]}),e.jsx(he,{sm:"8",children:e.jsxs("table",{className:"alliancesTable mx-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:t`Rank`}),e.jsx("th",{children:t`Number`}),e.jsx("th",{children:t`Name`}),e.jsx("th",{style:{width:"100px"},children:t`Select`}),m?null:e.jsxs(e.Fragment,{children:[e.jsx("th",{style:{width:"100px"},children:t`Decline`}),e.jsx("th",{style:{width:"100px"},children:t`Remove`})]})]})}),e.jsx("tbody",{children:(b=r==null?void 0:r.teams)==null?void 0:b.map((a,C)=>e.jsxs("tr",{children:[e.jsx("th",{children:a.rank}),e.jsx("td",{children:a.displayNumber}),e.jsx("td",{children:a.name}),o[C]||(m?!d:r.nextSlot>=r.alliances.length*r.teamsPerAlliance)?e.jsx("td",{colSpan:m?1:2,children:o[C]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx(v,{...de,onClick:async()=>{m&&d?await T(d,a.number):await j(a.number,ye.ACCEPT)},children:t`Accept`})}),m?null:e.jsx("td",{children:e.jsx(v,{...de,onClick:()=>j(a.number,ye.DECLINE),children:t`Decline`})})]}),a.removed||o[C]&&(!u||a.number!==(S==null?void 0:S.number))||m?null:e.jsx("td",{children:e.jsx(v,{...de,onClick:()=>j(a.number,ye.REMOVE),title:"Use if e.g. the team has left the venue",children:t`Remove`})})]},a.number))})]})})]})]})}function Nt(s){const{title:i,eventKey:r,disabled:n,tabClassName:l,id:d}=s.props;return i==null?null:e.jsx(Se.Item,{children:e.jsx(Se.Link,{as:"button",eventKey:r,disabled:n,id:d,className:l,children:i})})}function Ct({children:s,activeKey:i,onSelect:r,...n}){return e.jsxs(Fs,{activeKey:i,onSelect:r,children:[e.jsx(Se,{...n,variant:"tabs",role:"tablist",as:"nav",children:Pe(s,Nt)}),e.jsx(Us,{children:Pe(s,l=>{const d={...l.props};delete d.title,delete d.disabled,delete d.tabClassName;const x=d.children;return delete d.children,e.jsx(Gs,{...d,children:e.jsx(_e,{children:x})})})})]})}function wt({deauthEvents:s,showDeauthDetails:i}){const[r,n]=w.useState({});return e.jsx("div",{className:"deauth-alerts",children:Object.entries(s).sort(([l],[d])=>d.localeCompare(l)).map(([l,d])=>{if(r[l]==d.length)return null;const x=d.reduce(function(m,u){return m[u.team]?m[u.team]+=1:m[u.team]=1,m},{});return e.jsxs(Ce,{variant:"warning",dismissible:!0,onClose:()=>n(m=>Object.assign({},m,{[l]:d.length})),children:[e.jsxs(Ce.Heading,{children:["Deauth event detected in match ",l,"."]}),e.jsxs("p",{children:["Please inform FTA & HR before committing the match.",e.jsx("br",{}),"Affected teams: ",Object.entries(x).map(([m,u])=>`${m} [${u}]`).join(", ")]}),e.jsx(v,{onClick:()=>i(),variant:"outline-dark",children:"Details"})]},l)})})}function St({deauthEvents:s,hide:i}){return e.jsxs(V,{show:!0,onHide:i,className:"text-dark",children:[e.jsx(V.Header,{closeButton:!0,children:e.jsx(V.Title,{children:"Deauth Events"})}),e.jsx(V.Body,{children:Object.entries(s).sort(([r],[n])=>n.localeCompare(r)).map(([r,n])=>e.jsxs(e.Fragment,{children:[e.jsxs("b",{children:["Match ",r]}),n.map((l,d)=>e.jsx("pre",{children:JSON.stringify(l,void 0,2)},d))]}))})]})}async function kt(s){await re({label:t`Reset Alliance Selection?`,text:t`This will delete all generated elimination matches and undo all of alliance selections. This action cannot be undone.`,buttonText:t`Reset Alliances`})&&(await Bs(s)||_({label:t`Failed to Reset Alliances`,text:t`Unable to reset alliances`}))}function Et(s,i){switch(i.type){case Z.G301:return!1;case Z.RUNNING_MATCH:return!1;case Z.SCHEDULED_START:return i.match===(s==null?void 0:s.number);case Z.T206:return i.targetMatch===s.number;case Z.LAST_ON_FIELD:return i.field===s.field;case Z.ALLIANCE_LAST:return[s.red.seed,s.blue.seed].includes(i.alliance);case Z.T206_MATCH_DEPENDENCY:return!0}}const Ne=window.location.hash.replace("#","")||"schedule";function Rt({eventCode:s,isMeet:i,fieldCount:r,pinField:n,isDualDivisionParent:l,divisions:d,isDivision:x}){var me,je;const[m,u]=w.useState(!1),[S,o]=w.useState(Ne),[g,j]=w.useState(0),[c,f]=w.useState(Ne.startsWith("edit")?parseInt(Ne.split("-")[1]):-1),{nowCallback:T,isConnected:y,matchData:R,displayUpdates:h,deauthEvents:D,settings:P,qualsActive:b,practiceActive:a,selectionState:C,timeoutData:I,isArchived:E,syncStatus:B,displayData:A,loadedMatch:$,activeMatch:N,remaining:z,loadMatch:le,nextMatchNum:xe}=as(s,n,()=>{f(-1),q("schedule")});function q(p){window.location.hash=p,o(p)}const F=R.matches,O=R.activeType,X=F.filter(p=>p.state==="SUBMITTED"||p.state==="REVIEW"),ne=F.find(p=>p.number===c);async function ae(p){f(p),q(`edit-${p}`)}const ce={liveScoring:P.liveScoring,archived:E,loadMatch:le,eventCode:s,fieldCount:r,editMatch:ae,commitMatch:p=>ge(s,p,F),postMatch:async p=>{await He(s,p)||_({label:t`Failed to Post Match`,text:t`Match post failed.  Please refresh and try again.`})},replayMatch:async p=>{const ke=F.find(We=>We.number===p).name;await re({label:t`Replay ${ke}?`,text:t`This will overwrite any saved scores and data for ${ke}!`,buttonText:t`Replay Match`})&&await le(p)},qualsActive:b,practiceActive:a},Q=[...F].sort((p,Y)=>Y.start-p.start)[0],oe=(me=I.assumedNext)==null?void 0:me.filter(p=>!!p)[0],W=oe&&I.activeTimeouts?gs(oe,I.activeTimeouts,Et,T):(je=I.activeTimeouts)==null?void 0:je.find(Ye),k=Je({startAt:W==null?void 0:W.timeoutStart,duration:((W==null?void 0:W.timeoutDuration)??0)/1e3,nowCallback:T}),M=e.jsx("div",{className:"d-flex justify-content-center",children:e.jsxs("h1",{children:[t`Match Control`," ",e.jsx("span",{className:"badge badge-primary",children:n?t`Field ${n}`:""})," ",O==="TEST"?t`- TEST MODE`:""," ",O==="PRACTICE"?t`- Practice Matches`:""]})}),H=!!(N&&(N==null?void 0:N.state)!=="REVIEW"&&(N==null?void 0:N.state)!=="SUBMITTED");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`controlHeading ${O==="TEST"||O==="PRACTICE"?"test":""}`,children:[M,y?null:e.jsx("div",{className:"alert alert-warning text-center h6 fixed-top w-25 mx-auto",children:t`DISCONNECTED!!`}),e.jsx(cs,{loadedMatch:$,activeMatch:N,matchRemaining:z,timeoutTimer:k,timeout:W,settings:P}),P.hrControl?e.jsx("div",{className:"alert alert-danger text-center",style:{margin:"1ch"},children:"Match flow is being controlled from the HR Page!"}):null,e.jsx(os,{loadedMatch:$,activeMatch:N,editingMatch:ne,previewMatch:(p,Y)=>js(s,p,Y),randomizeMatch:(p,Y)=>ms(s,p,Y),showRandom:p=>xs(s,p),showMatch:p=>us(s,p),startMatch:p=>hs(s,p),abortMatch:p=>ds(s,p),commitAndPostMatch:p=>ge(s,p,F,!0),hasNextMatch:xe>0,loadNextMatch:()=>le(xe),displayUpdates:Object.values(h),showSeparatePreviews:F.length>0&&F[0].type==="ELIMS"&&A.some(p=>p.data.overlay),settings:P,isArchived:E,warnIfNotPost:!1})]}),e.jsxs(Ct,{activeKey:S,onSelect:q,className:"controlTabs",children:[e.jsx(K,{eventKey:"schedule",title:t`Schedule`,children:e.jsx(Oe,{matches:F,...ce,testMode:O==="TEST",activeMatchRunning:H})}),e.jsx(K,{eventKey:"incomplete",title:e.jsxs("span",{children:[t`Incomplete Matches`," ",X.length>0?e.jsx("span",{className:"tabBadge badge badge-danger",children:X.length}):null]}),children:e.jsx(Oe,{matches:X,...ce,activeMatchRunning:H})}),e.jsx(K,{eventKey:`edit-${c}`,title:t`Score Edit`,disabled:!ne,children:e.jsx(Ve,{settings:P,match:ne,eventCode:s,isArchived:E,showHelp:()=>q("help"),lockoutMatch:p=>fs(s,p),commitMatch:(p,Y)=>ge(s,p,F,!1,Y),activeMatchRunning:H})}),e.jsx(K,{eventKey:"active",title:t`Active Match`,disabled:!P.liveScoring,children:e.jsx(Ve,{active:!0,eventCode:s,settings:P,match:N,openMatchForEditing:ae})}),e.jsx(K,{eventKey:"settings",title:t`Settings`,disabled:n>0,children:e.jsx(ft,{eventCode:s,settings:P,selectionState:C,isMeet:i,activeMatch:N,activeType:O,timeoutData:I,resetElims:()=>kt(s),syncStatus:B,nowCallback:T,isArchived:E,showDeauthDetails:Object.keys(D).length>0?()=>u(!0):void 0,showHelp:()=>q("help"),isDualDivisionParent:l,matches:F,unsavedMatchCount:X.length})}),e.jsx(K,{eventKey:"alliance",title:t`Alliance Selection`,disabled:O==="TEST"||O=="PRACTICE"||O=="ELIMS"&&!P.allowBackupsOverride||E||n>0||l,children:e.jsx(Tt,{eventCode:s,matches:F,selectionState:C,activeType:O,settings:P})}),e.jsx(K,{eventKey:"video",title:t`Video Switch`,children:e.jsx(jt,{eventCode:s,displayData:A,fieldCount:r,pinField:n,showMeetRankings:!!P.showMeetRankings,isDualDivisionParent:l,isDivision:x,divisions:d})}),e.jsx(K,{eventKey:"awards",title:t`Present Awards`,children:e.jsx("div",{className:"p-3",children:e.jsx(Vs,{})})}),e.jsxs(K,{eventKey:"help",title:e.jsxs("span",{children:[t`Help`," ",g>0?e.jsx("span",{className:"tabBadge badge badge-warning",children:g}):null]}),children:[e.jsx("div",{ref:p=>p&&p.appendChild(document.getElementById("feedbackContent"))}),e.jsx(Ls,{setUnreadMessages:j})]})]}),e.jsxs("div",{className:"footer",children:[e.jsx("div",{className:`syncStatusLight ${B.status}`,title:B.description+(B.lastSyncTime>0?`\r
Last Success: `+new Date(B.lastSyncTime).toLocaleTimeString():"")}),e.jsx("span",{children:ws(Q==null?void 0:Q.scheduledStart,Q==null?void 0:Q.start)})]}),e.jsx(wt,{deauthEvents:D,showDeauthDetails:()=>u(!0)}),m?e.jsx(St,{deauthEvents:D,hide:()=>u(!1)}):null]})}const It=Qe.createRoot(document.getElementById("matchControl"));It.render(e.jsx(_e,{children:e.jsx(Ns,{client:ps,children:e.jsx(Rt,{eventCode:window.eventCode,isMeet:window.isMeet,fieldCount:window.fieldCount,pinField:window.pinField,isDualDivisionParent:window.isDualDivisionParent,isDivision:window.isDivision,divisions:window.divisions})})}));
//# sourceMappingURL=matchControl-DUDkjhYP.js.map
