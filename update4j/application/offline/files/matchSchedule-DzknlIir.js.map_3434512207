{"version":3,"file":"matchSchedule-DzknlIir.js","sources":["../../../../../../../.yarn/__virtual__/first-common-virtual-b44088cd3d/1/FIRSTCommon/src/main/javascript/FriendlyNumberInput.tsx","../../../../../../src/main/javascript/manage/matchSchedule/MatchSchedule.tsx","../../../../../../src/main/javascript/manage/matchSchedule/index.tsx"],"sourcesContent":["import {InputHTMLAttributes, useEffect, useState} from \"react\";\nimport {isNumber} from \"lodash\";\n\nexport default function FriendlyNumberInput({value: val, onChange, min: minVal, max: maxVal, step, ...rest}: {\n    value: number, onChange: (newVal: number) => void\n}  & Omit<InputHTMLAttributes<HTMLInputElement>, 'value' | 'onChange' | 'onBlur' | 'type'>) {\n    const [liveState, setLiveState] = useState(val.toString())\n    useEffect(() => {\n        setLiveState(val.toString())\n    }, [val]);\n    const realStep = (!step ? 1 : (isNumber(step) ? step : parseFloat(step) || 1))\n    const parseFunc =  realStep < 1 ? parseFloat : parseInt\n\n    return <input type=\"number\" value={liveState} min={minVal} max={maxVal}\n                  step={step} {...rest}\n                  onChange={(e) => {\n                      setLiveState(e.currentTarget.value)\n                      // If arrows used, update immediately since a blur won't happen\n                      if(e.currentTarget != document.activeElement) {\n                          onChange(parseFunc(e.currentTarget.value))\n                      }\n                  }}\n                  onBlur={(e) => {\n                      let newValue = parseFunc(e.currentTarget.value)\n                      if(minVal != undefined && newValue < (isNumber(minVal) ? minVal : parseFloat(minVal))) {\n                          newValue = isNumber(minVal) ? minVal : parseFloat(minVal)\n                      }\n                      if(maxVal != undefined && newValue > (isNumber(maxVal) ? maxVal : parseFloat(maxVal))) {\n                          newValue = isNumber(maxVal) ? maxVal : parseFloat(maxVal)\n                      }\n                      if(isNaN(newValue)) {\n                          // if invalid on blur restore to previous value\n                          setLiveState(val.toString())\n                      } else {\n                          setLiveState(newValue.toString())\n                          onChange(newValue)\n                      }\n                  }} style={{width: \"5em\"}} />\n}","import {FocusEvent, InputHTMLAttributes, useEffect, useId, useReducer, useRef, useState} from \"react\";\nimport {msgid, ngettext, t} from \"ftc-common/i18n\";\nimport {Alert, Button, Form, OverlayTrigger, ProgressBar, Tooltip} from \"react-bootstrap\";\nimport {PermissiveURLSearchParams, usePersistentWebsocket} from \"ftc-common/utils\";\nimport {Temporal} from 'temporal-polyfill'\nimport {MatchMakerStatus, MatchMakerUpdate, ScheduleData} from \"../../javaTypes\";\nimport { confirmDialog, messageDialog } from \"first-common/dialogs\";\nimport {ChangeEvent, useCallback} from \"react\";\nimport FriendlyNumberInput from \"first-common/FriendlyNumberInput\";\n\nexport interface MatchCountData {\n    teamCount: number\n    perTeam: number\n    minPerTeam: number\n    maxPerTeam: number\n}\n\nexport type ScheduleBlock = MatchBlock | BreakBlock\ninterface MatchBlock {\n    roundInfo?: string\n    readOnly?: boolean\n    type: \"MATCH\"\n    cycleTime: Temporal.Duration\n    start: Temporal.PlainDateTime\n    end: Temporal.PlainDateTime\n}\n\ninterface BreakBlock {\n    type: \"BREAK\"\n    label: string\n    start: Temporal.PlainDateTime\n    end: Temporal.PlainDateTime,\n    visible: boolean\n}\n\nconst timeFormatOpts = [document.documentElement.lang, { hour: \"numeric\", minute: \"numeric\" }] as const;\nfunction matchesPerBlock(block: MatchBlock) {\n    return Math.max(0, Math.floor(block.start.until(block.end).total({ unit: 'second' }) / block.cycleTime.total({ unit: 'second' })));\n}\n\nfunction EditMatchBlock({date, block, updateBlock, overlaps, minCycle}: {date: Temporal.PlainDate, block: MatchBlock, updateBlock: (block?: MatchBlock) => void, overlaps: boolean, minCycle: number}) {\n    const matchCount = matchesPerBlock(block);\n    const extraTime = block.start.until(block.end).subtract({ seconds: block.cycleTime.total({ unit: 'second' }) * matchCount }).total({ unit: 'minute' });\n    const id = useId();\n    const cycleTime = block.cycleTime.total({ unit: 'minute' })\n\n    return <div className={\"border border-dark m-2 p-2\"}>\n        <h4 className={\"form-inline\"}>{block.start.toLocaleString(...timeFormatOpts)} - {block.end.toLocaleString(...timeFormatOpts)}: {block.readOnly ? matchCount :\n            <FriendlyNumberInput\n            className=\"ml-2 mr-2\"\n            value={matchCount}\n            min={0}\n            style={{width: \"5em\"}}\n            onChange={(val) => {\n                let newEnd = block.start.add(Temporal.Duration.from({seconds: val * block.cycleTime.total({ unit: 'second' })}));\n                if(block.cycleTime.total({ unit: 'minute' }) >= 5) {\n                    newEnd = newEnd.round({smallestUnit: \"minutes\", roundingMode: \"expand\", roundingIncrement: 5});\n                }\n                updateBlock({...block,\n                    end: newEnd\n                })\n            }}\n        />}{' '}{ngettext(msgid`Match`, msgid`Matches`, matchCount)} {block.readOnly ? t` already played` : null}\n            {overlaps ? <OverlayTrigger overlay={<Tooltip id={`${id}-overlap`}>\n            {t`This block overlaps with another block.`}\n        </Tooltip>}>\n            <i className=\"fas fa-exclamation-triangle\"></i>\n        </OverlayTrigger> : null}</h4>\n        <h5>{block.start.until(block.end).total({ unit: \"minutes\"})} minutes {extraTime > 0 ? ngettext(msgid`(Last match ends ${extraTime} minute before end of block)`, `(Last match ends ${extraTime} minutes before end of block)`, extraTime) : null}</h5>\n        {block.readOnly ? <div>{t`Cycle Time: ${cycleTime}`}</div> : <Form inline>\n            <Form.Label htmlFor={`${id}-start`} className=\"mr-2\">\n                {t`Start`}\n            </Form.Label>\n            <Form.Control\n                className=\"mr-2\"\n                id={`${id}-start`}\n                type=\"time\"\n                value={block.start.toPlainTime().toString({ smallestUnit: 'minute' })}\n                onChange={(e) => {\n                    const newStart = date.toPlainDateTime(Temporal.PlainTime.from(e.currentTarget.value));\n                    updateBlock({...block,\n                        start: newStart,\n                        end: newStart.add(block.start.until(block.end))\n                    })\n                }}\n            />\n            <Form.Label htmlFor={`${id}-end`} className=\"mr-2\">\n                {t`End`}\n            </Form.Label>\n            <Form.Control\n                className=\"mr-2\"\n                id={`${id}-end`}\n                type=\"time\"\n                value={block.end.toPlainTime().toString({ smallestUnit: 'minute' })}\n                onChange={(e: FocusEvent<HTMLInputElement>) => updateBlock({...block, end: date.toPlainDateTime(Temporal.PlainTime.from(e.currentTarget.value))})}\n            />\n            <Form.Label htmlFor={`${id}-cycle`} className=\"mr-2\">\n                {t`Cycle Time`}\n            </Form.Label>\n            <FriendlyNumberInput\n                className=\"mr-2\"\n                id={`${id}-cycle`}\n                min={minCycle}\n                step={0.5}\n                value={cycleTime}\n                onChange={(val) => updateBlock({...block, cycleTime: Temporal.Duration.from({ seconds: val * 60 })})}\n            />\n            <div className={\"flex-grow-1\"} />\n            <Button variant={\"secondary\"} size={\"sm\"} onClick={() => updateBlock(undefined)}>{t`Remove`}</Button>\n        </Form>}\n        <small>{block.roundInfo}</small>\n    </div>\n}\n\nfunction EditBreakBlock({block, updateBlock}: { updateBlock: (block?: BreakBlock) => void, block: BreakBlock }) {\n    const id = useId();\n\n    return <div className={\"border border-dark m-2 p-2\"}>\n        <h4>{block.start.toLocaleString(...timeFormatOpts)} - {block.end.toLocaleString(...timeFormatOpts)}: Break</h4>\n        <h5>{block.start.until(block.end).total({unit: \"minutes\"})} minutes</h5>\n        <Form inline>\n            <Form.Label htmlFor={`${id}-label`} className=\"mr-2\">\n                {t`Label`}\n            </Form.Label>\n            <Form.Control\n                className=\"mr-2\"\n                id={`${id}-label`}\n                value={block.label}\n                style={{width: \"15em\"}}\n                onChange={(e) => updateBlock({...block, label: e.currentTarget.value, visible: block.label.length == 0 ? true : (e.currentTarget.value.length == 0 ? false : block.visible)})}\n            />\n            <Form.Label htmlFor={`${id}-visible`} className=\"mr-2\">\n                {t`Show on Printable Schedule`}\n            </Form.Label>\n            <Form.Check custom\n                className=\"mr-2\"\n                id={`${id}-visible`}\n                checked={block.visible}\n                onChange={(e: ChangeEvent) => updateBlock({...block, visible: (e.currentTarget as HTMLInputElement).checked})}\n            />\n        </Form>\n    </div>\n}\n\nfunction blocksReducer(teamCount: number, perTeam: number) {\n    return function (blocks: ScheduleBlock[], action: {\n            replace?: ScheduleBlock,\n            insert?: ScheduleBlock,\n            lastPlayed?: number\n        }): ScheduleBlock[] {\n        const ret = blocks.map(b => {\n            return action.replace == b ? action.insert : b\n        }).filter((b): b is ScheduleBlock => !!b)\n        if (!action.replace && action.insert) {\n            ret.push(action.insert)\n        }\n        ret.sort((a, b) => {\n            let diff = Temporal.PlainDateTime.compare(a.start, b.start)\n            if(diff != 0) return diff;\n            if(a.type == \"BREAK\" && b.type == \"MATCH\")\n            {\n                return -1;\n            }\n            if(a.type == \"MATCH\" && b.type == \"BREAK\")\n            {\n                return 1;\n            }\n            return 0;\n        })\n        while (ret.length > 0 && ret[0].type == \"BREAK\") {\n            ret.shift();\n        }\n        while (ret.length > 0 && ret[ret.length - 1].type == \"BREAK\") {\n            ret.pop();\n        }\n        // Ensure we can't have blocks that span multiple days\n        for (let i = 0; i < ret.length; i++) {\n            if(ret[i].start.toPlainDate().toString() != ret[i].end.toPlainDate().toString()) {\n                if(ret[i].type == \"MATCH\") {\n                    const oldEnd = ret[i].end;\n                    const newEnd = ret[i].start.withPlainTime({ hour: 23, minute: 59 });\n                    ret[i].end = newEnd;\n                    const newBlock = {\n                        type: \"MATCH\",\n                        start: newEnd.add({minutes: 1}),\n                        end: oldEnd,\n                        cycleTime: (ret[i] as MatchBlock).cycleTime\n                    }\n                    if(Temporal.Duration.compare(newBlock.start.until(newBlock.end), newBlock.cycleTime) >= 0) {\n                        ret.splice(i + 1, 0,)\n                    }\n                } else {\n                    ret.splice(i, 1);\n                }\n            }\n        }\n        for (let i = 1; i < ret.length - 1; i++) {\n            if (ret[i].type == \"BREAK\") {\n                const prev = ret[i - 1];\n                const next = ret[i + 1];\n                ret[i].start = prev.end;\n                ret[i].end = next.start;\n            }\n        }\n        if (action.lastPlayed && action.lastPlayed > 0) {\n            let count = 0;\n            for (let i = 0; i < ret.length; i++) {\n                const block = ret[i]\n                if (block.type == \"MATCH\") {\n                    if (count < action.lastPlayed) {\n                        block.readOnly = true\n                    }\n                    if (count < action.lastPlayed && action.lastPlayed < count + matchesPerBlock(block)) {\n                        const newEnd = block.start.add({seconds: (action.lastPlayed - count) * block.cycleTime.total({unit: 'second'})})\n                        ret.splice(i + 1, 0, {\n                            type: \"MATCH\",\n                            start: newEnd,\n                            end: block.end,\n                            cycleTime: block.cycleTime\n                        })\n                        block.end = newEnd\n                        i++;\n                    }\n                    count += matchesPerBlock(block)\n                }\n            }\n        }\n        let count = 0;\n        for (let i = 0; i < ret.length; i++) {\n            const block = ret[i]\n            if (block.type == \"MATCH\") {\n                count += matchesPerBlock(block)\n                let surrogates = 0;\n                // This assumes surrogates happen in the first \"full\" match of the round, which empirically\n                // appears to be the matchmaker behavior but does not appear documented anywhere\n                if(count > Math.ceil(teamCount * 2 / 4)) {\n                    surrogates = (4 - (perTeam * teamCount) % 4) % 4\n                }\n                const teamPlayed = count * 4 - surrogates\n                const completeRounds = Math.floor(teamPlayed / teamCount)\n                const teamsInNextRound = teamPlayed - teamCount * completeRounds\n                const teamsInThisRound = teamCount - teamsInNextRound\n                let message;\n                if(teamsInNextRound > 0) {\n                    message = ngettext(msgid`After this block, ${teamsInNextRound} team will have played ${completeRounds + 1} matches.`, msgid`After this block, ${teamsInNextRound} teams will have played ${completeRounds + 1} matches.`, teamsInNextRound)\n\n                    if(completeRounds != 1) {\n                        message += \" \" + ngettext(msgid`${teamsInThisRound} team will have played ${completeRounds} matches.`, msgid`${teamsInThisRound} teams will have played ${completeRounds} matches.`, teamsInThisRound)\n                    } else {\n                        message += \" \" + ngettext(msgid`${teamsInThisRound} team will have played ${completeRounds} match.`, msgid`${teamsInThisRound} teams will have played ${completeRounds} match.`, teamsInThisRound)\n                    }\n                } else {\n                    message = ngettext(msgid`After this block, all teams will have played ${completeRounds} match.`, msgid`After this block, all teams will have played ${completeRounds} matches.`, completeRounds)\n                }\n                if(surrogates > 0) {\n                    message += \" \" + ngettext(msgid`(And ${surrogates} team will have played as a surrogate.)`, msgid`(And ${surrogates} teams will have played as a surrogate.)`, surrogates)\n                }\n                block.roundInfo = message\n            }\n\n            if(isMatchBlock(block) && i < ret.length - 1 && isMatchBlock(ret[i + 1]) && block.start.toPlainDate().toString() == ret[i + 1].start.toPlainDate().toString()) {\n                ret.splice(i + 1, 0, {\n                    type: \"BREAK\",\n                    label: \"\",\n                    start: block.end,\n                    end: ret[i + 1].start,\n                    visible: false\n                })\n            }\n        }\n        return ret;\n    }\n}\n\nfunction isMatchBlock(b: ScheduleBlock): b is MatchBlock {\n    return b.type == \"MATCH\"\n}\n\nexport default function MatchSchedule({eventCode, matchCountData, initialSchedule, allowCustomSchedules, startDate, endDate, phase}:\n    {eventCode: string, matchCountData: MatchCountData, initialSchedule: ScheduleBlock[], allowCustomSchedules: boolean, startDate: Temporal.PlainDate, endDate: Temporal.PlainDate, phase: 'PRACTICE' | 'QUALS'}) {\n    const [perTeam, setPerTeam] = useState(matchCountData.perTeam);\n    const matchCount = Math.ceil(matchCountData.teamCount * perTeam / 4);\n    const blocksReducerFunc = useCallback(blocksReducer(matchCountData.teamCount, perTeam), [matchCountData.teamCount, perTeam]);\n    const [blocks, updateBlocks] = useReducer(blocksReducerFunc, initialSchedule)\n    const dateSet = new Set([startDate.toString()])\n    for(let d= startDate; d.until(endDate).total({ unit: 'day' }) >= 0; d = d.add({days: 1})) {\n        dateSet.add(d.toString())\n    }\n    // In case the event dates are changed ensure existing blocks render\n    blocks.forEach(b => {\n        dateSet.add(b.start.toPlainDate().toString());\n    })\n    const dates = [...dateSet].map(d => Temporal.PlainDate.from(d));\n    dates.sort(Temporal.PlainDate.compare);\n    const [scheduleHtml, setScheduleHtml] = useState<string | undefined>(undefined);\n    const [active, setActive] = useState(false);\n    const [lastPlayed, setLastPlayed] = useState(-1);\n    const [hasSchedule, setHasSchedule] = useState(false);\n    const [scheduleHeight, setScheduleHeight] = useState(\"0\");\n    const scheduleRef = useRef<HTMLIFrameElement>(null);\n    const [lastMMUpdates, setLastMMUpdates] = useState<Record<string, MatchMakerUpdate>>({});\n    const [currentFile, setCurrentFile] = useState<File | null>(null);\n    usePersistentWebsocket((window.location.protocol.indexOf('s') > 0 ? \"wss://\" : \"ws://\") + window.location.host + `/stream/matchmaker/?code=${eventCode}`, async (evt: Record<string, MatchMakerUpdate>) => {\n        setLastMMUpdates(evt);\n        if(evt[phase]?.status === 'SUCCESS') {\n            loadData()\n        }\n    })\n    const lastMMUpdate = lastMMUpdates[phase]?.status === 'SUCCESS' ? undefined : lastMMUpdates[phase];\n\n    const minCycle = matchCountData.teamCount > 11 ? 4 : (matchCountData.teamCount > 7 ? 8 : 9);\n\n    useEffect(() => {\n        if(blocks.length == 0 && dates.length >= 1) {\n            const cycleTime = Math.max(7, minCycle);\n            // prefer a weekend for quals\n            const preferredDate = dates.filter(d => phase == 'QUALS' ? d.dayOfWeek >= 6 : true)[0] || dates[0]\n            const start = preferredDate.toPlainDateTime(new Temporal.PlainTime(8, 0))\n            const end = start.add(Temporal.Duration.from({ minutes: matchCount * cycleTime })).round({smallestUnit: \"minutes\", roundingMode: \"expand\", roundingIncrement: 5});\n            updateBlocks({ insert: { type: \"MATCH\", cycleTime: Temporal.Duration.from({ minutes: cycleTime }), start, end } })\n        }\n    }, [matchCountData])\n\n    async function loadData() {\n        const res = await fetch(`/event/${eventCode}/dashboard/schedule/${phase}/data/`)\n        if(res.ok) {\n            const data: ScheduleData = await res.json();\n            setScheduleHtml(data.schedule)\n            setHasSchedule(true)\n            setActive(data.scheduleActive)\n            setLastPlayed(data.lastPlayed)\n        }\n    }\n\n\n    useEffect(() => {\n        updateBlocks({ lastPlayed: lastPlayed })\n    }, [lastPlayed]);\n\n    useEffect(() => {\n        loadData()\n    }, []);\n\n    const blocksByDate = blocks.reduce<Record<string, ScheduleBlock[]>>((acc, b: ScheduleBlock) => {\n        const date = b.start.toPlainDate().toString()\n        acc[date] = acc[date] || []\n        acc[date].push(b)\n        return acc\n    }, {})\n\n    const totalMatchesScheduled = blocks.filter(isMatchBlock).reduce((acc, b) => {\n        return acc + matchesPerBlock(b)\n    }, 0)\n\n    async function previewSchedule() {\n        const res = await fetch(`./preview/`, {\n          method: \"POST\",\n          body: PermissiveURLSearchParams({\n              mpt: perTeam,\n              schedule: JSON.stringify(blocks.map(b => {\n                  return {...b, start: b.start.toString(), end: b.end.toString()}\n              }))\n          })\n        })\n        if(res.ok) {\n            setScheduleHtml(await res.text())\n        }\n    }\n\n    async function saveSchedule() {\n        const res = await fetch(`.`, {\n            method: \"POST\",\n            body: PermissiveURLSearchParams({\n                mpt: perTeam,\n                schedule: JSON.stringify(blocks.map(b => {\n                    return {...b, start: b.start.toString(), end: b.end.toString()}\n                }))\n            })\n        })\n        if(res.ok) {\n            loadData()\n        } else if(res.status == 409 || res.status == 400) {\n            messageDialog({label: \"Failed to save schedule\", text: await res.text()})\n        } else {\n            messageDialog({label: \"Failed to save schedule\", text: \"An unknown error occurred\"})\n        }\n    }\n\n    async function runMatchMaker() {\n        const res = await fetch(`./runmatchmaker/`, {\n            method: \"POST\",\n            body: PermissiveURLSearchParams({\n                mpt: perTeam,\n                schedule: JSON.stringify(blocks.map(b => {\n                    return {...b, start: b.start.toString(), end: b.end.toString()}\n                })),\n                rerun: true\n            })\n        })\n        if(!res.ok) {\n            if(res.status == 400) {\n                messageDialog({label: \"Failed to run matchmaker\", text: await res.text()})\n            } else {\n                messageDialog({ label: \"Failed to run matchmaker\", text: \"An unknown error occurred\" })\n            }\n        }\n    }\n\n    function clearMatches() {\n        confirmDialog({\n            label: t`Clear Matches`,\n            text: t`Are you sure you want to clear all matches? This action cannot be undone.`,\n            buttonText: t`Clear Matches`,\n            onConfirm: async () => {\n                const res = await fetch(`./clearmatches/`, {\n                    method: \"POST\"\n                })\n                if(res.ok) {\n                    setScheduleHtml(undefined)\n                    setHasSchedule(false)\n                    setActive(false)\n                    setLastPlayed(-1)\n                }\n            }\n        })\n    }\n\n    async function toggleActive() {\n        if (active) {\n            if (!await confirmDialog({\n                label: t`Deactivate Schedule`,\n                buttonText: t`Deactivate`,\n                text: '<div className=\"alert alert-danger\" role=\"alert\">' +\n                    '<i className=\"fa fa-exclamation-triangle\"></i>' +\n                    t`DO NOT deactivate the schedule unless it was activated in error.  The match schedule has already been activated and is public, and you will not be able to play matches with a deactivated schedule.` +\n                    '<i className=\"fa fa-exclamation-triangle\"></i></div>'\n            })) {\n                return;\n            }\n        }\n        const res = await fetch('./active/', {\n            method: 'POST',\n            body: active ? 'false' : 'true',\n            credentials: 'same-origin'\n        })\n        if(res.ok) {\n            setActive(!active)\n        }\n    }\n\n    async function uploadSchedule() {\n        if(!currentFile) {\n            return;\n        }\n\n        if (hasSchedule) {\n            if(!await confirmDialog({\n                label: t`Overwrite Schedule`,\n                text: t`A match schedule already exists for this event. Are you sure you want to import? This will overwrite the current schedule.`\n            })) {\n                return;\n            }\n            await fetch(`./clearmatches/`, {\n                method: \"POST\"\n            })\n            setScheduleHtml(undefined)\n            setHasSchedule(false)\n            setActive(false)\n            setLastPlayed(-1)\n        }\n\n\n        const formData = new FormData();\n        formData.append(\"file\", currentFile, currentFile.name);\n        const res = await fetch(`./import/`, {\n            method: \"POST\",\n            body: formData\n        })\n\n        if(res.ok) {\n            // Since the import may have changed the blocks and not just the schedule itself, just reload to make sure\n            // the state is correct\n            window.location.reload()\n        } else {\n            const text = await res.text();\n            messageDialog({label: \"Failed to import schedule\", text, dangerous: true})\n        }\n    }\n\n    const wrongMatchCount = totalMatchesScheduled != matchCount;\n    const anyOverlaps = Object.values(blocksByDate).some((blocks) => {\n        const matchBlocks = blocks.filter(isMatchBlock)\n        for(let i = 1; i < matchBlocks.length; i++) {\n            if(Temporal.PlainDateTime.compare(matchBlocks[i].start, matchBlocks[i-1].end) < 0) {\n                return true;\n            }\n        }\n        return false;\n    })\n    const conflict = wrongMatchCount || anyOverlaps;\n\n    return <>\n        <h1 className={\"text-center\"}>{phase == 'PRACTICE' ? t`Practice Match Schedule` : t`Qualfication Match Schedule`}</h1>\n        {phase == 'PRACTICE' ? <Alert variant={\"warning\"} className={\"text-center\"}>\n            <i className=\"fa fa-exclamation-triangle text-center\"></i>&nbsp;\n            {t`WARNING: This is the practice match schedule, not the qualification match schedule!`}&nbsp;\n            <i className=\"fa fa-exclamation-triangle text-center\"></i>\n        </Alert> : null}\n        <div className={\"row\"}>\n            <div className={\"col-4\"}>\n                <label>{t`Matches per Team:`}&nbsp;</label>\n                <FriendlyNumberInput value={perTeam} onChange={(val) => setPerTeam(val)}\n                                     min={matchCountData.minPerTeam} max={matchCountData.maxPerTeam}  />\n            </div>\n            <span className={\"col-4\"}>{t`Teams:`} {matchCountData.teamCount}</span>\n            <span className={\"col-4\"}>{t`Total Matches Required:`} {matchCount}</span>\n            {lastPlayed > 0 ? <span className={\"col-4\"}>{t`Last Match Started:`} {lastPlayed}</span> : null}\n        </div>\n        {matchCountData.teamCount <= 7 ? <Alert\n            variant={\"info\"}>{t`With ${matchCountData.teamCount} teams, there must be a break under T206 between every match. Therefore, the minimum match cycle time is 9 minutes.`}</Alert> : null}\n        {matchCountData.teamCount > 7 && matchCountData.teamCount <= 11 ? <Alert\n            variant={\"info\"}>{t`With ${matchCountData.teamCount} teams, there must be a break under T206 approximately every other match. Therefore, the average minimum match cycle time is 8 minutes.`}</Alert> : null}\n        {dates.map(d => {\n            const dayBlocks = blocksByDate[d.toString()] || [];\n            const newBlockStartTime = dayBlocks.slice(-1)[0]?.end || d.toPlainDateTime(new Temporal.PlainTime(8, 0))\n            const newBlockCycles = dayBlocks.filter(isMatchBlock).slice(-1)[0]?.cycleTime || Temporal.Duration.from({minutes: Math.max(minCycle, 7)})\n            const newBlockEndTime = newBlockStartTime.add({seconds: Math.max(0, matchCount - totalMatchesScheduled) * newBlockCycles.total({unit: 'second'})});\n            return <div key={d.toString()}>\n                <h3>{d.toLocaleString(document.documentElement.lang, {\n                    weekday: 'long',\n                    month: 'long',\n                    day: 'numeric',\n                    year: 'numeric'\n                })}</h3>\n                {dayBlocks.map((b, idx) => {\n                    const previousBlock: MatchBlock | undefined = blocksByDate[d.toString()].slice(0, idx).filter(isMatchBlock).slice(-1)[0];\n                    const nextBlock: MatchBlock | undefined = blocksByDate[d.toString()].slice(idx + 1).filter(isMatchBlock)[0];\n                    return <>\n                        {isMatchBlock(b) ?\n                            <EditMatchBlock date={d} block={b} updateBlock={(newBlock) => updateBlocks({ replace: b, insert: newBlock })}\n                                        minCycle={minCycle}\n                                        overlaps={(previousBlock && Temporal.PlainDateTime.compare(previousBlock.end, b.start) > 0) || nextBlock && Temporal.PlainDateTime.compare(b.end, nextBlock.start) > 0}/> :\n                            <EditBreakBlock block={b} updateBlock={(newBlock) => updateBlocks({ replace: b, insert: newBlock })}/>}\n                    </>\n                })}\n                <Button variant={\"secondary\"} size={\"sm\"} className={\"mb-2\"} onClick={() => updateBlocks({ insert: {\n                    type: \"MATCH\",\n                    cycleTime: newBlockCycles,\n                    start: newBlockStartTime,\n                    end: newBlockEndTime\n                }})}>{t`Add Match Block`}</Button>\n            </div>\n        })}\n        {totalMatchesScheduled != matchCount ? <Alert\n            variant={\"danger\"}>{t`${totalMatchesScheduled} matches scheduled, but ${matchCount} matches required`}</Alert> : null}\n        {anyOverlaps ? <Alert\n            variant={\"danger\"}>{t`Overlapping matches scheduled`}</Alert> : null}\n\n        <div>\n            <Button variant={\"secondary\"} onClick={previewSchedule} disabled={conflict}>{t`Preview`}</Button>\n            <Button variant={\"secondary\"} onClick={saveSchedule} className={\"ml-2\"}\n                    disabled={conflict}>{t`Save`}</Button>\n            {hasSchedule ?\n                <Button variant={\"warning\"} disabled={lastPlayed > 0} title={lastPlayed > 0 ? t`Cannot clear schedule once matches have been played` : ''} className={\"ml-2\"} onClick={clearMatches}>{t`Clear Matches`}</Button>\n                : <Button variant={\"secondary\"} id=\"runMatchmaker\" onClick={runMatchMaker} className={\"ml-2\"} disabled={conflict || (lastMMUpdate && lastMMUpdate.status == MatchMakerStatus.RUNNING)}>{t`Run Matchmaker`}</Button>}\n            {hasSchedule ?\n                <Button id=\"activateQualificationSchedule\" variant={active ? \"warning\" : \"primary\"} className={\"ml-2\"} onClick={toggleActive} disabled={lastPlayed > 0} title={lastPlayed > 0 ? t`Cannot deactivate schedule once matches have been played` : ''}>\n                    {phase == 'QUALS' ? (active ? t`Deactivate Qualification Schedule` : t`Activate Qualification Schedule`) : (active ? t`Deactivate Practice Schedule` : t`Activate Practice Schedule`)}\n                </Button>\n                : null}\n        </div>\n        {allowCustomSchedules ? <>\n            <div className=\"row justify-content-center mt-2\">\n                <div className={\"col-12\"}>\n                    {t`Custom Scheduling:`}\n                </div>\n                <div className=\"col-2\">\n                    <button onClick={() => window.open(\"export/\")} className=\"btn btn-secondary\">\n                        Export Schedule\n                    </button>\n                </div>\n                <div className=\"col-4\">\n                    <input type=\"file\" accept=\".csv\" onChange={(e) => setCurrentFile((e.target as HTMLInputElement).files?.[0] || null)}\n                  /*onChange=\"document.getElementById('importScheduleButton').disabled = (this.value.length == 0);$('#filePathDisplay').text(document.getElementById('scheduleFile').files[0].name);\"*/></input>\n                </div>\n                <div className=\"col-2\">\n                    <button id=\"importScheduleButton\" onClick={() => uploadSchedule()} className=\"btn btn-secondary\"\n                            disabled={!currentFile || lastPlayed > 0} title={lastPlayed > 0 ? t`Cannot import new schedule once matches have been played` : ''}>Import Schedule\n                    </button>\n                </div>\n                <div className=\"col-4\">\n                    <div id=\"importStatus\" style={{color: \"red\"}}></div>\n                </div>\n            </div>\n        </> : null}\n\n        {lastMMUpdate ? <div className={\"text-center\"}>{lastMMUpdate.status == MatchMakerStatus.FAILED ? lastMMUpdate.data.error : t`MatchMaker running...`}</div> : (hasSchedule ? t`Schedule has been generated, see below.` : null)}\n        {lastMMUpdate && lastMMUpdate.status == MatchMakerStatus.RUNNING ? <ProgressBar now={lastMMUpdate.data.progress} label={`${lastMMUpdate.data.progress}%`} /> : null}\n\n        {scheduleHtml ? <div className=\"col-12\">\n            <iframe srcDoc={scheduleHtml} width=\"100%\" height={scheduleHeight} ref={scheduleRef} style={{border: \"none\"}}\n                    onLoad={() => setScheduleHeight(scheduleRef.current!.contentWindow!.document.body.scrollHeight + \"px\")} />\n        </div> : null}\n    </>\n}","import LocalErrorBoundary from \"../../LocalErrorBoundary\";\nimport MatchSchedule, {MatchCountData, ScheduleBlock} from \"./MatchSchedule\";\nimport { Temporal } from 'temporal-polyfill';\nimport { createRoot } from \"react-dom/client\";\n\ndeclare global {\n    interface Window {\n        eventCode: string,\n        startDate: string,\n        endDate: string,\n        matchCountData: MatchCountData,\n        currentSchedule: ScheduleBlock[],\n        allowCustomSchedules: boolean,\n        matchPhase: 'PRACTICE' | 'QUALS'\n    }\n}\n\nconst container = document.getElementById('reactContainer');\nif(!container) {\n    console.error(\"Mount point for container not found\")\n} else {\n  const root = createRoot(container);\n  root.render(<LocalErrorBoundary>\n        <MatchSchedule eventCode={window.eventCode}\n                       matchCountData={window.matchCountData}\n                       initialSchedule={window.currentSchedule.map(s => {\n                           const newBlock = {\n                               ...s,\n                               start: Temporal.PlainDateTime.from(s.start),\n                               end: Temporal.PlainDateTime.from(s.end)\n                           }\n                           if (newBlock.type == \"MATCH\") {\n                               newBlock.cycleTime = Temporal.Duration.from(newBlock.cycleTime);\n                           }\n                           return newBlock\n                       })}\n                       allowCustomSchedules={window.allowCustomSchedules}\n                       startDate={Temporal.PlainDate.from(window.startDate)}\n                       endDate={Temporal.PlainDate.from(window.endDate)}\n                       phase={window.matchPhase} />\n    </LocalErrorBoundary>);\n}"],"names":["FriendlyNumberInput","val","onChange","minVal","maxVal","step","rest","liveState","setLiveState","useState","useEffect","parseFunc","isNumber","jsx","e","newValue","timeFormatOpts","matchesPerBlock","block","EditMatchBlock","date","updateBlock","overlaps","minCycle","matchCount","extraTime","id","useId","cycleTime","jsxs","newEnd","Temporal","ngettext","msgid","t","OverlayTrigger","Tooltip","Form","newStart","Button","EditBreakBlock","blocksReducer","teamCount","perTeam","blocks","action","ret","b","a","diff","i","oldEnd","newBlock","prev","next","count","surrogates","teamPlayed","completeRounds","teamsInNextRound","teamsInThisRound","message","isMatchBlock","MatchSchedule","eventCode","matchCountData","initialSchedule","allowCustomSchedules","startDate","endDate","phase","setPerTeam","blocksReducerFunc","useCallback","updateBlocks","useReducer","dateSet","d","dates","scheduleHtml","setScheduleHtml","active","setActive","lastPlayed","setLastPlayed","hasSchedule","setHasSchedule","scheduleHeight","setScheduleHeight","scheduleRef","useRef","lastMMUpdates","setLastMMUpdates","currentFile","setCurrentFile","usePersistentWebsocket","evt","_a","loadData","lastMMUpdate","start","end","res","data","blocksByDate","acc","totalMatchesScheduled","previewSchedule","PermissiveURLSearchParams","saveSchedule","messageDialog","runMatchMaker","clearMatches","confirmDialog","toggleActive","uploadSchedule","formData","text","wrongMatchCount","anyOverlaps","matchBlocks","conflict","Fragment","Alert","dayBlocks","newBlockStartTime","newBlockCycles","_b","newBlockEndTime","idx","previousBlock","nextBlock","MatchMakerStatus","ProgressBar","container","createRoot","LocalErrorBoundary","s"],"mappings":"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"}