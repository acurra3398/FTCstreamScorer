var J=Object.defineProperty;var z=(d,P,i)=>P in d?J(d,P,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[P]=i;var W=(d,P,i)=>z(d,typeof P!="symbol"?P+"":P,i);import{f as H,r as N}from"./client-BvsFx6Uv.js";try{let d=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},P=new d.Error().stack;P&&(d._sentryDebugIds=d._sentryDebugIds||{},d._sentryDebugIds[P]="2115d3e5-ee66-400f-9664-eba6aed2a395",d._sentryDebugIdIdentifier="sentry-dbid-2115d3e5-ee66-400f-9664-eba6aed2a395")}catch{}(function(d){function P(p,m){var l=d.createEvent("Event");l.initEvent(p,!0,!1),m.dispatchEvent(l)}function i(p){p.stopPropagation(),p.stopImmediatePropagation(),d[s.enabled]=d[e.enabled],d[s.element]=d[e.element],P(s.events.change,p.target)}function h(p){P(s.events.error,p.target)}function v(p){return function(m,l){function t(){m(),d.removeEventListener(s.events.change,t,!1)}function f(){l(new TypeError),d.removeEventListener(s.events.error,f,!1)}return p!==s.exit||d[e.element]?(d.addEventListener(s.events.change,t,!1),void d.addEventListener(s.events.error,f,!1)):void setTimeout(function(){l(new TypeError)},1)}}var e,c,a={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitFullscreenEnabled",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},s=a.w3;for(c in a)if(a[c].enabled in d){e=a[c];break}return s.enabled in d||!e||(d.addEventListener(e.events.change,i,!1),d.addEventListener(e.events.error,h,!1),d[s.enabled]=d[e.enabled],d[s.element]=d[e.element],d[s.exit]=function(){var p=d[e.exit]();return!p&&window.Promise?new Promise(v(s.exit)):p},Element.prototype[s.request]=function(){var p=this[e.request].apply(this,arguments);return!p&&window.Promise?new Promise(v(s.request)):p}),e})(document);function D(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var U={exports:{}},X;function Y(){return X||(X=1,function(d,P){(function(i){d.exports=i()})(function(){return function(){function i(h,v,e){function c(p,m){if(!v[p]){if(!h[p]){var l=typeof D=="function"&&D;if(!m&&l)return l(p,!0);if(a)return a(p,!0);var t=new Error("Cannot find module '"+p+"'");throw t.code="MODULE_NOT_FOUND",t}var f=v[p]={exports:{}};h[p][0].call(f.exports,function(y){var o=h[p][1][y];return c(o||y)},f,f.exports,i,h,v,e)}return v[p].exports}for(var a=typeof D=="function"&&D,s=0;s<e.length;s++)c(e[s]);return c}return i}()({1:[function(i,h,v){var e=i("./raw"),c=[],a=[],s=e.makeRequestCallFromTimer(p);function p(){if(a.length)throw a.shift()}h.exports=m;function m(t){var f;c.length?f=c.pop():f=new l,f.task=t,e(f)}function l(){this.task=null}l.prototype.call=function(){try{this.task.call()}catch(t){m.onerror?m.onerror(t):(a.push(t),s())}finally{this.task=null,c[c.length]=this}}},{"./raw":2}],2:[function(i,h,v){h.exports=e;function e(o){c.length||a(),c[c.length]=o}var c=[],a,s=0,p=1024;function m(){for(;s<c.length;){var o=s;if(s=s+1,c[o].call(),s>p){for(var r=0,w=c.length-s;r<w;r++)c[r]=c[r+s];c.length-=s,s=0}}c.length=0,s=0}var l=typeof H<"u"?H:self,t=l.MutationObserver||l.WebKitMutationObserver;typeof t=="function"?a=f(m):a=y(m),e.requestFlush=a;function f(o){var r=1,w=new t(o),g=document.createTextNode("");return w.observe(g,{characterData:!0}),function(){r=-r,g.data=r}}function y(o){return function(){var w=setTimeout(T,0),g=setInterval(T,50);function T(){clearTimeout(w),clearInterval(g),o()}}}e.makeRequestCallFromTimer=y},{}],3:[function(i,h,v){h.exports=i("./lib")},{"./lib":8}],4:[function(i,h,v){var e=i("asap/raw");function c(){}var a=null,s={};function p(n){try{return n.then}catch(u){return a=u,s}}function m(n,u){try{return n(u)}catch(_){return a=_,s}}function l(n,u,_){try{n(u,_)}catch(O){return a=O,s}}h.exports=t;function t(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof n!="function")throw new TypeError("Promise constructor's argument is not a function");this._U=0,this._V=0,this._W=null,this._X=null,n!==c&&E(n,this)}t._Y=null,t._Z=null,t._0=c,t.prototype.then=function(n,u){if(this.constructor!==t)return f(this,n,u);var _=new t(c);return y(this,new T(n,u,_)),_};function f(n,u,_){return new n.constructor(function(O,R){var x=new t(c);x.then(O,R),y(n,new T(u,_,x))})}function y(n,u){for(;n._V===3;)n=n._W;if(t._Y&&t._Y(n),n._V===0){if(n._U===0){n._U=1,n._X=u;return}if(n._U===1){n._U=2,n._X=[n._X,u];return}n._X.push(u);return}o(n,u)}function o(n,u){e(function(){var _=n._V===1?u.onFulfilled:u.onRejected;if(_===null){n._V===1?r(u.promise,n._W):w(u.promise,n._W);return}var O=m(_,n._W);O===s?w(u.promise,a):r(u.promise,O)})}function r(n,u){if(u===n)return w(n,new TypeError("A promise cannot be resolved with itself."));if(u&&(typeof u=="object"||typeof u=="function")){var _=p(u);if(_===s)return w(n,a);if(_===n.then&&u instanceof t){n._V=3,n._W=u,g(n);return}else if(typeof _=="function"){E(_.bind(u),n);return}}n._V=1,n._W=u,g(n)}function w(n,u){n._V=2,n._W=u,t._Z&&t._Z(n,u),g(n)}function g(n){if(n._U===1&&(y(n,n._X),n._X=null),n._U===2){for(var u=0;u<n._X.length;u++)y(n,n._X[u]);n._X=null}}function T(n,u,_){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof u=="function"?u:null,this.promise=_}function E(n,u){var _=!1,O=l(n,function(R){_||(_=!0,r(u,R))},function(R){_||(_=!0,w(u,R))});!_&&O===s&&(_=!0,w(u,a))}},{"asap/raw":2}],5:[function(i,h,v){var e=i("./core.js");h.exports=e,e.prototype.done=function(c,a){var s=arguments.length?this.then.apply(this,arguments):this;s.then(null,function(p){setTimeout(function(){throw p},0)})}},{"./core.js":4}],6:[function(i,h,v){var e=i("./core.js");h.exports=e;var c=t(!0),a=t(!1),s=t(null),p=t(void 0),m=t(0),l=t("");function t(y){var o=new e(e._0);return o._V=1,o._W=y,o}e.resolve=function(y){if(y instanceof e)return y;if(y===null)return s;if(y===void 0)return p;if(y===!0)return c;if(y===!1)return a;if(y===0)return m;if(y==="")return l;if(typeof y=="object"||typeof y=="function")try{var o=y.then;if(typeof o=="function")return new e(o.bind(y))}catch(r){return new e(function(w,g){g(r)})}return t(y)};var f=function(y){return typeof Array.from=="function"?(f=Array.from,Array.from(y)):(f=function(o){return Array.prototype.slice.call(o)},Array.prototype.slice.call(y))};e.all=function(y){var o=f(y);return new e(function(r,w){if(o.length===0)return r([]);var g=o.length;function T(n,u){if(u&&(typeof u=="object"||typeof u=="function"))if(u instanceof e&&u.then===e.prototype.then){for(;u._V===3;)u=u._W;if(u._V===1)return T(n,u._W);u._V===2&&w(u._W),u.then(function(R){T(n,R)},w);return}else{var _=u.then;if(typeof _=="function"){var O=new e(_.bind(u));O.then(function(R){T(n,R)},w);return}}o[n]=u,--g===0&&r(o)}for(var E=0;E<o.length;E++)T(E,o[E])})},e.reject=function(y){return new e(function(o,r){r(y)})},e.race=function(y){return new e(function(o,r){f(y).forEach(function(w){e.resolve(w).then(o,r)})})},e.prototype.catch=function(y){return this.then(null,y)}},{"./core.js":4}],7:[function(i,h,v){var e=i("./core.js");h.exports=e,e.prototype.finally=function(c){return this.then(function(a){return e.resolve(c()).then(function(){return a})},function(a){return e.resolve(c()).then(function(){throw a})})}},{"./core.js":4}],8:[function(i,h,v){h.exports=i("./core.js"),i("./done.js"),i("./finally.js"),i("./es6-extensions.js"),i("./node-extensions.js"),i("./synchronous.js")},{"./core.js":4,"./done.js":5,"./es6-extensions.js":6,"./finally.js":7,"./node-extensions.js":9,"./synchronous.js":10}],9:[function(i,h,v){var e=i("./core.js"),c=i("asap");h.exports=e,e.denodeify=function(m,l){return typeof l=="number"&&l!==1/0?s(m,l):p(m)};var a="function (err, res) {if (err) { rj(err); } else { rs(res); }}";function s(m,l){for(var t=[],f=0;f<l;f++)t.push("a"+f);var y=["return function ("+t.join(",")+") {","var self = this;","return new Promise(function (rs, rj) {","var res = fn.call(",["self"].concat(t).concat([a]).join(","),");","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],y)(e,m)}function p(m){for(var l=Math.max(m.length-1,3),t=[],f=0;f<l;f++)t.push("a"+f);var y=["return function ("+t.join(",")+") {","var self = this;","var args;","var argLength = arguments.length;","if (arguments.length > "+l+") {","args = new Array(arguments.length + 1);","for (var i = 0; i < arguments.length; i++) {","args[i] = arguments[i];","}","}","return new Promise(function (rs, rj) {","var cb = "+a+";","var res;","switch (argLength) {",t.concat(["extra"]).map(function(o,r){return"case "+r+":res = fn.call("+["self"].concat(t.slice(0,r)).concat("cb").join(",")+");break;"}).join(""),"default:","args[argLength] = cb;","res = fn.apply(self, args);","}","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],y)(e,m)}e.nodeify=function(m){return function(){var l=Array.prototype.slice.call(arguments),t=typeof l[l.length-1]=="function"?l.pop():null,f=this;try{return m.apply(this,arguments).nodeify(t,f)}catch(y){if(t===null||typeof t>"u")return new e(function(o,r){r(y)});c(function(){t.call(f,y)})}}},e.prototype.nodeify=function(m,l){if(typeof m!="function")return this;this.then(function(t){c(function(){m.call(l,null,t)})},function(t){c(function(){m.call(l,t)})})}},{"./core.js":4,asap:1}],10:[function(i,h,v){var e=i("./core.js");h.exports=e,e.enableSynchronous=function(){e.prototype.isPending=function(){return this.getState()==0},e.prototype.isFulfilled=function(){return this.getState()==1},e.prototype.isRejected=function(){return this.getState()==2},e.prototype.getValue=function(){if(this._V===3)return this._W.getValue();if(!this.isFulfilled())throw new Error("Cannot get a value of an unfulfilled promise.");return this._W},e.prototype.getReason=function(){if(this._V===3)return this._W.getReason();if(!this.isRejected())throw new Error("Cannot get a rejection reason of a non-rejected promise.");return this._W},e.prototype.getState=function(){return this._V===3?this._W.getState():this._V===-1||this._V===-2?0:this._V}},e.disableSynchronous=function(){e.prototype.isPending=void 0,e.prototype.isFulfilled=void 0,e.prototype.isRejected=void 0,e.prototype.getValue=void 0,e.prototype.getReason=void 0,e.prototype.getState=void 0}},{"./core.js":4}],11:[function(i,h,v){h.exports=typeof window>"u"||typeof window.Promise>"u"?i("promise"):window.Promise},{promise:3}],12:[function(i,h,v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=e;function e(c){var a={};return c.emit=function(s,p){var m=a[s];m&&m.forEach(function(l){return l(p)})},c.on=function(s,p){var m=a[s]||(a[s]=[]);return m.push(p),c},c.off=function(s,p){if(p){var m=a[s],l=m.indexOf(p);l!==-1&&m.splice(l,1),m.length===0&&delete a[s]}else delete a[s];return c},c.list=function(s){return a[s]||[]},c}},{}],13:[function(i,h,v){Object.defineProperty(v,"__esModule",{value:!0}),v.fetch=e,v.post=c;function e(a,s,p,m,l,t){try{var f=new XMLHttpRequest;if(f.onreadystatechange=function(){if(f.readyState==4){var o=f.getResponseHeader("Content-Type");if(o&&o.indexOf("json")!==-1)try{var r=JSON.parse(f.responseText);l(null,r,f.status)}catch(w){l(w,null,f.status)}else l(null,f.responseText,f.status)}},m)for(var y in m)m.hasOwnProperty(y)&&f.setRequestHeader(y,m[y]);f.ontimeout=function(o){l(o,null,0)},f.open(a,s,!0),f.timeout=t,typeof p=="string"?f.send(p):p?(f.setRequestHeader("Content-Type","application/json"),f.send(JSON.stringify(p))):f.send()}catch(o){l(o,null,0)}}function c(a,s,p){return new Promise(function(m,l){var t=function(y,o,r){if(y)return l(y);m([o,r])};e("POST",a,s,null,t,p)})}},{}],14:[function(i,h,v){var e=typeof document<"u",c=typeof navigator<"u"&&navigator.product==="ReactNative";h.exports=i(e||c?"./request.browser":"./request.node")},{"./request.browser":13,"./request.node":15}],15:[function(i,h,v){Object.defineProperty(v,"__esModule",{value:!0}),v.post=m;var e=s(i("http")),c=s(i("https")),a=s(i("url"));function s(l){return l&&l.__esModule?l:{default:l}}var p=a.default.parse;function m(l,t,f){return new Promise(function(y,o){var r=t==="string"?t:JSON.stringify(t),w=p(l),g={host:w.hostname,port:w.port,path:w.path,method:"POST",headers:{"Content-Length":r.length}};t!=="string"&&(g.headers["Content-Type"]="application/json");var T=w.protocol==="https:"?c.default:e.default,E=T.request(g,function(n){n.setEncoding("utf8");var u="";n.on("data",function(_){u+=_}),n.on("end",function(){var _=n.headers["content-type"],O=_&&_.indexOf("json")!==-1;try{var R=O?JSON.parse(u):u;y([R,n.statusCode])}catch(x){o(x)}})});E.on("error",o),E.on("socket",function(n){n.setTimeout(f,function(){E.abort()})}),E.write(r),E.end()})}},{http:void 0,https:void 0,url:void 0}],16:[function(i,h,v){Object.defineProperty(v,"__esModule",{value:!0}),v.compare=e,v.add=c,v.sum=a,v.mean=s,v.std=p,v.variance=m,v.median=l;function e(t,f){return t>f?1:t<f?-1:0}function c(t,f){return t+f}function a(t){return t.reduce(c)}function s(t){return a(t)/t.length}function p(t){return Math.sqrt(m(t))}function m(t){if(t.length<2)return 0;var f=s(t);return t.map(function(y){return Math.pow(y-f,2)}).reduce(c)/(t.length-1)}function l(t){if(t.length<2)return t[0];var f=t.slice().sort(e);return f.length%2===0?(f[t.length/2-1]+f[t.length/2])/2:f[(t.length-1)/2]}},{}],17:[function(i,h,v){function e(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(w){return typeof w}:e=function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},e(o)}Object.defineProperty(v,"__esModule",{value:!0}),v.create=y;var c=t(i("./util.js")),a=t(i("./stat.js")),s=t(i("./request/request")),p=m(i("./emitter.js"));function m(o){return o&&o.__esModule?o:{default:o}}function l(){if(typeof WeakMap!="function")return null;var o=new WeakMap;return l=function(){return o},o}function t(o){if(o&&o.__esModule)return o;if(o===null||e(o)!=="object"&&typeof o!="function")return{default:o};var r=l();if(r&&r.has(o))return r.get(o);var w={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in o)if(Object.prototype.hasOwnProperty.call(o,T)){var E=g?Object.getOwnPropertyDescriptor(o,T):null;E&&(E.get||E.set)?Object.defineProperty(w,T,E):w[T]=o[T]}return w.default=o,r&&r.set(o,w),w}var f=i("./Promise");function y(o){var r={options:{interval:36e5,timeout:1e4,delay:1e3,repeat:5,peers:[],server:null,now:Date.now},offset:0,_timeout:null,_inProgress:{},_isFirst:!0,send:function(E,n,u){return s.post(E,n,u).then(function(_){var O=_[0];if(_[1]!==200)throw new Error("Send failure: bad HTTP StatusCode ("+_[1]+")");r.receive(E,O)}).catch(function(_){g(_)})},receive:function(E,n){n===void 0&&(n=E,E=void 0),n&&n.id in r._inProgress?r._inProgress[n.id](n.result):n&&n.id!==void 0&&r.send(E,{jsonrpc:"2.0",id:n.id,result:r.now()})},_handleRPCSendError:function(E,n,u){delete r._inProgress[E],n(new Error("Send failure"))},rpc:function(E,n,u){var _=c.nextId(),O,R,x=new f(function(q,k){O=q,R=k});r._inProgress[_]=function(q){delete r._inProgress[_],O(q)};var C;try{C=r.send(E,{jsonrpc:"2.0",id:_,method:n,params:u},r.options.timeout)}catch(q){r._handleRPCSendError(_,R,q)}return C&&(C instanceof f||C.then&&C.catch)?C.catch(r._handleRPCSendError.bind(this,_,R)):console.warn("Send should return a promise"),x},sync:function(){r.emit("sync","start");var E=r.options.server?[r.options.server]:r.options.peers;return f.all(E.map(function(n){return r._syncWithPeer(n)})).then(function(n){var u=n.filter(function(_){return r._validOffset(_)});u.length>0&&(r.offset=a.mean(u),r.emit("change",r.offset)),r.emit("sync","end")})},_validOffset:function(E){return E!==null&&!isNaN(E)&&isFinite(E)},_syncWithPeer:function(E){var n=[];function u(){return r._getOffset(E).then(function(R){return n.push(R)})}function _(){return c.wait(r.options.delay).then(u)}function O(){return n.length<r.options.repeat}return u().then(function(){return c.whilst(O,_)}).then(function(){var R=n.filter(function(M){return M!==null}),x=R.map(function(M){return M.roundtrip}),C=a.median(x)+a.std(x),q=R.filter(function(M){return M.roundtrip<C}),k=q.map(function(M){return M.offset});return k.length>0?a.mean(k):null})},_getOffset:function(E){var n=r.options.now();return r.rpc(E,"timesync").then(function(u){var _=r.options.now(),O=_-n,R=u-_+O/2;return r._isFirst&&(r._isFirst=!1,r.offset=R,r.emit("change",R)),{roundtrip:O,offset:R}}).catch(function(u){return null})},now:function(){return r.options.now()+r.offset},destroy:function(){clearTimeout(r._timeout)}};if(o){if(o.server&&o.peers)throw new Error('Configure either option "peers" or "server", not both.');for(var w in o)o.hasOwnProperty(w)&&(w==="peers"&&typeof o.peers=="string"?r.options.peers=o.peers.split(",").map(function(T){return T.trim()}).filter(function(T){return T!==""}):r.options[w]=o[w])}(0,p.default)(r);function g(T){r.list("error").length>0?r.emit("error",T):console.log("Error",T)}return r.options.interval!==null&&(r._timeout=setInterval(r.sync,r.options.interval),setTimeout(function(){r.sync().catch(function(T){return g(T)})},0)),r}},{"./Promise":11,"./emitter.js":12,"./request/request":14,"./stat.js":16,"./util.js":18}],18:[function(i,h,v){Object.defineProperty(v,"__esModule",{value:!0}),v.wait=c,v.repeat=a,v.whilst=s,v.nextId=p;var e=i("./Promise");function c(l){return new e(function(t){setTimeout(t,l)})}function a(l,t){return new e(function(f,y){var o=0,r=[];function w(){o<t?(o++,l().then(function(g){r.push(g),w()})):f(r)}w()})}function s(l,t){return new e(function(f,y){function o(){l()?t().then(function(){return o()}):f()}o()})}function p(){return m++}var m=0},{"./Promise":11}]},{},[17])(17)})}(U)),U.exports}var G=Y();function $(d,P,i,h){typeof P=="function"&&(typeof i=="object"&&(h=i),i=P,P=void 0),!Array.isArray(P)&&typeof P=="object"&&(h=P,P=void 0),typeof i=="object"&&(h=i,i=void 0);const v=typeof window<"u"&&window.WebSocket;if(v&&(i=i||window.WebSocket,typeof window<"u"&&typeof window.addEventListener=="function"&&window.addEventListener("online",()=>n())),!i)throw new Error("Please supply a websocket library to use");h||(h={});let e=null,c=!1,a=null,s=null,p=null,m=null,l=!1,t=0,f=0;const y={},o={},r={},w={},g={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3,get readyState(){return e?e.readyState:0},get protocol(){return e?e.protocol:""},get extensions(){return e?e.extensions:""},get bufferedAmount(){return e?e.bufferedAmount:0},get binaryType(){return e?e.binaryType:"blob"},set binaryType(S){m=S,e&&(e.binaryType=S)},connect:n,url:d,retries:0,pingTimeout:"pingTimeout"in h?h.pingTimeout:!1,maxTimeout:h.maxTimeout||5*60*1e3,maxRetries:h.maxRetries||0,nextReconnectDelay:h.nextReconnectDelay||function(F){return Math.min((1+Math.random())*Math.pow(1.5,F)*1e3,g.maxTimeout)},send:function(){if(!e)throw new Error("InvalidAccessError");e.send.apply(e,arguments)},close:function(){clearTimeout(a),l=!0,e&&e.close.apply(e,arguments)},onopen:h.onopen,onmessage:h.onmessage,onclose:h.onclose,onerror:h.onerror,options:h},T=(S,F,j)=>(b,I,L)=>{function V(A){L&&L.once&&e[S==="on"?"off":"removeEventListener"](b,V),A&&typeof A=="object"&&t&&(A.reconnectDelay=t),I.apply(g,arguments)}b in F?F[b].push(I):F[b]=[I],b in j?j[b].push(V):j[b]=[V],e&&e[S](b,V)},E=(S,F,j)=>(b,I)=>{const L=F[b].indexOf(I);L!==-1&&(e&&e[S](b,j[b][L]),F[b].splice(L,1),j[b].splice(L,1))};return g.addEventListener=T("addEventListener",y,o),g.removeEventListener=E("removeEventListener",y,o),g.on=T("on",r,w),g.off=E("off",r,w),g.once=(S,F)=>g.on(S,F,{once:!0}),d&&Promise.resolve().then(n),g;async function n(S){const F=++f;if(l=c=!1,clearTimeout(a),e&&e.readyState!==g.CLOSED)return k(4665,"Manual connect initiated"),n(S);S&&(g.url=S),S=typeof g.url=="function"?await g.url(g):g.url,F===f&&(e=v?P?new i(S,P):new i(S):new i(S,P,h),typeof e.on=="function"?e.on("error",_):e.onerror=_,e.onclose=u,e.onopen=O,e.onmessage=R,Object.keys(o).forEach(j=>{o[j].forEach(b=>e.addEventListener(j,b))}),Object.keys(w).forEach(j=>{w[j].forEach(b=>e.on(j,b))}),m&&(e.binaryType=m))}function u(S){S.reconnectDelay=q(),g.onclose&&g.onclose.apply(g,arguments),clearTimeout(s),clearTimeout(p)}function _(){g.onerror&&g.onerror.apply(g,arguments)}function O(){g.onopen&&g.onopen.apply(g,arguments),x(),p=setTimeout(()=>g.retries=0,t||0)}function R(){g.onmessage&&g.onmessage.apply(g,arguments),x()}function x(){g.pingTimeout&&(clearTimeout(s),s=setTimeout(C,g.pingTimeout))}function C(){k(4663,"No heartbeat received within "+g.pingTimeout+"ms")}function q(){if(!l){if(c)return t-(Date.now()-c);if(!(g.maxRetries&&g.connects>=g.maxRetries))return c=Date.now(),t=Math.ceil(g.nextReconnectDelay(g.retries++)),a=setTimeout(n,t),t}}function k(S,F){e.onclose=e.onopen=e.onerror=e.onmessage=null,Object.keys(o).forEach(b=>{o[b].forEach(I=>e.removeEventListener(b,I))}),Object.keys(w).forEach(b=>{w[b].forEach(I=>e.removeListener(b,I))}),e.close(),e=null;const j=M(S,F);u(j),o.close&&o.close.forEach(b=>b(j)),w.close&&w.close.forEach(b=>b(S,F,t))}function M(S,F){let j;return typeof window<"u"&&window.CloseEvent?j=new window.CloseEvent("HeartbeatTimeout",{wasClean:!0,code:S,reason:F}):(j=new Error("HeartbeatTimeout"),j.code=S,j.reason=F),j}}const re=d=>new URLSearchParams(d);function Z(){return document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}function B(){return!!document.fullscreenElement}function oe(){return B()?Z():Promise.resolve()}function ie(d,P,i){const[h,v]=N.useState(),e=N.useRef();return N.useEffect(()=>{setTimeout(()=>{v(c=>c===void 0?!1:c)},1e3)},[]),N.useEffect(()=>{if(!d)return;let c=d;c.startsWith("/")&&(c=`${window.location.protocol==="https:"?"wss":"ws"}://${window.location.host}${d}`);const a=$(c,{pingTimeout:15*1e3});return e.current=a,a.onmessage=function(s){if(s.data==="pong")return;if(s.data.startsWith("APP_VERSION:")){const m=s.data.substring(12);window.FIRST_ENV&&m!==window.FIRST_ENV.appVersion&&(console.log(`App version mismatch, reloading (frontend ${window.FIRST_ENV.appVersion}, server ${m})`),window.location.reload());return}let p=JSON.parse(s.data);P(p)},a.onopen=()=>{a.send("APP_VERSION"),v(!0)},a.onclose=s=>{v(!1)},()=>{e.current&&(v(!1),e.current.onclose=null,e.current.close(),e.current=void 0)}},[d]),{isConnected:h===void 0?!0:h,send:c=>e.current&&h?e.current.send(c):console.warn("Socket disconnected, could not send message")}}function se(d,P,i){const[h,v]=N.useState(),e=N.useRef(),c=N.useRef({messageHandler:P,onOpen:i});return c.current.messageHandler=P,c.current.onOpen=i,N.useEffect(()=>{setTimeout(()=>{v(a=>a===void 0?!1:a)},1e3)},[]),N.useEffect(()=>{if(!d)return;const a=new K(d);return e.current=a,a.handleMessage=function(s){let p=JSON.parse(s.data);c.current.messageHandler(p)},a.onopen=()=>{v(!0),c.current.onOpen&&c.current.onOpen(a)},a.onclose=s=>{v(!1)},()=>{e.current&&(v(!1),e.current.onclose=null,e.current.close(),e.current=void 0)}},[d]),{isConnected:h===void 0?!0:h,send:a=>e.current?e.current.send(a):console.warn("Socket disconnected, could not send message"),now:()=>e.current?e.current.now():Date.now()}}class K{constructor(P){W(this,"socket");W(this,"ts");W(this,"onopen");W(this,"onclose");W(this,"handleMessage");P.startsWith("/")&&(P=`${window.location.protocol==="https:"?"wss":"ws"}://${window.location.host}${P}`),this.socket=$(P,{pingTimeout:15*1e3}),this.ts=G.create({server:this.socket,interval:3e4}),this.ts.send=async function(i,h,v){return i.send("TIMESYNC:"+JSON.stringify(h))},this.socket.onmessage=i=>{if(i.data!=="pong"){if(i.data.startsWith("TIMESYNC:")){this.ts.receive(null,JSON.parse(i.data.substring(9)));return}if(i.data.startsWith("APP_VERSION:")){const h=i.data.substring(12);window.FIRST_ENV&&h!==window.FIRST_ENV.appVersion&&(console.log(`App version mismatch, reloading (frontend ${window.FIRST_ENV.appVersion}, server ${h})`),window.location.reload());return}this.handleMessage&&this.handleMessage(i)}},this.socket.onopen=i=>{this.socket.send("APP_VERSION"),this.onopen&&this.onopen(i)},this.socket.onclose=i=>{this.onclose&&this.onclose(i)}}now(){return this.ts.now()}close(){this.ts.destroy(),this.socket.close()}send(P){this.socket.send(P)}}let Q=0;const ee=()=>Q++;function ue(){return N.useRef(`uniq_${ee()}`).current}function ce(d,P){let i="";return d>3600&&P?String(Math.floor(d/3600))+":"+String(Math.floor(d%3600/60)).padStart(2,"0")+":"+String(Math.floor(d%60)).padStart(2,"0"):i+Math.floor(d/60)+":"+String(Math.floor(d%60)).padStart(2,"0")}function ae(d){return window.FIRST_ENV.projectName=="FTCCloud"&&d.endsWith("/")?d.substring(0,d.length-1):window.FIRST_ENV.projectName=="FTCLocal"&&!d.endsWith("/")?d+"/":d}export{re as P,se as a,ue as b,D as c,oe as d,B as i,ae as n,ce as r,Z as t,ie as u};
//# sourceMappingURL=utils-CzBzcnQn.js.map
