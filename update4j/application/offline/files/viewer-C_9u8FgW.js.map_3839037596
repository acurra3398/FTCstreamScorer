{"version":3,"file":"viewer-C_9u8FgW.js","sources":["../../../../../../../../../FTCCommon/src/main/javascript/management/pitMap/viewer/index.ts"],"sourcesContent":["import PitMap, {Cell, LabelMode} from '@ftcscoring/pit-map';\n\ndeclare global {\n    interface Window {\n        pitMapData: Cell[],\n        displayTeamNumbers?: Record<number, string>,\n        mapConfig: { numbers: boolean, addresses: boolean },\n        mapBb: { x: number, y: number, h: number, w: number },\n        chosenTeam?: number,\n        pitMap: PitMap\n    }\n}\n\nfunction setZoom(pitMap : PitMap, newZoom : number) {\n    pitMap.setZoom(newZoom);\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n    window.pitMap = new PitMap({\n        id: \"pitMap\",\n        minView: true\n    });\n    const pitMap = window.pitMap;\n\n    // calculate if need to zoom out for initial fit\n    const wrapper = document.getElementById('pitMapWrapper')!;\n    let newZoom = 1;\n    while(wrapper.clientWidth < (window.mapBb.w * PitMap.BASE_CELL_SIZE * newZoom) && newZoom > .25) {\n        newZoom -= .1;\n    }\n    newZoom = Math.max(.25, newZoom);\n    setZoom(pitMap, newZoom);\n\n    if(window.displayTeamNumbers) {\n        pitMap.setDisplayTeamNumbers(window.displayTeamNumbers);\n    }\n    pitMap.setData(window.pitMapData);\n\n    if (!window.mapConfig.numbers) {\n        pitMap.setPitLabelMode(window.mapConfig.addresses ? LabelMode.ADDRESS : LabelMode.TEAM);\n    }\n\n    if(window.chosenTeam) {\n        const team = pitMap.findTeam(window.chosenTeam.toString())\n        if(team) {\n            pitMap.setHighlighted(team)\n        }\n    }\n});\n\nlet zoomBeforePrint: number | null = null;\n\nwindow.addEventListener(\"beforeprint\", (e) => {\n    const pitMap = window.pitMap;\n    zoomBeforePrint = pitMap.zoom;\n    let newZoom = 2;\n    while(1000 < (window.mapBb.w * PitMap.BASE_CELL_SIZE * newZoom) && newZoom > .25) {\n        newZoom -= .1;\n    }\n    newZoom = Math.max(.25, newZoom);\n    setZoom(pitMap, newZoom);\n    pitMap.prepareForPrint()\n})\n\nwindow.addEventListener(\"afterprint\", () => {\n    const pitMap = window.pitMap;\n    if(zoomBeforePrint) {\n        setZoom(pitMap, zoomBeforePrint);\n        zoomBeforePrint = null;\n    }\n    pitMap.donePrinting()\n})\n"],"names":["setZoom","pitMap","newZoom","PitMap","wrapper","LabelMode","team","zoomBeforePrint"],"mappings":"+XAaA,SAASA,EAAQC,EAAiBC,EAAkB,CAChDD,EAAO,QAAQC,CAAO,CAC1B,CAEA,SAAS,iBAAiB,mBAAoB,UAAY,CAC/C,OAAA,OAAS,IAAIC,EAAO,CACvB,GAAI,SACJ,QAAS,EAAA,CACZ,EACD,MAAMF,EAAS,OAAO,OAGhBG,EAAU,SAAS,eAAe,eAAe,EACvD,IAAIF,EAAU,EACR,KAAAE,EAAQ,YAAe,OAAO,MAAM,EAAID,EAAO,eAAiBD,GAAYA,EAAU,KAC7EA,GAAA,GAcf,GAZUA,EAAA,KAAK,IAAI,IAAKA,CAAO,EAC/BF,EAAQC,EAAQC,CAAO,EAEpB,OAAO,oBACCD,EAAA,sBAAsB,OAAO,kBAAkB,EAEnDA,EAAA,QAAQ,OAAO,UAAU,EAE3B,OAAO,UAAU,SAClBA,EAAO,gBAAgB,OAAO,UAAU,UAAYI,EAAU,QAAUA,EAAU,IAAI,EAGvF,OAAO,WAAY,CAClB,MAAMC,EAAOL,EAAO,SAAS,OAAO,WAAW,UAAU,EACtDK,GACCL,EAAO,eAAeK,CAAI,CAC9B,CAER,CAAC,EAED,IAAIC,EAAiC,KAErC,OAAO,iBAAiB,cAAgB,GAAM,CAC1C,MAAMN,EAAS,OAAO,OACtBM,EAAkBN,EAAO,KACzB,IAAIC,EAAU,EACR,KAAA,IAAQ,OAAO,MAAM,EAAIC,EAAO,eAAiBD,GAAYA,EAAU,KAC9DA,GAAA,GAELA,EAAA,KAAK,IAAI,IAAKA,CAAO,EAC/BF,EAAQC,EAAQC,CAAO,EACvBD,EAAO,gBAAgB,CAC3B,CAAC,EAED,OAAO,iBAAiB,aAAc,IAAM,CACxC,MAAMA,EAAS,OAAO,OACnBM,IACCP,EAAQC,EAAQM,CAAe,EACbA,EAAA,MAEtBN,EAAO,aAAa,CACxB,CAAC"}