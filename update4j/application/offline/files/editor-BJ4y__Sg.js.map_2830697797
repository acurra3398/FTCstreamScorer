{"version":3,"file":"editor-BJ4y__Sg.js","sources":["../../../../../../../../../FTCCommon/src/main/javascript/management/pitMap/editor/Editor.tsx","../../../../../../../../../FTCCommon/src/main/javascript/management/pitMap/editor/index.jsx"],"sourcesContent":["import {RefObject, useEffect, useReducer, useRef, useState} from \"react\";\nimport './Editor.css'\n\nimport PitMap, {AutoAssignmentType, Cell, CellType, Cursor, LabelMode, Rectangle} from \"@ftcscoring/pit-map\";\nimport {t} from \"ftc-common/i18n\";\nimport {messageDialog, promptDialog} from \"first-common/dialogs\"\nimport {PermissiveURLSearchParams} from \"ftc-common/utils\";\nimport {isEqual} from \"lodash\";\nimport {fileUploadDialog} from \"first-common/upload\";\nimport {Button, Form} from \"react-bootstrap\";\nimport {BlockPicker} from \"react-color\";\nimport {TeamData} from \"../../../javaTypes\";\n\nconst DEFAULT_COLOR = '#ffa500';\n\nenum ViewType {\n    EDIT,\n    PREVIEW\n}\n\nfunction EditCursorGroup({cursor, setCursor} : {\n    cursor: Cursor,\n    setCursor: (c : Cursor) => void\n}) {\n    return <div className={\"toolbarGroup\"}>\n        <span>{t`Cursor:`}</span>\n        <button className={`btn ${cursor === Cursor.POINTER ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Select / Group Move`} onClick={() => setCursor(Cursor.POINTER)}><i className=\"fa fa-mouse-pointer\"></i></button>\n        <button className={`btn ${cursor === Cursor.SINGLE ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Single Place`} onClick={() => setCursor(Cursor.SINGLE)}><i className=\"fa fa-mouse-pointer fa-xs\"><sup>+</sup></i></button>\n        <button className={`btn ${cursor === Cursor.FILL ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Fill Area`} onClick={() => setCursor(Cursor.FILL)}><i className=\"fa fa-crosshairs\"></i></button>\n        <button className={`btn ${cursor === Cursor.GRAB ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Single Grab & Move`} onClick={() => setCursor(Cursor.GRAB)}><i className=\"fa fa-hand-paper\"></i></button>\n        <button className={`btn ${cursor === Cursor.TEXT ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Label`} onClick={() => setCursor(Cursor.TEXT)}><i className=\"fa fa-i-cursor\"></i></button>\n        <button className={`btn ${cursor === Cursor.TEXT_ROT ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Label (rot)`} onClick={() => setCursor(Cursor.TEXT_ROT)}><i className=\"fa fa-i-cursor fa-rotate-90\"></i></button>\n        <button className={`btn ${cursor === Cursor.DELETE ? \"btn-danger\" : \"btn-outline-danger\"}`} title={t`Delete`} onClick={() => setCursor(Cursor.DELETE)}><i className=\"fa fa-trash\"></i></button>\n    </div>\n}\n\nfunction AssignCursorGroup({cursor, setCursor, pitLabelMode} : {\n    cursor: Cursor,\n    setCursor: (c : Cursor) => void,\n    pitLabelMode: LabelMode\n}) {\n    return <div className={\"toolbarGroup\"}>\n        <span>{t`Cursor:`}</span>\n        <button className={`btn ${cursor === Cursor.ASSIGN ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Assign Value(s)`} onClick={() => setCursor(Cursor.ASSIGN)}><i className=\"fa fa-mouse-pointer\"></i></button>\n        {pitLabelMode === LabelMode.ADDRESS ? <button className={`btn ${cursor === Cursor.SINGLE ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Quick Assign`} onClick={() => setCursor(Cursor.SINGLE)}><i className=\"fa fa-mouse-pointer fa-xs\"><sup>+</sup></i></button> : null}\n        {pitLabelMode !== LabelMode.NUMBER ? <button className={`btn ${cursor === Cursor.CLEAR ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Delete`} onClick={() => setCursor(Cursor.CLEAR)}><i className=\"fa fa-trash fa-xs\"></i></button> : null}\n        <button className={`btn ${cursor === Cursor.INSPECT ? \"btn-primary\" : \"btn-outline-primary\"}`} title={t`Pit Info`} onClick={() => setCursor(Cursor.INSPECT)}><i className=\"fa fa-info-circle\"></i></button>\n    </div>\n}\n\nfunction CellGroup({cursor, cellType, setCellType}: {\n    cursor: Cursor,\n    cellType: CellType,\n    setCellType: (c: CellType) => void\n}) {\n    const enabled = cursor === Cursor.SINGLE || cursor === Cursor.FILL;\n    const noField = cursor === Cursor.FILL;\n    return <div className={\"toolbarGroup\"}>\n        <span>{t`Cell Type:`}</span>\n        <button className={`btn ${cursor === Cursor.SINGLE && cellType === CellType.OPEN ? \"btn-primary\" : \"btn-outline-primary\"}`} disabled={!enabled} onClick={() => setCellType(CellType.OPEN)}>{t`Open`}</button>\n        <button className={`btn ${cursor === Cursor.SINGLE && cellType === CellType.BOUNDARY ? \"btn-primary\" : \"btn-outline-primary\"}`} disabled={!enabled} onClick={() => setCellType(CellType.BOUNDARY)}>{t`Boundary`}</button>\n        <button className={`btn ${cursor === Cursor.SINGLE && cellType === CellType.PIT ? \"btn-primary\" : \"btn-outline-primary\"}`} disabled={!enabled} onClick={() => setCellType(CellType.PIT)}>{t`Pit`}</button>\n        <button className={`btn ${cursor === Cursor.SINGLE && cellType === CellType.FIELD ? \"btn-primary\" : \"btn-outline-primary\"}`} disabled={!enabled || noField} onClick={() => setCellType(CellType.FIELD)}>{t`Field`}</button>\n        <button className={`btn ${cursor === Cursor.SINGLE && cellType === CellType.FIELD_ROT ? \"btn-primary\" : \"btn-outline-primary\"}`} disabled={!enabled || noField} onClick={() => setCellType(CellType.FIELD_ROT)}>{t`Field (rotated)`}</button>\n        <button className={`btn ${cursor === Cursor.SINGLE && cellType === CellType.OBJECT ? \"btn-primary\" : \"btn-outline-primary\"}`} disabled={!enabled} onClick={() => setCellType(CellType.OBJECT)}>{t`Object`}</button>\n        <button className={`btn ${cursor === Cursor.SINGLE && cellType === CellType.LABEL ? \"btn-primary\" : \"btn-outline-primary\"}`} disabled={!enabled} onClick={() => setCellType(CellType.LABEL)}>{t`Label`}</button>\n    </div>\n}\n\nfunction UndoGroup({undo, redo} : {\n    undo: () => void,\n    redo: () => void\n}){\n    return <div className={\"toolbarGroup\"}>\n        <span>{t`Undo:`}</span>\n        <button className={`btn btn-outline-primary`} onClick={() => undo()}><i className=\"fa fa-undo\"></i></button>\n        <button className={`btn btn-outline-primary`} onClick={() => redo()}><i className=\"fa fa-repeat\"></i></button>\n    </div>\n}\n\nfunction ZoomGroup({zoom, zoomDispatch} : {\n    zoom: number,\n    zoomDispatch: (dir: 'in' | 'out') => void\n}) {\n    return <div className={\"toolbarGroup\"}>\n        <span>{t`Zoom:`}{(zoom * 100).toFixed(0) + \"%\"}</span>\n        <button className={`btn btn-outline-primary`} onClick={() => zoomDispatch('out')}><i className=\"fa fa-search-minus\"></i></button>\n        <button className={`btn btn-outline-primary`} onClick={() => zoomDispatch('in')}><i className=\"fa fa-search-plus\"></i></button>\n    </div>\n}\n\nfunction ColorGroup({color, used, setColor} : {\n    color: string,\n    used: string[],\n    setColor: (color: string) => void\n}) {\n    const [showPicker, setShowPicker] = useState(false);\n    return <div className={\"toolbarGroup\"}>\n        <button className=\"btn btn-secondary btn-sm ml-3\" onClick={() => setShowPicker(!showPicker)} style={{position: 'relative', top: '-.5rem'}}>{showPicker ? \"Hide Picker\" : \"Pick Color\"}</button>\n        <div className=\"ml-2\" onClick={() => setShowPicker(true)} style={{display: 'inline-block', width: '2em', height: '2em', background: color, position: 'relative', top: '.25rem'}}/>\n        { showPicker ? <div style={{ position: 'absolute', zIndex: 2 }} className={\"colorPicker\"}>\n            <div style={{ position: 'fixed', right: 0, top: '-.5rem' }} onClick={() => setShowPicker(false)}/>\n            <BlockPicker colors={used} color={color} triangle=\"hide\" onChangeComplete={(e) => setColor(e.hex)}/>\n        </div> : null }\n    </div>\n}\n\nfunction AddressGroupGroup({group, increment, setGroup, setIncrement} : {\n    group: string,\n    increment: number,\n    setGroup: (group: string) => void,\n    setIncrement: (increment: number) => void,\n}) {\n    return <div className={\"toolbarGroup\"}>\n        <span>Prefix:</span>\n        <Form.Control value={group} style={{width: '6ch', display: 'inline-block'}} onChange={e => setGroup(e.target.value)}></Form.Control>\n\n        <span>Increment:</span>\n        <Form.Control type={\"number\"} value={increment} style={{width: '7ch', display: 'inline-block'}} onChange={e => setIncrement(parseInt(e.target.value))}></Form.Control>\n    </div>\n}\n\nfunction ShiftGroup({shift}: {\n    shift: (dir: 'up' | 'down' | 'left' | 'right') => void\n}) {\n    return <div className={\"toolbarGroup\"}>\n        <span>{t`Shift Origin:`}</span>\n        <button className={`btn btn-outline-primary`} onClick={() => shift('up')}><i className=\"fa fa-arrow-up\"></i></button>\n        <button className={`btn btn-outline-primary`} onClick={() => shift('down')}><i className=\"fa fa-arrow-down\"></i></button>\n        <button className={`btn btn-outline-primary`} onClick={() => shift('left')}><i className=\"fa fa-arrow-left\"></i></button>\n        <button className={`btn btn-outline-primary`} onClick={() => shift('right')}><i className=\"fa fa-arrow-right\"></i></button>\n    </div>\n}\n\nfunction PitLabelGroup({pitLabelMode, setPitLabelMode} : {\n    pitLabelMode: LabelMode,\n    setPitLabelMode: (c : LabelMode) => void\n}) {\n    return <div className={\"toolbarGroup\"}>\n        <span>{t`Pit Label:`}</span>\n        <button className={`btn ${pitLabelMode === LabelMode.NUMBER ? \"btn-primary\" : \"btn-outline-primary\"}`} onClick={() => setPitLabelMode(LabelMode.NUMBER)}>{t`Number`}</button>\n        <button className={`btn ${pitLabelMode === LabelMode.ADDRESS ? \"btn-primary\" : \"btn-outline-primary\"}`} onClick={() => setPitLabelMode(LabelMode.ADDRESS)}>{t`Address`}</button>\n        <button className={`btn ${pitLabelMode === LabelMode.TEAM ? \"btn-primary\" : \"btn-outline-primary\"}`} onClick={() => setPitLabelMode(LabelMode.TEAM)}>{t`Team`}</button>\n        <button className={`btn ${pitLabelMode === LabelMode.COLOR ? \"btn-primary\" : \"btn-outline-primary\"}`} onClick={() => setPitLabelMode(LabelMode.COLOR)}>{t`Color`}</button>\n    </div>\n}\n\nfunction EditToolbar({cursor, cellType, zoom, setCursor, setCellType, zoomDispatch, undo, redo, shift}: {\n    cursor: Cursor,\n    cellType: CellType,\n    zoom: number,\n    setCursor: (c : Cursor) => void,\n    setCellType: (c : CellType) => void,\n    zoomDispatch: (dir: 'in' | 'out') => void,\n    undo: () => void,\n    redo: () => void,\n    shift: (dir: 'up' | 'down' | 'left' | 'right') => void\n}) {\n    return <div className={\"toolbar d-flex flex-wrap\"}>\n        <EditCursorGroup cursor={cursor} setCursor={setCursor}/>\n        <CellGroup cursor={cursor} cellType={cellType} setCellType={setCellType}/>\n        <UndoGroup undo={undo} redo={redo}/>\n        <ShiftGroup shift={shift}/>\n        <ZoomGroup zoom={zoom} zoomDispatch={zoomDispatch}/>\n    </div>\n}\n\nfunction AssignToolbar({cursor, zoom, pitLabelMode, setCursor, zoomDispatch, setPitLabelMode, color, usedColors, setColor, group, setGroup, increment, setIncrement}  : {\n    cursor: Cursor,\n    pitLabelMode: LabelMode,\n    zoom: number,\n    setCursor: (c : Cursor) => void,\n    setPitLabelMode: (c : LabelMode) => void,\n    zoomDispatch: (dir: 'in' | 'out') => void,\n    color: string,\n    usedColors: string[],\n    setColor: (color: string) => void,\n    group: string,\n    setGroup: (group: string) => void,\n    increment: number,\n    setIncrement: (incr: number) => void\n}) {\n    return <div className={\"toolbar d-flex flex-wrap\"}>\n        <AssignCursorGroup cursor={cursor} setCursor={setCursor} pitLabelMode={pitLabelMode}/>\n        <PitLabelGroup pitLabelMode={pitLabelMode} setPitLabelMode={setPitLabelMode}/>\n        <ZoomGroup zoom={zoom} zoomDispatch={zoomDispatch}/>\n        {pitLabelMode === LabelMode.COLOR ? <ColorGroup color={color} used={usedColors} setColor={setColor}/> : null}\n        {pitLabelMode === LabelMode.ADDRESS && cursor == Cursor.SINGLE ? <AddressGroupGroup group={group} setGroup={setGroup} increment={increment} setIncrement={setIncrement}/> : null}\n    </div>\n}\n\nfunction Toolbar({editMode, ...actions} : {\n    editMode: 'EDIT' | 'ASSIGN',\n    cursor: Cursor,\n    cellType: CellType,\n    pitLabelMode: LabelMode,\n    zoom: number,\n    setCursor: (c : Cursor) => void,\n    setCellType: (c : CellType) => void,\n    setPitLabelMode: (c : LabelMode) => void,\n    zoomDispatch: (dir: 'in' | 'out') => void,\n    undo: () => void,\n    redo: () => void,\n    shift: (dir: 'up' | 'down' | 'left' | 'right') => void,\n    color: string,\n    usedColors: string[],\n    setColor: (color: string) => void,\n    group: string,\n    setGroup: (group: string) => void,\n    increment: number,\n    setIncrement: (incr: number) => void\n}) {\n    return editMode === \"EDIT\" ? <EditToolbar {...actions}/> : <AssignToolbar {...actions}/>;\n}\n\nfunction zoomReducer (current : number, op : 'in' | 'out' | 'reset' | { set : number }) {\n    if (!op || !current) {\n        return 1;\n    }\n    if (typeof op === 'object') {\n        return op.set;\n    }\n    switch (op) {\n        case 'reset': return 1;\n        case 'in': return current < 1 ? current + .1 : current + .25;\n        case 'out': return current <= 1 ? Math.max(current - .1, .25) : current - .25;\n    }\n}\n\nfunction EditorButtons({editMode, setView, exportFunc, importFunc, clear, reset, save, assign} : {\n    editMode: 'EDIT' | 'ASSIGN',\n    setView: (type: ViewType) => void,\n    exportFunc: (() => void),\n    importFunc: (data: any, cellData: Cell[] | undefined) => void,\n    clear: () => void,\n    reset: () => void,\n    save: () => void,\n    assign: (type: AutoAssignmentType) => void\n}) {\n    return <div className={\"d-flex justify-content-end viewBtns\"}>\n        <span style={{marginRight: 'auto'}}>Cell unit is &frac14; pit</span>\n        <button id=\"assignDropdownBtn\" className=\"btn btn-secondary dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\" hidden={editMode !== \"ASSIGN\"}>\n            {t`Auto-assign Pits`}\n        </button>\n        <div className=\"dropdown-menu\" aria-labelledby=\"assignDropdownBtn\">\n            <button className=\"dropdown-item\" onClick={() => assign(AutoAssignmentType.ASCENDING)}>{t`In Order (Ascending)`}</button>\n            <button className=\"dropdown-item\" onClick={() => assign(AutoAssignmentType.DESCENDING)}>{t`In Order  (Descending)`}</button>\n            <button className=\"dropdown-item\" onClick={() => assign(AutoAssignmentType.RANDOM)}>{t`Random`}</button>\n        </div>\n        <button className={`btn btn-secondary`} onClick={exportFunc}>{t`Export`}</button>\n        <Button size=\"sm\" className={\"ms-1\"} variant={\"btn btn-secondary\"} onClick={() => fileUploadDialog({\n            label: t`Import`,\n            text: t`Select a file to upload. Page will refresh when complete.`,\n            buttonText: t`Upload`,\n            onComplete: (data) => {\n                if (data === undefined) {\n                    return;\n                }\n                let fileReader = new FileReader();\n                fileReader.onloadend = (status) => {\n                    importFunc(fileReader.result, undefined)\n                };\n                fileReader.readAsText(data?.file);\n            },\n            doUpload: false,\n            filter: {\n                regex: \".pitmap\",\n                error: t`File must be a pitmap file`\n            },\n        })}>Import</Button>\n        <div className={`vr`}></div>\n        <button className={`btn btn-danger`} onClick={clear}>{t`Clear`}</button>\n        <button className={`btn btn-warning`} onClick={reset}>{t`Reset`}</button>\n        {editMode === 'EDIT' ? <>\n            <button className={`btn btn-secondary`} onClick={() => setView(ViewType.EDIT)}>{t`Edit`}</button>\n            <button className={`btn btn-outline-secondary`} onClick={() => setView(ViewType.PREVIEW)}>{t`Preview`}</button>\n        </> : null}\n        <button className={`btn btn-primary`} onClick={save}>{t`Save`}</button>\n    </div>\n}\n\nfunction externalAssignmentUpdate(objects: any) {\n    // @ts-ignore\n    if (window.externalAssignCallback) window.externalAssignCallback(objects);\n}\n\nfunction pitAssign(this: PitMap, pits : Cell[], mode : LabelMode, colorRef: RefObject<string>) {\n    const LABELS = {\n        [LabelMode.NUMBER]: t`Set Pit Number`,\n        [LabelMode.ADDRESS]: t`Set Pit Address Group`,\n        [LabelMode.TEAM]: t`Set Pit Team`,\n        [LabelMode.COLOR]: \"\"\n    }\n    const PROMPTS = {\n        [LabelMode.NUMBER]: t`Set pit number:`,\n        [LabelMode.ADDRESS]: t`Set pit address:`,\n        [LabelMode.TEAM]: t`Set team:`,\n        [LabelMode.COLOR]: \"\"\n    }\n    let def = pits[0].label;\n    if (mode === LabelMode.TEAM) {\n        def = pits[0].team ? pits[0].team + \"\" : \"\";\n    } else if (mode === LabelMode.ADDRESS) {\n        if (this.cursor === Cursor.ASSIGN) {\n            def = pits[0].address;\n        } else if (this.cursor === Cursor.SINGLE) {\n            // Calculate next based on\n            const othersInGroup = this.getData().objects.filter(x => x.type === CellType.PIT && x.address?.startsWith(this.activeGroup));\n            if ((othersInGroup?.length ?? 0) === 0) {\n                this.assign(pits, mode, this.activeGroup + this.increment);\n                externalAssignmentUpdate(this.getData().objects);\n                return;\n            }\n            const highest = othersInGroup.map(x => ({v: parseInt(x.address?.substring(this.activeGroup.length) ?? \"\"), z: x.address?.charAt(this.activeGroup.length) === '0'} ?? false)).reduce((p, c) => c.v > p.v ? c : p);\n            const next = highest.v + this.increment;\n            const suffix = !next ? this.increment : (next < 10 && highest.z ? (\"0\" + next) : next);\n            this.assign(pits, mode, this.activeGroup + suffix);\n            externalAssignmentUpdate(this.getData().objects);\n            return;\n        }\n        // TODO have a way to specify prefix, whether to increment by 1 or two, force two digit, and then just click the pits and it assigns all to the active group in the order you do it\n    } else if (mode === LabelMode.COLOR) {\n        this.assign(pits, mode, colorRef.current);\n        return;\n    }\n    promptDialog({\n        label: LABELS[mode],\n        text: PROMPTS[mode],\n        defaultValue: def || '',\n        buttonText: 'OK'\n    }).then(val => {\n        if (val !== null) {\n            this.assign(pits, mode, val);\n            externalAssignmentUpdate(this.getData().objects);\n        }\n    })\n}\n\n/**\n * Returns the offset to shift the canvas to center it. returns 0 if the canvas is wider than its container.\n */\nfunction getOffsetX(zoom: number, bb: Rectangle) {\n    const containerWidth = document.getElementsByClassName('container')[0].clientWidth;\n    if (containerWidth > (bb.w * PitMap.BASE_CELL_SIZE * zoom)) { // center\n        return (containerWidth - (bb.w * PitMap.BASE_CELL_SIZE * zoom )) / 2;\n    } else {\n        return 0;\n    }\n}\n\nexport default function Editor ({initialData, eventCode, editMode, initialConfig, teams, displayTeamNumbers} : {\n    initialData: Cell[],\n    eventCode: string,\n    editMode: 'EDIT' | 'ASSIGN'\n    initialConfig: {\n        numbers: boolean,\n        addresses: boolean,\n        published: boolean\n    },\n    teams: TeamData[],\n    displayTeamNumbers?: Record<number, string>\n}) {\n    const pitMap = useRef<PitMap>();\n    const [view, setView] = useState(ViewType.EDIT);\n    const [cursor, setCursor] = useState(Cursor.POINTER);\n    const [cellType, setCellType] = useState(0);\n    const [pitLabelMode, setPitLabelMode] = useState(LabelMode.NUMBER);\n    const [zoom, zoomDispatch] = useReducer(zoomReducer, 1);\n    const [canvasOffsetX, setCanvasOffsetX] = useState(0);\n    const [showNumbers, setShowNumbers] = useState(initialConfig.numbers);\n    const [showAddresses, setShowAddresses] = useState(initialConfig.addresses);\n    const [published, setPublished] = useState(initialConfig.published);\n    const [color, setColor] = useState(DEFAULT_COLOR);\n    const colorRef = useRef<string>(color);\n    const [usedColors, setUsedColors] = useState([...new Set(initialData.filter(x => x.type === CellType.PIT).map(x => x.color ?? DEFAULT_COLOR))]);\n    const [increment, setIncrement] = useState(1);\n    const [group, setGroup] = useState('A');\n    const lastSaveData = useRef<Cell[] | undefined>(initialData);\n    const isCloud = window.FIRST_ENV.projectName == 'FTCCloud'\n    const saveUrl = editMode === 'EDIT' ? '' : (isCloud ? '../pit' : '../');\n    const minimalView = editMode === 'ASSIGN';\n\n    useEffect(() => {\n        pitMap.current = new PitMap({\n            id: 'pitMapCanvas',\n            textSelectCallback: (obj, resultCb) => {\n                promptDialog({\n                    label: t`Map Object Label` + (pitMap.current?.cursor === Cursor.TEXT_ROT ? t` (rotated)` : \"\"),\n                    text: t`Set label for selected object:`,\n                    defaultValue: obj.label || '',\n                    buttonText: 'OK'\n                }).then(x => resultCb(x))\n            },\n            minView: minimalView\n        });\n        if (editMode === 'EDIT') {\n            pitMap.current.setEditing(true);\n        } else if (editMode === 'ASSIGN') {\n            if(displayTeamNumbers) {\n                pitMap.current?.setDisplayTeamNumbers(displayTeamNumbers)\n            }\n            setCursor(Cursor.INSPECT);\n            pitMap.current.setAssigning(true);\n            pitMap.current.setAssignError(err => {\n                const msg = err.errType === PitMap.ERROR_ILLEGAL_NUMBER ? t`Pit number must be between 1 and ${err.max}. Invalid value: ${err.number}.` : t`Multiple pits with number ${err.number}. Please contact support.`\n                messageDialog({label: t`Assignment Error`, text: msg})\n            });\n            pitMap.current.setPitClickCallback((x) => {\n                const addr = x.address ? x.address : t`<em>Not Set</em>`;\n                const team = x.team ? x.team : t`<em>Not Set</em>`;\n                const color = x.color ? x.color : DEFAULT_COLOR;\n                messageDialog({\n                    text: t`Pit Number: ${x.label}<br/>Pit Address: ${addr}<br/>Assigned Team: ${team}<br>Color: <code>${color}</code>`,\n                    label: t`Pit Info`,\n                    dangerous: true\n                })\n            });\n            pitMap.current.setPitAssignCallback( (cells: Cell[], mode: LabelMode) => {\n                pitAssign.call(pitMap.current!, cells, mode, colorRef);\n                if (mode === LabelMode.COLOR) {\n                    const colors = pitMap.current?.getData().objects.filter(x => x.type === CellType.PIT).map(x => x.color ?? DEFAULT_COLOR);\n                    setUsedColors([...new Set(colors)])\n                }\n            });\n\n            // initial zoom to fit\n            const containerWidth = document.getElementsByClassName('container')[0].clientWidth;\n            let newZoom = 1;\n            const bb = pitMap.current.getBoundingBox();\n            while(containerWidth < (bb.w * PitMap.BASE_CELL_SIZE * newZoom) && newZoom > .25) newZoom -= .1;\n            newZoom = Math.max(.25, newZoom);\n            zoomDispatch({set: newZoom});\n        }\n        const checkForDirtyLeave = (e: BeforeUnloadEvent) => {\n            if (isEqual(pitMap.current?.getData().objects, lastSaveData.current)) {\n                return undefined;\n            }\n            const msg = t`Warning! Unsaved data will be lost.`; // msg content ignored, just needs to exist\n            e.preventDefault();\n            e.returnValue = msg;\n            return msg;\n        }\n        window.addEventListener(\"beforeunload\", checkForDirtyLeave);\n        pitMap.current.setData(JSON.parse(JSON.stringify(initialData)));\n        return () => {\n            window.removeEventListener('beforeunload', checkForDirtyLeave);\n            pitMap.current?.destroy()\n        }\n    }, []);\n    useEffect(() => pitMap.current?.setEditing(editMode === 'EDIT' && view === ViewType.EDIT), [view]);\n    useEffect(() => pitMap.current?.setCursor(cursor), [cursor]);\n    useEffect(() => {\n        pitMap.current?.setZoom(zoom)\n        if (editMode === 'ASSIGN' && pitMap.current) { // center it if no scroll bars\n            setCanvasOffsetX(getOffsetX(zoom, pitMap.current.getBoundingBox()));\n        }\n    }, [zoom]);\n    useEffect(() => pitMap.current?.setPitLabelMode(pitLabelMode), [pitLabelMode]);\n    useEffect(() => {\n        if (editMode !== 'ASSIGN') {\n            return;\n        }\n        const lab = t`Error`;\n        const txt = t`Error saving config`;\n        (async function () {\n            const res = await fetch(isCloud ? 'config' : '../config/', {\n                method: 'POST',\n                body: PermissiveURLSearchParams({\n                    numbers: showNumbers,\n                    addresses: showAddresses,\n                    published: published,\n                })\n            })\n            if (!res.ok) {\n                messageDialog({label: lab, text: txt})\n            }\n        })();\n    });\n    useEffect(() => {\n        colorRef.current = color;\n    }, [color]);\n    const setCellTypeCallback = (type : CellType) => {\n        setCellType(type);\n        pitMap.current?.setCellType(type);\n    }\n    const assignPits = (type : AutoAssignmentType) => {\n        pitMap.current?.autoAssignPits(type, teams.map(t => t.number));\n        externalAssignmentUpdate(pitMap.current?.getData().objects);\n    }\n    const setActiveGroupCallback = (prefix: string) => {\n        setGroup(prefix);\n        pitMap.current?.setActiveGroup(prefix);\n    }\n    const setIncrementCallback = (inc: number) => {\n        setIncrement(inc);\n        pitMap.current?.setIncrement(inc);\n    }\n    const bottom = editMode === 'EDIT' ? <>\n        <div className={\"alert alert-info\"}>\n            {t`Pit numbers/addresses can be edited during pit assignments. Maps do not need to be made to-scale.`}\n        </div>\n        <div className={\"row justify-content-center\"}>\n            <a className={\"btn btn-info\"} href={isCloud ? \"pit/assign\" : \"./assign/\"}>Pit Assignment & Addressing</a>\n        </div>\n    </> : <>\n        <div className={\"alert alert-info\"}>\n            {t`Pit Addressing is optional. Pit Number & Address can be hidden from teams using the checkboxes below.`}\n        </div>\n        <div className={\"settings d-flex\"}>\n            <div className={\"settingsObj\"}>\n                <label htmlFor={\"showPitNumber\"}>{t`Show Number:`}</label>\n                <input type=\"checkbox\" checked={showNumbers} id=\"showPitNumber\" onChange={(e) => setShowNumbers((e.target as HTMLInputElement).checked)}/>\n            </div>\n            <div className={\"settingsObj\"}>\n                <label htmlFor={\"showPitAddress\"}>{t`Show Address:`}</label>\n                <input type=\"checkbox\" checked={showAddresses}  id=\"showPitAddress\" onChange={(e) => setShowAddresses((e.target as HTMLInputElement).checked)}/>\n            </div>\n            <div className={\"settingsObj\"}>\n                <label htmlFor={\"publish\"}>{t`Published:`}</label>\n                <input type=\"checkbox\" checked={published}  id=\"publish\" onChange={(e) => setPublished((e.target as HTMLInputElement).checked)}/>\n            </div>\n        </div>\n    </>\n\n    let canvas = <canvas id={\"pitMapCanvas\"}/>;\n    if (editMode === 'ASSIGN') {\n        canvas = <div id={\"canvasWrapper\"} style={{width: '100%', overflowX: 'auto'}}>\n            <canvas id={\"pitMapCanvas\"} style={{position: 'relative', left: `${canvasOffsetX}px`}}/>\n        </div>\n    }\n\n    function postData(data: any, cellData: Cell[] | undefined) {\n        (async function () {\n            const res = await fetch(saveUrl, {\n                method: 'POST',\n                body: PermissiveURLSearchParams(data)\n            })\n            if (res.ok) {\n                if (cellData === undefined) {\n                    window.location.reload();\n                } else {\n                    lastSaveData.current = cellData;\n                }\n            } else {\n                messageDialog({label: t`Error`, text: t`Error saving pit map`})\n            }\n        })();\n    }\n\n    const setPitLabelModeCb = (mode: LabelMode) => {\n        setPitLabelMode(mode);\n        if (mode !== LabelMode.ADDRESS && cursor === Cursor.SINGLE) {\n            setCursor(Cursor.ASSIGN);\n        }\n    }\n    return <>\n        <Toolbar editMode={editMode} cursor={cursor} cellType={cellType} zoom={zoom} setCursor={setCursor} setCellType={setCellTypeCallback}\n                 zoomDispatch={zoomDispatch} undo={() => pitMap.current?.undo()} redo={() => pitMap.current?.redo()} shift={(x) => pitMap.current?.shift(x)}\n                 pitLabelMode={pitLabelMode} setPitLabelMode={setPitLabelModeCb} color={color} usedColors={usedColors} setColor={setColor}\n                 group={group} setGroup={setActiveGroupCallback} increment={increment} setIncrement={setIncrementCallback}\n        />\n        {canvas}\n        <EditorButtons editMode={editMode} setView={setView} exportFunc={() => {\n            const link = document.createElement(\"a\");\n            const data : any = pitMap.current?.getData();\n            data.objects = JSON.stringify(data.objects); // keep this element a string for the backend & DB.\n            link.href = `data:text/json;charset=utf-8,${PermissiveURLSearchParams(data)}`\n            link.download = `${eventCode}.pitmap`; // specify the filename\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n        }} importFunc={postData} clear={() => {\n            switch(editMode) {\n                case \"EDIT\": pitMap.current?.setData([]); break;\n                case \"ASSIGN\":\n                    pitMap.current?.autoAssignPits(AutoAssignmentType.CLEAR, []);\n                    externalAssignmentUpdate(pitMap.current?.getData().objects);\n                    break;\n            }\n        }} reset={() => {\n            pitMap.current?.setData(JSON.parse(JSON.stringify(initialData)));\n            if (editMode === 'ASSIGN') {\n                externalAssignmentUpdate(pitMap.current?.getData().objects);\n            }\n        }} save={() => {\n            const data : any = pitMap.current?.getData();\n            const cellData = pitMap.current?.getData().objects;\n            data.objects = JSON.stringify(data.objects); // keep this element a string for the backend & DB.\n            postData(data, cellData);\n        }} assign={assignPits}/>\n        {bottom}\n    </>\n}","import Editor from \"./Editor\";\nimport { createRoot } from \"react-dom/client\";\n\nconst root = createRoot(document.getElementById(\"pitMapContent\"));\nroot.render(<Editor initialData={initialData} eventCode={eventCode} editMode={editMode} initialConfig={initialConfig} teams={teams} displayTeamNumbers={window.displayTeamNumbers}/>);"],"names":["DEFAULT_COLOR","EditCursorGroup","cursor","setCursor","jsxs","jsx","t","Cursor","AssignCursorGroup","pitLabelMode","LabelMode","CellGroup","cellType","setCellType","enabled","noField","CellType","UndoGroup","undo","redo","ZoomGroup","zoom","zoomDispatch","ColorGroup","color","used","setColor","showPicker","setShowPicker","useState","BlockPicker","e","AddressGroupGroup","group","increment","setGroup","setIncrement","Form","ShiftGroup","shift","PitLabelGroup","setPitLabelMode","EditToolbar","AssignToolbar","usedColors","Toolbar","editMode","actions","zoomReducer","current","op","EditorButtons","setView","exportFunc","importFunc","clear","reset","save","assign","AutoAssignmentType","Button","fileUploadDialog","data","fileReader","status","Fragment","externalAssignmentUpdate","objects","pitAssign","pits","mode","colorRef","LABELS","PROMPTS","def","othersInGroup","x","_a","highest","_b","p","c","next","suffix","promptDialog","val","getOffsetX","bb","containerWidth","PitMap","Editor","initialData","eventCode","initialConfig","teams","displayTeamNumbers","pitMap","useRef","view","useReducer","canvasOffsetX","setCanvasOffsetX","showNumbers","setShowNumbers","showAddresses","setShowAddresses","published","setPublished","setUsedColors","lastSaveData","isCloud","saveUrl","minimalView","useEffect","obj","resultCb","err","msg","messageDialog","addr","team","cells","colors","newZoom","checkForDirtyLeave","isEqual","lab","txt","PermissiveURLSearchParams","setCellTypeCallback","type","assignPits","setActiveGroupCallback","prefix","setIncrementCallback","inc","bottom","canvas","postData","cellData","setPitLabelModeCb","link","_c","root","createRoot"],"mappings":"upCAaA,MAAMA,EAAgB,UAOtB,SAASC,GAAgB,CAAC,OAAAC,EAAQ,UAAAC,GAG/B,CACQ,OAAAC,EAAA,KAAC,MAAI,CAAA,UAAW,eACnB,SAAA,CAAAC,EAAA,IAAC,QAAM,SAAWC,UAAA,CAAA,EAClBD,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,QAAU,cAAgB,qBAAqB,GAAI,MAAOD,uBAAwB,QAAS,IAAMH,EAAUI,EAAO,OAAO,EAAG,SAACF,EAAA,IAAA,IAAA,CAAE,UAAU,qBAAA,CAAsB,CAAI,CAAA,EAC/MA,EAAA,IAAC,SAAO,CAAA,UAAW,OAAOH,IAAWK,EAAO,OAAS,cAAgB,qBAAqB,GAAI,MAAOD,gBAAiB,QAAS,IAAMH,EAAUI,EAAO,MAAM,EAAG,SAACF,EAAAA,IAAA,IAAA,CAAE,UAAU,4BAA4B,SAACA,EAAAA,IAAA,MAAA,CAAI,SAAC,GAAA,CAAA,CAAM,CAAA,EAAI,EACxNA,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,KAAO,cAAgB,qBAAqB,GAAI,MAAOD,aAAc,QAAS,IAAMH,EAAUI,EAAO,IAAI,EAAG,SAACF,EAAA,IAAA,IAAA,CAAE,UAAU,kBAAA,CAAmB,CAAI,CAAA,EAC5LA,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,KAAO,cAAgB,qBAAqB,GAAI,MAAOD,sBAAuB,QAAS,IAAMH,EAAUI,EAAO,IAAI,EAAG,SAACF,EAAA,IAAA,IAAA,CAAE,UAAU,kBAAA,CAAmB,CAAI,CAAA,EACrMA,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,KAAO,cAAgB,qBAAqB,GAAI,MAAOD,SAAU,QAAS,IAAMH,EAAUI,EAAO,IAAI,EAAG,SAACF,EAAA,IAAA,IAAA,CAAE,UAAU,gBAAA,CAAiB,CAAI,CAAA,EACtLA,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,SAAW,cAAgB,qBAAqB,GAAI,MAAOD,eAAgB,QAAS,IAAMH,EAAUI,EAAO,QAAQ,EAAG,SAACF,EAAA,IAAA,IAAA,CAAE,UAAU,6BAAA,CAA8B,CAAI,CAAA,EACjNA,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,OAAS,aAAe,oBAAoB,GAAI,MAAOD,UAAW,QAAS,IAAMH,EAAUI,EAAO,MAAM,EAAG,SAACF,EAAAA,IAAA,IAAA,CAAE,UAAU,aAAc,CAAA,CAAI,CAAA,CAAA,EAC1L,CACJ,CAEA,SAASG,GAAkB,CAAC,OAAAN,EAAQ,UAAAC,EAAW,aAAAM,GAI5C,CACQ,OAAAL,EAAA,KAAC,MAAI,CAAA,UAAW,eACnB,SAAA,CAAAC,EAAA,IAAC,QAAM,SAAWC,UAAA,CAAA,EAClBD,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,OAAS,cAAgB,qBAAqB,GAAI,MAAOD,mBAAoB,QAAS,IAAMH,EAAUI,EAAO,MAAM,EAAG,SAACF,EAAA,IAAA,IAAA,CAAE,UAAU,qBAAA,CAAsB,CAAI,CAAA,EACxMI,IAAiBC,EAAU,QAAUL,EAAAA,IAAC,SAAO,CAAA,UAAW,OAAOH,IAAWK,EAAO,OAAS,cAAgB,qBAAqB,GAAI,MAAOD,gBAAiB,QAAS,IAAMH,EAAUI,EAAO,MAAM,EAAG,SAACF,MAAA,IAAA,CAAE,UAAU,4BAA4B,SAACA,EAAA,IAAA,MAAA,CAAI,SAAC,GAAA,CAAA,CAAM,CAAA,CAAI,CAAA,EAAY,KACzQI,IAAiBC,EAAU,OAAUL,EAAA,IAAA,SAAA,CAAO,UAAW,OAAOH,IAAWK,EAAO,MAAQ,cAAgB,qBAAqB,GAAI,MAAOD,UAAW,QAAS,IAAMH,EAAUI,EAAO,KAAK,EAAG,SAAAF,EAAAA,IAAC,IAAE,CAAA,UAAU,mBAAoB,CAAA,CAAA,CAAI,EAAY,KAC7OA,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,QAAU,cAAgB,qBAAqB,GAAI,MAAOD,YAAa,QAAS,IAAMH,EAAUI,EAAO,OAAO,EAAG,SAACF,EAAAA,IAAA,IAAA,CAAE,UAAU,mBAAoB,CAAA,CAAI,CAAA,CAAA,EACtM,CACJ,CAEA,SAASM,GAAU,CAAC,OAAAT,EAAQ,SAAAU,EAAU,YAAAC,GAInC,CACC,MAAMC,EAAUZ,IAAWK,EAAO,QAAUL,IAAWK,EAAO,KACxDQ,EAAUb,IAAWK,EAAO,KAC3B,OAAAH,EAAA,KAAC,MAAI,CAAA,UAAW,eACnB,SAAA,CAAAC,EAAA,IAAC,QAAM,SAAcC,aAAA,CAAA,EACrBD,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,QAAUK,IAAaI,EAAS,KAAO,cAAgB,qBAAqB,GAAI,SAAU,CAACF,EAAS,QAAS,IAAMD,EAAYG,EAAS,IAAI,EAAI,SAAQV,OAAA,CAAA,EACpMD,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,QAAUK,IAAaI,EAAS,SAAW,cAAgB,qBAAqB,GAAI,SAAU,CAACF,EAAS,QAAS,IAAMD,EAAYG,EAAS,QAAQ,EAAI,SAAYV,WAAA,CAAA,EAChND,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,QAAUK,IAAaI,EAAS,IAAM,cAAgB,qBAAqB,GAAI,SAAU,CAACF,EAAS,QAAS,IAAMD,EAAYG,EAAS,GAAG,EAAI,SAAOV,MAAA,CAAA,EACjMD,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,QAAUK,IAAaI,EAAS,MAAQ,cAAgB,qBAAqB,GAAI,SAAU,CAACF,GAAWC,EAAS,QAAS,IAAMF,EAAYG,EAAS,KAAK,EAAI,SAASV,QAAA,CAAA,EAClND,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,QAAUK,IAAaI,EAAS,UAAY,cAAgB,qBAAqB,GAAI,SAAU,CAACF,GAAWC,EAAS,QAAS,IAAMF,EAAYG,EAAS,SAAS,EAAI,SAAmBV,kBAAA,CAAA,EACpOD,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,QAAUK,IAAaI,EAAS,OAAS,cAAgB,qBAAqB,GAAI,SAAU,CAACF,EAAS,QAAS,IAAMD,EAAYG,EAAS,MAAM,EAAI,SAAUV,SAAA,CAAA,EAC1MD,EAAAA,IAAC,UAAO,UAAW,OAAOH,IAAWK,EAAO,QAAUK,IAAaI,EAAS,MAAQ,cAAgB,qBAAqB,GAAI,SAAU,CAACF,EAAS,QAAS,IAAMD,EAAYG,EAAS,KAAK,EAAI,SAASV,QAAA,CAAA,CAAA,EAC3M,CACJ,CAEA,SAASW,GAAU,CAAC,KAAAC,EAAM,KAAAC,GAGxB,CACS,OAAAf,EAAA,KAAC,MAAI,CAAA,UAAW,eACnB,SAAA,CAAAC,EAAA,IAAC,QAAM,SAASC,QAAA,CAAA,EACfD,EAAA,IAAA,SAAA,CAAO,UAAW,0BAA2B,QAAS,IAAMa,EAAK,EAAG,SAACb,EAAA,IAAA,IAAA,CAAE,UAAU,YAAa,CAAA,EAAI,EAClGA,EAAA,IAAA,SAAA,CAAO,UAAW,0BAA2B,QAAS,IAAMc,EAAK,EAAG,SAACd,EAAAA,IAAA,IAAA,CAAE,UAAU,cAAA,CAAe,CAAI,CAAA,CAAA,EACzG,CACJ,CAEA,SAASe,EAAU,CAAC,KAAAC,EAAM,aAAAC,GAGvB,CACQ,OAAAlB,EAAA,KAAC,MAAI,CAAA,UAAW,eACnB,SAAA,CAAAA,OAAC,OAAM,CAAA,SAAA,CAAAE,UAAWe,EAAO,KAAK,QAAQ,CAAC,EAAI,GAAA,EAAI,EAC9ChB,EAAA,IAAA,SAAA,CAAO,UAAW,0BAA2B,QAAS,IAAMiB,EAAa,KAAK,EAAG,SAAAjB,EAAAA,IAAC,IAAE,CAAA,UAAU,oBAAqB,CAAA,EAAI,EACvHA,EAAA,IAAA,SAAA,CAAO,UAAW,0BAA2B,QAAS,IAAMiB,EAAa,IAAI,EAAG,SAAAjB,MAAC,IAAE,CAAA,UAAU,oBAAoB,CAAI,CAAA,CAAA,EAC1H,CACJ,CAEA,SAASkB,GAAW,CAAC,MAAAC,EAAO,KAAAC,EAAM,SAAAC,GAI/B,CACC,KAAM,CAACC,EAAYC,CAAa,EAAIC,EAAAA,SAAS,EAAK,EAC3C,OAAAzB,EAAA,KAAC,MAAI,CAAA,UAAW,eACnB,SAAA,CAAAC,MAAC,UAAO,UAAU,gCAAgC,QAAS,IAAMuB,EAAc,CAACD,CAAU,EAAG,MAAO,CAAC,SAAU,WAAY,IAAK,UAAY,SAAAA,EAAa,cAAgB,aAAa,EACtLtB,EAAAA,IAAC,OAAI,UAAU,OAAO,QAAS,IAAMuB,EAAc,EAAI,EAAG,MAAO,CAAC,QAAS,eAAgB,MAAO,MAAO,OAAQ,MAAO,WAAYJ,EAAO,SAAU,WAAY,IAAK,QAAU,CAAA,CAAA,EAC9KG,EAAcvB,EAAAA,KAAA,MAAA,CAAI,MAAO,CAAE,SAAU,WAAY,OAAQ,CAAK,EAAA,UAAW,cACvE,SAAA,CAAAC,EAAA,IAAC,MAAI,CAAA,MAAO,CAAE,SAAU,QAAS,MAAO,EAAG,IAAK,QAAA,EAAY,QAAS,IAAMuB,EAAc,EAAK,EAAE,EAC/FvB,EAAAA,IAAAyB,GAAA,CAAY,OAAQL,EAAM,MAAAD,EAAc,SAAS,OAAO,iBAAmBO,GAAML,EAASK,EAAE,GAAG,CAAE,CAAA,CAAA,CAAA,CACtG,EAAS,IAAA,EACb,CACJ,CAEA,SAASC,GAAkB,CAAC,MAAAC,EAAO,UAAAC,EAAW,SAAAC,EAAU,aAAAC,GAKrD,CACQ,OAAAhC,EAAA,KAAC,MAAI,CAAA,UAAW,eACnB,SAAA,CAAAC,EAAAA,IAAC,QAAK,SAAO,SAAA,CAAA,QACZgC,EAAK,QAAL,CAAa,MAAOJ,EAAO,MAAO,CAAC,MAAO,MAAO,QAAS,gBAAiB,SAAUF,GAAKI,EAASJ,EAAE,OAAO,KAAK,EAAG,EAErH1B,EAAAA,IAAC,QAAK,SAAU,YAAA,CAAA,EAChBA,MAACgC,EAAK,QAAL,CAAa,KAAM,SAAU,MAAOH,EAAW,MAAO,CAAC,MAAO,MAAO,QAAS,cAAiB,EAAA,SAAeH,GAAAK,EAAa,SAASL,EAAE,OAAO,KAAK,CAAC,CAAG,CAAA,CAAA,EAC3J,CACJ,CAEA,SAASO,GAAW,CAAC,MAAAC,GAElB,CACQ,OAAAnC,EAAA,KAAC,MAAI,CAAA,UAAW,eACnB,SAAA,CAAAC,EAAA,IAAC,QAAM,SAAiBC,gBAAA,CAAA,EACvBD,EAAA,IAAA,SAAA,CAAO,UAAW,0BAA2B,QAAS,IAAMkC,EAAM,IAAI,EAAG,SAAAlC,EAAAA,IAAC,IAAE,CAAA,UAAU,gBAAiB,CAAA,EAAI,EAC3GA,EAAA,IAAA,SAAA,CAAO,UAAW,0BAA2B,QAAS,IAAMkC,EAAM,MAAM,EAAG,SAAAlC,EAAAA,IAAC,IAAE,CAAA,UAAU,kBAAmB,CAAA,EAAI,EAC/GA,EAAA,IAAA,SAAA,CAAO,UAAW,0BAA2B,QAAS,IAAMkC,EAAM,MAAM,EAAG,SAAAlC,EAAAA,IAAC,IAAE,CAAA,UAAU,kBAAmB,CAAA,EAAI,EAC/GA,EAAA,IAAA,SAAA,CAAO,UAAW,0BAA2B,QAAS,IAAMkC,EAAM,OAAO,EAAG,SAAAlC,MAAC,IAAE,CAAA,UAAU,oBAAoB,CAAI,CAAA,CAAA,EACtH,CACJ,CAEA,SAASmC,GAAc,CAAC,aAAA/B,EAAc,gBAAAgC,GAGnC,CACQ,OAAArC,EAAA,KAAC,MAAI,CAAA,UAAW,eACnB,SAAA,CAAAC,EAAA,IAAC,QAAM,SAAcC,aAAA,CAAA,QACpB,SAAO,CAAA,UAAW,OAAOG,IAAiBC,EAAU,OAAS,cAAgB,qBAAqB,GAAI,QAAS,IAAM+B,EAAgB/B,EAAU,MAAM,EAAI,SAAUJ,UAAA,QACnK,SAAO,CAAA,UAAW,OAAOG,IAAiBC,EAAU,QAAU,cAAgB,qBAAqB,GAAI,QAAS,IAAM+B,EAAgB/B,EAAU,OAAO,EAAI,SAAWJ,WAAA,QACtK,SAAO,CAAA,UAAW,OAAOG,IAAiBC,EAAU,KAAO,cAAgB,qBAAqB,GAAI,QAAS,IAAM+B,EAAgB/B,EAAU,IAAI,EAAI,SAAQJ,QAAA,QAC7J,SAAO,CAAA,UAAW,OAAOG,IAAiBC,EAAU,MAAQ,cAAgB,qBAAqB,GAAI,QAAS,IAAM+B,EAAgB/B,EAAU,KAAK,EAAI,SAASJ,QAAA,CAAA,CAAA,EACrK,CACJ,CAEA,SAASoC,GAAY,CAAC,OAAAxC,EAAQ,SAAAU,EAAU,KAAAS,EAAM,UAAAlB,EAAW,YAAAU,EAAa,aAAAS,EAAc,KAAAJ,EAAM,KAAAC,EAAM,MAAAoB,CAAA,EAU7F,CACQ,OAAAnC,EAAA,KAAC,MAAI,CAAA,UAAW,2BACnB,SAAA,CAACC,EAAAA,IAAAJ,GAAA,CAAgB,OAAAC,EAAgB,UAAAC,CAAqB,CAAA,EACrDE,EAAAA,IAAAM,GAAA,CAAU,OAAAT,EAAgB,SAAAU,EAAoB,YAAAC,CAAyB,CAAA,EACxER,EAAAA,IAACY,GAAU,CAAA,KAAAC,EAAY,KAAAC,CAAW,CAAA,EAClCd,MAACiC,IAAW,MAAAC,EAAa,EACzBlC,EAAAA,IAACe,EAAU,CAAA,KAAAC,EAAY,aAAAC,CAA2B,CAAA,CAAA,EACtD,CACJ,CAEA,SAASqB,GAAc,CAAC,OAAAzC,EAAQ,KAAAmB,EAAM,aAAAZ,EAAc,UAAAN,EAAW,aAAAmB,EAAc,gBAAAmB,EAAiB,MAAAjB,EAAO,WAAAoB,EAAY,SAAAlB,EAAU,MAAAO,EAAO,SAAAE,EAAU,UAAAD,EAAW,aAAAE,GAcpJ,CACQ,OAAAhC,EAAA,KAAC,MAAI,CAAA,UAAW,2BACnB,SAAA,CAACC,EAAAA,IAAAG,GAAA,CAAkB,OAAAN,EAAgB,UAAAC,EAAsB,aAAAM,CAA2B,CAAA,EACpFJ,EAAAA,IAACmC,GAAc,CAAA,aAAA/B,EAA4B,gBAAAgC,CAAiC,CAAA,EAC5EpC,EAAAA,IAACe,EAAU,CAAA,KAAAC,EAAY,aAAAC,CAA2B,CAAA,EACjDb,IAAiBC,EAAU,MAAQL,EAAAA,IAACkB,IAAW,MAAAC,EAAc,KAAMoB,EAAY,SAAAlB,CAAA,CAAmB,EAAK,KACvGjB,IAAiBC,EAAU,SAAWR,GAAUK,EAAO,OAAUF,EAAAA,IAAA2B,GAAA,CAAkB,MAAAC,EAAc,SAAAE,EAAoB,UAAAD,EAAsB,aAAAE,CAA2B,CAAA,EAAK,IAAA,EAChL,CACJ,CAEA,SAASS,GAAQ,CAAC,SAAAC,EAAU,GAAGC,GAoB5B,CACQ,OAAAD,IAAa,OAASzC,EAAA,IAACqC,GAAa,CAAA,GAAGK,CAAQ,CAAA,EAAK1C,EAAAA,IAACsC,GAAe,CAAA,GAAGI,CAAQ,CAAA,CAC1F,CAEA,SAASC,GAAaC,EAAkBC,EAAgD,CAChF,GAAA,CAACA,GAAM,CAACD,EACD,MAAA,GAEP,GAAA,OAAOC,GAAO,SACd,OAAOA,EAAG,IAEd,OAAQA,EAAI,CACR,IAAK,QAAgB,MAAA,GACrB,IAAK,KAAM,OAAOD,EAAU,EAAIA,EAAU,GAAKA,EAAU,IACzD,IAAK,MAAc,OAAAA,GAAW,EAAI,KAAK,IAAIA,EAAU,GAAI,GAAG,EAAIA,EAAU,GAAA,CAElF,CAEA,SAASE,GAAc,CAAC,SAAAL,EAAU,QAAAM,EAAS,WAAAC,EAAY,WAAAC,EAAY,MAAAC,EAAO,MAAAC,EAAO,KAAAC,EAAM,OAAAC,GASpF,CACQ,OAAAtD,EAAA,KAAC,MAAI,CAAA,UAAW,sCACnB,SAAA,CAAAC,MAAC,QAAK,MAAO,CAAC,YAAa,QAAS,SAAyB,qBAAA,EAC5DA,MAAA,SAAA,CAAO,GAAG,oBAAoB,UAAU,oCAAoC,cAAY,WAAW,gBAAc,OAAO,gBAAc,QAAQ,OAAQyC,IAAa,SAC/J,SACLxC,oBAAA,EACCF,EAAA,KAAA,MAAA,CAAI,UAAU,gBAAgB,kBAAgB,oBAC3C,SAAA,CAACC,EAAAA,IAAA,SAAA,CAAO,UAAU,gBAAgB,QAAS,IAAMqD,EAAOC,EAAmB,SAAS,EAAI,SAAwBrD,uBAAA,CAAA,EAChHD,EAAAA,IAAC,SAAO,CAAA,UAAU,gBAAgB,QAAS,IAAMqD,EAAOC,EAAmB,UAAU,EAAI,SAA0BrD,yBAAA,CAAA,EACnHD,EAAAA,IAAC,SAAO,CAAA,UAAU,gBAAgB,QAAS,IAAMqD,EAAOC,EAAmB,MAAM,EAAI,SAAUrD,SAAA,CAAA,CAAA,EACnG,QACC,SAAO,CAAA,UAAW,oBAAqB,QAAS+C,EAAa,SAAU/C,SAAA,CAAA,EACxED,EAAAA,IAACuD,GAAO,CAAA,KAAK,KAAK,UAAW,OAAQ,QAAS,oBAAqB,QAAS,IAAMC,GAAiB,CAC/F,MAAOvD,UACP,KAAMA,6DACN,WAAYA,UACZ,WAAawD,GAAS,CAClB,GAAIA,IAAS,OACT,OAEA,IAAAC,EAAa,IAAI,WACVA,EAAA,UAAaC,GAAW,CACpBV,EAAAS,EAAW,OAAQ,MAAS,CAC3C,EACWA,EAAA,WAAWD,GAAA,YAAAA,EAAM,IAAI,CACpC,EACA,SAAU,GACV,OAAQ,CACJ,MAAO,UACP,MAAOxD,6BAAA,CACX,CACH,EAAG,SAAM,SAAA,EACVD,EAAAA,IAAC,MAAI,CAAA,UAAW,IAAM,CAAA,QACrB,SAAO,CAAA,UAAW,iBAAkB,QAASkD,EAAQ,SAASjD,QAAA,CAAA,QAC9D,SAAO,CAAA,UAAW,kBAAmB,QAASkD,EAAQ,SAASlD,QAAA,CAAA,EAC/DwC,IAAa,OACV1C,EAAAA,KAAA6D,EAAA,SAAA,CAAA,SAAA,CAAC5D,EAAAA,IAAA,SAAA,CAAO,UAAW,oBAAqB,QAAS,IAAM+C,EAAQ,CAAA,EAAiB,SAAQ9C,OAAA,CAAA,EACxFD,EAAAA,IAAC,UAAO,UAAW,4BAA6B,QAAS,IAAM+C,EAAQ,CAAgB,EAAI,SAAW9C,UAAA,CAAA,CAAA,CAAA,CAC1G,EAAM,WACL,SAAO,CAAA,UAAW,kBAAmB,QAASmD,EAAO,SAAQnD,OAAA,CAAA,CAAA,EAClE,CACJ,CAEA,SAAS4D,EAAyBC,EAAc,CAExC,OAAO,wBAA+B,OAAA,uBAAuBA,CAAO,CAC5E,CAEA,SAASC,GAAwBC,EAAeC,EAAkBC,EAA6B,CAC3F,MAAMC,EAAS,CACX,CAAC9D,EAAU,MAAM,EAAGJ,kBACpB,CAACI,EAAU,OAAO,EAAGJ,yBACrB,CAACI,EAAU,IAAI,EAAGJ,gBAClB,CAACI,EAAU,KAAK,EAAG,EACvB,EACM+D,EAAU,CACZ,CAAC/D,EAAU,MAAM,EAAGJ,mBACpB,CAACI,EAAU,OAAO,EAAGJ,oBACrB,CAACI,EAAU,IAAI,EAAGJ,aAClB,CAACI,EAAU,KAAK,EAAG,EACvB,EACI,IAAAgE,EAAML,EAAK,CAAC,EAAE,MACd,GAAAC,IAAS5D,EAAU,KACbgE,EAAAL,EAAK,CAAC,EAAE,KAAOA,EAAK,CAAC,EAAE,KAAO,GAAK,WAClCC,IAAS5D,EAAU,SACtB,GAAA,KAAK,SAAWH,EAAO,OACjBmE,EAAAL,EAAK,CAAC,EAAE,gBACP,KAAK,SAAW9D,EAAO,OAAQ,CAEtC,MAAMoE,EAAgB,KAAK,QAAA,EAAU,QAAQ,OAAYC,GAAA,OAAA,OAAAA,EAAE,OAAS5D,EAAS,OAAO6D,EAAAD,EAAE,UAAF,YAAAC,EAAW,WAAW,KAAK,cAAY,EACtH,KAAAF,GAAA,YAAAA,EAAe,SAAU,KAAO,EAAG,CACpC,KAAK,OAAON,EAAMC,EAAM,KAAK,YAAc,KAAK,SAAS,EAChCJ,EAAA,KAAK,QAAQ,EAAE,OAAO,EAC/C,MAAA,CAEJ,MAAMY,EAAUH,EAAc,IAAUC,GAAA,SAAA,OAAC,EAAG,WAASC,EAAAD,EAAE,UAAF,YAAAC,EAAW,UAAU,KAAK,YAAY,UAAW,EAAE,EAAG,IAAGE,EAAAH,EAAE,UAAF,YAAAG,EAAW,OAAO,KAAK,YAAY,WAAY,KAAc,EAAE,OAAO,CAACC,EAAGC,IAAMA,EAAE,EAAID,EAAE,EAAIC,EAAID,CAAC,EACzME,EAAOJ,EAAQ,EAAI,KAAK,UACxBK,EAAUD,EAAyBA,EAAO,IAAMJ,EAAQ,EAAK,IAAMI,EAAQA,EAA1D,KAAK,UAC5B,KAAK,OAAOb,EAAMC,EAAM,KAAK,YAAca,CAAM,EACxBjB,EAAA,KAAK,QAAQ,EAAE,OAAO,EAC/C,MAAA,UAGGI,IAAS5D,EAAU,MAAO,CACjC,KAAK,OAAO2D,EAAMC,EAAMC,EAAS,OAAO,EACxC,MAAA,CAESa,EAAA,CACT,MAAOZ,EAAOF,CAAI,EAClB,KAAMG,EAAQH,CAAI,EAClB,aAAcI,GAAO,GACrB,WAAY,IAAA,CACf,EAAE,KAAYW,GAAA,CACPA,IAAQ,OACH,KAAA,OAAOhB,EAAMC,EAAMe,CAAG,EACFnB,EAAA,KAAK,QAAQ,EAAE,OAAO,EACnD,CACH,CACL,CAKA,SAASoB,GAAWjE,EAAckE,EAAe,CAC7C,MAAMC,EAAiB,SAAS,uBAAuB,WAAW,EAAE,CAAC,EAAE,YACvE,OAAIA,EAAkBD,EAAG,EAAIE,EAAO,eAAiBpE,GACzCmE,EAAkBD,EAAG,EAAIE,EAAO,eAAiBpE,GAAU,EAE5D,CAEf,CAEwB,SAAAqE,GAAQ,CAAC,YAAAC,EAAa,UAAAC,EAAW,SAAA9C,EAAU,cAAA+C,EAAe,MAAAC,EAAO,mBAAAC,GAWtF,CACC,MAAMC,EAASC,EAAAA,OAAe,EACxB,CAACC,EAAM9C,CAAO,EAAIvB,EAAAA,SAAS,CAAa,EACxC,CAAC3B,EAAQC,CAAS,EAAI0B,EAAAA,SAAStB,EAAO,OAAO,EAC7C,CAACK,EAAUC,CAAW,EAAIgB,EAAAA,SAAS,CAAC,EACpC,CAACpB,EAAcgC,CAAe,EAAIZ,EAAAA,SAASnB,EAAU,MAAM,EAC3D,CAACW,EAAMC,CAAY,EAAI6E,EAAAA,WAAWnD,GAAa,CAAC,EAChD,CAACoD,EAAeC,CAAgB,EAAIxE,EAAAA,SAAS,CAAC,EAC9C,CAACyE,EAAaC,CAAc,EAAI1E,EAAAA,SAASgE,EAAc,OAAO,EAC9D,CAACW,EAAeC,EAAgB,EAAI5E,EAAAA,SAASgE,EAAc,SAAS,EACpE,CAACa,EAAWC,EAAY,EAAI9E,EAAAA,SAASgE,EAAc,SAAS,EAC5D,CAACrE,EAAOE,EAAQ,EAAIG,EAAAA,SAAS7B,CAAa,EAC1CuE,EAAW0B,SAAezE,CAAK,EAC/B,CAACoB,GAAYgE,EAAa,EAAI/E,EAAA,SAAS,CAAC,GAAG,IAAI,IAAI8D,EAAY,OAAOf,GAAKA,EAAE,OAAS5D,EAAS,GAAG,EAAE,IAAI4D,GAAKA,EAAE,OAAS5E,CAAa,CAAC,CAAC,CAAC,EACxI,CAACkC,GAAWE,EAAY,EAAIP,EAAAA,SAAS,CAAC,EACtC,CAACI,GAAOE,EAAQ,EAAIN,EAAAA,SAAS,GAAG,EAChCgF,EAAeZ,SAA2BN,CAAW,EACrDmB,EAAU,OAAO,UAAU,aAAe,WAC1CC,GAAUjE,IAAa,OAAS,GAAMgE,EAAU,SAAW,MAC3DE,GAAclE,IAAa,SAEjCmE,EAAAA,UAAU,IAAM,OAaZ,GAZOjB,EAAA,QAAU,IAAIP,EAAO,CACxB,GAAI,eACJ,mBAAoB,CAACyB,EAAKC,IAAa,OACtB/B,EAAA,CACT,MAAO9E,uBAAuBuE,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,UAAWtE,EAAO,SAAWD,cAAgB,IAC3F,KAAMA,kCACN,aAAc4G,EAAI,OAAS,GAC3B,WAAY,IACf,CAAA,EAAE,KAAUtC,GAAAuC,EAASvC,CAAC,CAAC,CAC5B,EACA,QAASoC,EAAA,CACZ,EACGlE,IAAa,OACNkD,EAAA,QAAQ,WAAW,EAAI,UACvBlD,IAAa,SAAU,CAC3BiD,KACQlB,EAAAmB,EAAA,UAAA,MAAAnB,EAAS,sBAAsBkB,IAE1C5F,EAAUI,EAAO,OAAO,EACjByF,EAAA,QAAQ,aAAa,EAAI,EACzBA,EAAA,QAAQ,eAAsBoB,GAAA,CACjC,MAAMC,EAAMD,EAAI,UAAY3B,EAAO,qBAAuBnF,qCAAqC8G,EAAI,GAAG,oBAAoBA,EAAI,MAAM,IAAM9G,8BAA8B8G,EAAI,MAAM,4BAClLE,EAAc,CAAC,MAAOhH,oBAAqB,KAAM+G,EAAI,CAAA,CACxD,EACMrB,EAAA,QAAQ,oBAAqBpB,GAAM,CACtC,MAAM2C,EAAO3C,EAAE,QAAUA,EAAE,QAAUtE,oBAC/BkH,EAAO5C,EAAE,KAAOA,EAAE,KAAOtE,oBACzBkB,EAAQoD,EAAE,MAAQA,EAAE,MAAQ5E,EACpBsH,EAAA,CACV,KAAMhH,gBAAgBsE,EAAE,KAAK,qBAAqB2C,CAAI,uBAAuBC,CAAI,oBAAoBhG,CAAK,UAC1G,MAAOlB,YACP,UAAW,EAAA,CACd,CAAA,CACJ,EACD0F,EAAO,QAAQ,qBAAsB,CAACyB,EAAenD,IAAoB,OAEjE,GADJF,GAAU,KAAK4B,EAAO,QAAUyB,EAAOnD,EAAMC,CAAQ,EACjDD,IAAS5D,EAAU,MAAO,CAC1B,MAAMgH,GAAS7C,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,UAAU,QAAQ,OAAOD,GAAKA,EAAE,OAAS5D,EAAS,KAAK,IAAS4D,GAAAA,EAAE,OAAS5E,GAC1G4G,GAAc,CAAC,GAAG,IAAI,IAAIc,CAAM,CAAC,CAAC,CAAA,CACtC,CACH,EAGD,MAAMlC,EAAiB,SAAS,uBAAuB,WAAW,EAAE,CAAC,EAAE,YACvE,IAAImC,EAAU,EACR,MAAApC,EAAKS,EAAO,QAAQ,eAAe,EACnC,KAAAR,EAAkBD,EAAG,EAAIE,EAAO,eAAiBkC,GAAYA,EAAU,KAAgBA,GAAA,GACnFA,EAAA,KAAK,IAAI,IAAKA,CAAO,EAClBrG,EAAA,CAAC,IAAKqG,EAAQ,CAAA,CAEzB,MAAAC,EAAsB7F,GAAyB,OAC7C,GAAA8F,GAAA,SAAQhD,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,UAAU,QAASgC,EAAa,OAAO,EACxD,OAEX,MAAMQ,EAAM/G,uCACZ,OAAAyB,EAAE,eAAe,EACjBA,EAAE,YAAcsF,EACTA,CACX,EACO,cAAA,iBAAiB,eAAgBO,CAAkB,EACnD5B,EAAA,QAAQ,QAAQ,KAAK,MAAM,KAAK,UAAUL,CAAW,CAAC,CAAC,EACvD,IAAM,OACF,OAAA,oBAAoB,eAAgBiC,CAAkB,GAC7D/C,EAAAmB,EAAO,UAAP,MAAAnB,EAAgB,SACpB,CACJ,EAAG,EAAE,EACKoC,EAAAA,UAAA,IAAM,OAAA,OAAApC,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,WAAW/B,IAAa,QAAUoD,IAAS,IAAgB,CAACA,CAAI,CAAC,EACvFe,EAAA,UAAA,IAAM,OAAA,OAAApC,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,UAAU3E,IAAS,CAACA,CAAM,CAAC,EAC3D+G,EAAAA,UAAU,IAAM,QACLpC,EAAAmB,EAAA,UAAA,MAAAnB,EAAS,QAAQxD,GACpByB,IAAa,UAAYkD,EAAO,SAChCK,EAAiBf,GAAWjE,EAAM2E,EAAO,QAAQ,eAAA,CAAgB,CAAC,CACtE,EACD,CAAC3E,CAAI,CAAC,EACC4F,EAAA,UAAA,IAAM,OAAA,OAAApC,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,gBAAgBpE,IAAe,CAACA,CAAY,CAAC,EAC7EwG,EAAAA,UAAU,IAAM,CACZ,GAAInE,IAAa,SACb,OAEJ,MAAMgF,EAAMxH,SACNyH,EAAMzH,wBACX,gBAAkB,EACH,MAAM,MAAMwG,EAAU,SAAW,aAAc,CACvD,OAAQ,OACR,KAAMkB,EAA0B,CAC5B,QAAS1B,EACT,UAAWE,EACX,UAAAE,CACH,CAAA,CAAA,CACJ,GACQ,IACLY,EAAc,CAAC,MAAOQ,EAAK,KAAMC,EAAI,CACzC,GACD,CAAA,CACN,EACDd,EAAAA,UAAU,IAAM,CACZ1C,EAAS,QAAU/C,CAAA,EACpB,CAACA,CAAK,CAAC,EACJ,MAAAyG,GAAuBC,GAAoB,OAC7CrH,EAAYqH,CAAI,GACTrD,EAAAmB,EAAA,UAAA,MAAAnB,EAAS,YAAYqD,EAChC,EACMC,GAAcD,GAA8B,UACvCrD,EAAAmB,EAAA,UAAA,MAAAnB,EAAS,eAAeqD,EAAMpC,EAAM,IAAIxF,GAAKA,EAAE,MAAM,GAC5D4D,GAAyBa,EAAAiB,EAAO,UAAP,YAAAjB,EAAgB,UAAU,OAAO,CAC9D,EACMqD,GAA0BC,GAAmB,OAC/ClG,GAASkG,CAAM,GACRxD,EAAAmB,EAAA,UAAA,MAAAnB,EAAS,eAAewD,EACnC,EACMC,GAAwBC,GAAgB,OAC1CnG,GAAamG,CAAG,GACT1D,EAAAmB,EAAA,UAAA,MAAAnB,EAAS,aAAa0D,EACjC,EACMC,GAAS1F,IAAa,OACxB1C,EAAAA,KAAA6D,EAAAA,SAAA,CAAA,SAAA,CAAC5D,MAAA,MAAA,CAAI,UAAW,mBACX,SACLC,qGAAA,EACCD,EAAA,IAAA,MAAA,CAAI,UAAW,6BACZ,SAACA,EAAA,IAAA,IAAA,CAAE,UAAW,eAAgB,KAAMyG,EAAU,aAAe,YAAa,uCAA2B,CACzG,CAAA,CAAA,CAAA,CACJ,EACI1G,EAAAA,KAAA6D,EAAA,SAAA,CAAA,SAAA,CAAC5D,MAAA,MAAA,CAAI,UAAW,mBACX,SACLC,yGAAA,EACAF,EAAAA,KAAC,MAAI,CAAA,UAAW,kBACZ,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAW,cACZ,SAAA,CAACC,MAAA,QAAA,CAAM,QAAS,gBAAkB,SAAgBC,gBAAA,EACjDD,EAAA,IAAA,QAAA,CAAM,KAAK,WAAW,QAASiG,EAAa,GAAG,gBAAgB,SAAWvE,GAAMwE,EAAgBxE,EAAE,OAA4B,OAAO,CAAE,CAAA,CAAA,EAC5I,EACA3B,EAAAA,KAAC,MAAI,CAAA,UAAW,cACZ,SAAA,CAACC,MAAA,QAAA,CAAM,QAAS,iBAAmB,SAAiBC,iBAAA,EACnDD,EAAA,IAAA,QAAA,CAAM,KAAK,WAAW,QAASmG,EAAgB,GAAG,iBAAiB,SAAWzE,GAAM0E,GAAkB1E,EAAE,OAA4B,OAAO,CAAE,CAAA,CAAA,EAClJ,EACA3B,EAAAA,KAAC,MAAI,CAAA,UAAW,cACZ,SAAA,CAACC,MAAA,QAAA,CAAM,QAAS,UAAY,SAAcC,cAAA,EACzCD,EAAA,IAAA,QAAA,CAAM,KAAK,WAAW,QAASqG,EAAY,GAAG,UAAU,SAAW3E,GAAM4E,GAAc5E,EAAE,OAA4B,OAAO,CAAE,CAAA,CAAA,CACnI,CAAA,CAAA,CACJ,CAAA,CAAA,EACJ,EAEA,IAAI0G,EAASpI,EAAAA,IAAC,SAAO,CAAA,GAAI,cAAe,CAAA,EACpCyC,IAAa,WACJ2F,EAAApI,EAAAA,IAAC,MAAI,CAAA,GAAI,gBAAiB,MAAO,CAAC,MAAO,OAAQ,UAAW,MAAA,EACjE,SAAAA,EAAAA,IAAC,UAAO,GAAI,eAAgB,MAAO,CAAC,SAAU,WAAY,KAAM,GAAG+F,CAAa,IAAI,CAAA,CAAE,CAC1F,CAAA,GAGK,SAAAsC,EAAS5E,EAAW6E,EAA8B,EACtD,gBAAkB,EACH,MAAM,MAAM5B,GAAS,CAC7B,OAAQ,OACR,KAAMiB,EAA0BlE,CAAI,CAAA,CACvC,GACO,GACA6E,IAAa,OACb,OAAO,SAAS,OAAO,EAEvB9B,EAAa,QAAU8B,EAG3BrB,EAAc,CAAC,MAAOhH,SAAU,KAAMA,wBAAwB,CAClE,GACD,CAAA,CAGD,MAAAsI,GAAqBtE,GAAoB,CAC3C7B,EAAgB6B,CAAI,EAChBA,IAAS5D,EAAU,SAAWR,IAAWK,EAAO,QAChDJ,EAAUI,EAAO,MAAM,CAE/B,EACA,OACIH,EAAA,KAAA6D,WAAA,CAAA,SAAA,CAAA5D,EAAA,IAACwC,GAAA,CAAQ,SAAAC,EAAoB,OAAA5C,EAAgB,SAAAU,EAAoB,KAAAS,EAAY,UAAAlB,EAAsB,YAAa8H,GACvG,aAAA3G,EAA4B,KAAM,IAAM,OAAA,OAAAuD,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,QAAQ,KAAM,IAAM,OAAA,OAAAA,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,QAAQ,MAAQD,GAAM,OAAA,OAAAC,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,MAAMD,IACxI,aAAAnE,EAA4B,gBAAiBmI,GAAmB,MAAApH,EAAc,WAAAoB,GAAwB,SAAAlB,GACtG,MAAAO,GAAc,SAAUmG,GAAwB,UAAAlG,GAAsB,aAAcoG,EAAA,CAC7F,EACCG,EACApI,EAAAA,IAAA8C,GAAA,CAAc,SAAAL,EAAoB,QAAAM,EAAkB,WAAY,IAAM,OAC7D,MAAAyF,EAAO,SAAS,cAAc,GAAG,EACjC/E,GAAae,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,UACnCf,EAAK,QAAU,KAAK,UAAUA,EAAK,OAAO,EAC1C+E,EAAK,KAAO,gCAAgCb,EAA0BlE,CAAI,CAAC,GACtE+E,EAAA,SAAW,GAAGjD,CAAS,UACnB,SAAA,KAAK,YAAYiD,CAAI,EAC9BA,EAAK,MAAM,EACF,SAAA,KAAK,YAAYA,CAAI,CAAA,EAC/B,WAAYH,EAAU,MAAO,IAAM,WAClC,OAAO5F,EAAU,CACb,IAAK,QAAe+B,EAAAmB,EAAA,UAAA,MAAAnB,EAAS,QAAQ,IAAK,MAC1C,IAAK,UACDE,EAAAiB,EAAO,UAAP,MAAAjB,EAAgB,eAAepB,EAAmB,MAAO,CAAA,GACzDO,GAAyB4E,EAAA9C,EAAO,UAAP,YAAA8C,EAAgB,UAAU,OAAO,EAC1D,KAAA,CAEZ,EAAG,MAAO,IAAM,UACLjE,EAAAmB,EAAA,UAAA,MAAAnB,EAAS,QAAQ,KAAK,MAAM,KAAK,UAAUc,CAAW,CAAC,GAC1D7C,IAAa,UACboB,GAAyBa,EAAAiB,EAAO,UAAP,YAAAjB,EAAgB,UAAU,OAAO,CAElE,EAAG,KAAM,IAAM,SACL,MAAAjB,GAAae,EAAAmB,EAAO,UAAP,YAAAnB,EAAgB,UAC7B8D,GAAW5D,EAAAiB,EAAO,UAAP,YAAAjB,EAAgB,UAAU,QAC3CjB,EAAK,QAAU,KAAK,UAAUA,EAAK,OAAO,EAC1C4E,EAAS5E,EAAM6E,CAAQ,CAAA,EACxB,OAAQR,GAAW,EACrBK,EAAA,EACL,CACJ,CC7kBA,MAAMO,GAAOC,GAAAA,WAAW,SAAS,eAAe,eAAe,CAAC,EAChED,GAAK,OAAQ1I,EAAA,IAAAqF,GAAA,CAAO,YAA0B,UAAsB,SAAoB,cAA8B,MAAc,mBAAoB,OAAO,kBAAmB,CAAA,CAAE"}